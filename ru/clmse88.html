<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Ассоциативные списки</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-09-13 23:02:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
   <div id="toplinks"> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt; <br />&#x003C;<a 
href="hash.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse87.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse87.html#tailclmse87.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="#tailclmse88.html">В-конец</a>&#x003E;&#x003C;<a 
href="list.html#clmse88.html" >Наверх</a>&#x003E;</div><h3 class="sectionHead"><span class="titlemark">15.6
</span> <a 
href="clm.html#QQ2-108-179" id="x108-14800015.6">Ассоциативные списки</a></h3>
<em>
<!--l. 2468--><p class="noindent" >Ассоциативный список</em>, или <em>a-list</em>, является структурой данных, часто
используемой в Lisp&#x2019;е. a-list является списком пар (cons-ячеек). Каждая пара
является ассоциацией. <em>car</em> элемент пары называется <em>key</em>, и <em>cdr</em> элемент
<em>datum</em>.
<!--l. 2473--><p class="indent" >   Преимущество a-list представления данных в том, что a-list может быть
постепенно увеличен путём простого добавления в начало новых записей.
Кроме того, поскольку функция поиска <b><a 
href="symbols.html#x188-380128r128">assoc</a></b> по порядку проходит элементы
a-list, то новые записи могут «скрыть» старые. Если a-list рассматривать как
отображение ключей в значения, то отображение может быть не только
увеличено, но также изменено с помощью добавления новых записей в начало
a-list.
<!--l. 2481--><p class="indent" >   Иногда a-list представляет биективное (bijective) отображение, и
бывает нужно получить ключ для некоторого значения. Для этих целей
используется функция «реверсивного» поиска <b><a 
href="symbols.html#x188-380771r771">rassoc</a></b>. Другие варианты
поиска в a-list могут быть созданы с помощью функции <b><a 
href="symbols.html#x188-380413r413">ﬁnd</a></b> или
<b><a 
href="symbols.html#x188-380627r627">member</a></b>.
<!--l. 2486--><p class="indent" >   Допустимо, чтобы <b><a 
href="symbols.html#x188-380670r670">nil</a></b> был элемент a-list вместо пары ключ-значение.
Такой элемент не считается парой и просто пропускается при использовании
функции <b><a 
href="symbols.html#x188-380128r128">assoc</a></b>.
<div class="defun">
<div class="defunheader">
<a 
 id="dx108-148001"></a>
<em>
<!--l. 2491--><p class="noindent" >[Функция]</em> <b>acons</b> <i>key</i> <i>datum</i> <i>a-list</i>
</div>
<b>
<!--l. 2493--><p class="indent" >   <a 
href="symbols.html#x188-380084r84">acons</a></b> создаёт новый ассоциативный список, с помощью добавления пары
<b>(<em>key</em> . <em>datum</em>)</b> к старому <em>a-list</em>. <div class="lisp"><tt><div class="tabbing">
                                                                          

                                                                          
(acons x y a) <span class="math"> ≡</span> (cons (cons x y) a)
   <br>
<!--l. 2497--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx108-148002"></a>
<em>
<!--l. 2501--><p class="noindent" >[Функция]</em> <b>pairlis</b> <i>keys</i> <i>data</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>a-list</i>
</div>
<b>
<!--l. 2503--><p class="indent" >   <a 
href="symbols.html#x188-380713r713">pairlis</a></b> принимает два списка и создаёт ассоциативный список, который
связывает элементы первого списка с соответствующими элементами второго.
Если списки не одинаковой длины, это является ошибкой. Если указан
необязательный аргумент <em>a-list</em>, тогда новые пары добавляются к нему в
начало.
<!--l. 2508--><p class="indent" >   Новые пары могут быть расположены в итоговом списке a-list в любом
порядке. Например: <div class="lisp"><tt><div class="tabbing">
(pairlis &#x2019;(one two) &#x2019;(1 2) &#x2019;((three . 3) (four . 19)))
   <br>
<!--l. 2512--><p class="noindent" ></div>
</tt>
</div>
<!--l. 2513--><p class="indent" >   может быть <div class="lisp"><tt><div class="tabbing">
((one . 1) (two . 2) (three . 3) (four . 19))
   <br>
                                                                          

                                                                          
<!--l. 2516--><p class="noindent" ></div>
</tt>
</div>
<!--l. 2517--><p class="indent" >   или может быть так <div class="lisp"><tt><div class="tabbing">
((two . 2) (one . 1) (three . 3) (four . 19))
   <br>
<!--l. 2520--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx108-148003"></a>
<em>
<!--l. 2524--><p class="noindent" >[Функция]</em> <b>assoc</b> <i>item</i> <i>a-list</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:test</i> <i>:test-not</i> <i>:key</i><br />
<a 
 id="dx108-148004"></a>
<em>
[Функция]</em> <b>assoc-if</b> <i>predicate</i> <i>a-list</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:key</i><br />
<a 
 id="dx108-148005"></a>
<em>
[Функция]</em> <b>assoc-if-not</b> <i>predicate</i> <i>a-list</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:key</i>
</div>
<!--l. 2528--><p class="indent" >   Каждая из этих функций осуществляет поиск в ассоциативном списке
<em>a-list</em>. Функция возвращает первую пару, удовлетворяющую условию, или <b><a 
href="symbols.html#x188-380670r670">nil</a></b>,
если такой пары не было найдено. Например: <div class="lisp"><tt><div class="tabbing">
(assoc &#x2019;r &#x2019;((a . b) (c . d) (r . x) (s . y) (r . z)))
   <br>             <span class="math"> ⇒</span> (r . x)<br>     (assoc &#x2019;goo &#x2019;((foo . bar) (zoo . goo))) <span class="math"> ⇒</span> <b><a 
href="symbols.html#x188-380670r670">nil</a></b><br>
(assoc &#x2019;2 &#x2019;((1 a b c) (2 b c d) (-7 x y z))) <span class="math"> ⇒</span> (2 b c d)<br>
                                                                          

                                                                          
<!--l. 2537--><p class="noindent" ></div>
</tt>
</div>
<!--l. 2538--><p class="indent" >   Если функция вернула пару, можно изменить её значение с помощью
<b><a 
href="symbols.html#x188-380825r825">rplacd</a></b>. (Однако лучше будет добавить новую «затеняющую» пару в начало,
чем модифицировать старую.) Например: <div class="lisp"><tt><div class="tabbing">
(setq values &#x2019;((x . 100) (y . 200) (z . 50)))
   <br>         (assoc &#x2019;y values) <span class="math"> ⇒</span> (y . 200)<br>         (rplacd (assoc &#x2019;y values) 201)<br>
(assoc &#x2019;y values) <span class="math"> ⇒</span> (y . 201) теперь<br>
<!--l. 2547--><p class="noindent" ></div>
</tt>
</div>
<!--l. 2548--><p class="indent" >   Типичный приём использования <b>(cdr (assoc x y))</b>. Так как <em>cdr</em> от <b><a 
href="symbols.html#x188-380670r670">nil</a></b>
гарантировано вычисляется в <b><a 
href="symbols.html#x188-380670r670">nil</a></b>, то в случае отсутствия нужной пары, будет
возвращено значение <b><a 
href="symbols.html#x188-380670r670">nil</a></b>. <b><a 
href="symbols.html#x188-380670r670">nil</a></b> также будет возвращено, если значение для
ключа равно <b><a 
href="symbols.html#x188-380670r670">nil</a></b>. Такое поведение удобно, если <b><a 
href="symbols.html#x188-380670r670">nil</a></b> несёт смысл «значения
по-умолчанию».
<!--l. 2554--><p class="indent" >   Два выражения <div class="lisp"><tt><div class="tabbing">
(assoc <em>item</em> <em>list</em> :test <em>fn</em>)
   <br>
<!--l. 2557--><p class="noindent" ></div>
</tt>
</div>
<!--l. 2558--><p class="indent" >   и <div class="lisp"><tt><div class="tabbing">
(ﬁnd <em>item</em> <em>list</em> :test <em>fn</em> :key #&#x2019;car)
   <br>
<!--l. 2561--><p class="noindent" ></div>
</tt>
                                                                          

                                                                          
</div>
<!--l. 2562--><p class="indent" >   эквивалентны за исключением, того что <b><a 
href="symbols.html#x188-380128r128">assoc</a></b> игнорирует значения <b><a 
href="symbols.html#x188-380670r670">nil</a></b> на
месте пар.
<!--l. 2565--><p class="indent" >   Смотрите также <b><a 
href="symbols.html#x188-380413r413">ﬁnd</a></b> и <b><a 
href="symbols.html#x188-380732r732">position</a></b>.
<div class="new">
<!--l. 2568--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx108-148006"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
<!--l. 2573--><p class="indent" >   Пользователь ограничен в создании побочных действий так, как это
описано в разделе <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx108-148007"></a>
<em>
<!--l. 2578--><p class="noindent" >[Функция]</em> <b>rassoc</b> <i>item</i> <i>a-list</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:test</i> <i>:test-not</i> <i>:key</i><br />
<a 
 id="dx108-148008"></a>
<em>
[Функция]</em> <b>rassoc-if</b> <i>predicate</i> <i>a-list</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:key</i><br />
<a 
 id="dx108-148009"></a>
<em>
[Функция]</em> <b>rassoc-if-not</b> <i>predicate</i> <i>a-list</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:key</i>
</div>
<b>
<!--l. 2582--><p class="indent" >   <a 
href="symbols.html#x188-380771r771">rassoc</a></b> является реверсивной формой для <b><a 
href="symbols.html#x188-380128r128">assoc</a></b>. Функция ищет пары, у
которых <em>cdr</em> элемент удовлетворяет заданному условию. Если <em>a-list</em>
рассматривается как отображение, то <b><a 
href="symbols.html#x188-380771r771">rassoc</a></b> обрабатывает <em>a-list</em> как
представление инверсного отображения. Например: <div class="lisp"><tt><div class="tabbing">
(rassoc &#x2019;a &#x2019;((a . b) (b . c) (c . a) (z . a))) <span class="math"> ⇒</span> (c . a)
   <br>
<!--l. 2589--><p class="noindent" ></div>
</tt>
</div>
<!--l. 2591--><p class="indent" >   Выражения <div class="lisp"><tt><div class="tabbing">
                                                                          

                                                                          
(rassoc <em>item</em> <em>list</em> :test <em>fn</em>)
   <br>
<!--l. 2594--><p class="noindent" ></div>
</tt>
</div>
<!--l. 2595--><p class="indent" >   и <div class="lisp"><tt><div class="tabbing">
(ﬁnd <em>item</em> <em>list</em> :test <em>fn</em> :key #&#x2019;cdr)
   <br>
<!--l. 2598--><p class="noindent" ></div>
</tt>
</div>
<!--l. 2599--><p class="indent" >   эквивалентны за исключением, того что <b><a 
href="symbols.html#x188-380771r771">rassoc</a></b> игнорирует значения <b><a 
href="symbols.html#x188-380670r670">nil</a></b>
на месте пар.
<div class="new">
<!--l. 2603--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx108-148010"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
<!--l. 2608--><p class="indent" >   Пользователь ограничен в создании побочных действий так, как это
описано в разделе <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>
<hr></div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
<!--l. 371--><p class="indent" >   <div id="bottomlinks">&#x003C;<a 
href="hash.html" >Далее</a>&#x003E;&#x003C;<a 
href="clmse87.html" >Назад</a>&#x003E;&#x003C;<a 
href="clmse87.html#tailclmse87.html" >Назад-и-вниз</a>&#x003E;&#x003C;<a 
href="clmse88.html" >В-начало</a>&#x003E;&#x003C;<a 
href="list.html#clmse88.html" >Наверх</a>&#x003E;<br> &lt;<a href="../index.html">Главная</a>&gt; &lt;<a href="symbols.html">Символы</a>&gt;</div><a 
 id="tailclmse88.html"></a>
 
</body></html> 

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Searching Sequences for Items</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-09-13 22:59:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
   <div id="toplinks"> &lt;<a href="../index.html">Main Page</a>&gt; &lt;<a href="symbols.html">Symbols</a>&gt; <br> &#x003C;<a 
href="clmse82.html" >Next</a>&#x003E;&#x003C;<a 
href="clmse80.html" >Prev</a>&#x003E;&#x003C;<a 
href="clmse80.html#tailclmse80.html" >PrevTail</a>&#x003E;&#x003C;<a 
href="#tailclmse81.html">Tail</a>&#x003E;&#x003C;<a 
href="kseque.html#clmse81.html" >Up</a>&#x003E;</div><h3 class="sectionHead"><span class="titlemark">14.4   </span> <a 
href="clm.html#QQ2-100-170" id="x100-14000014.4">Searching Sequences for
Items</a></h3>
<!--l. 958--><p class="noindent" >Each of these functions searches a sequence to locate one or more elements
satisfying some test.
<div class="defun">
<div class="defunheader">
<a 
 id="dx100-140001"></a>
<em>
<!--l. 962--><p class="noindent" >[Function]</em> <b>ﬁnd</b> <i>item</i> <i>sequence</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:test</i> <i>:test-not</i> <i>:start :end</i>
<i>:key</i><br />
<a 
 id="dx100-140002"></a>
<em>
[Function]</em> <b>ﬁnd-if</b> <i>predicate</i> <i>sequence</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:start</i> <i>:end</i> <i>:key</i><br />
<a 
 id="dx100-140003"></a>
<em>
[Function]</em> <b>ﬁnd-if-not</b> <i>predicate</i> <i>sequence</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:start :end :key</i>
</div>
<!--l. 966--><p class="indent" >   If the <em>sequence</em> contains an element satisfying the test, then the leftmost such
element is returned; otherwise <b><a 
href="symbols.html#x188-380670r670">nil</a></b> is returned.
<!--l. 970--><p class="indent" >   If <b>:start</b> and <b>:end</b> keyword arguments are given, only the speciﬁed
subsequence of <em>sequence</em> is searched.
<!--l. 973--><p class="indent" >   If a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> <b>:from-end</b> keyword argument is speciﬁed, then the result is the
<em>rightmost</em> element satisfying the test.
<div class="new">
<!--l. 977--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx100-140004"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx100-140005"></a>
                                                                          

                                                                          
<em>
<!--l. 984--><p class="noindent" >[Function]</em> <b>position</b> <i>item</i> <i>sequence</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:test</i> <i>:test-not</i>
<i>:start :end :key</i><br />
<a 
 id="dx100-140006"></a>
<em>
[Function]</em> <b>position-if</b> <i>predicate</i> <i>sequence</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:start :end :key</i><br />
<a 
 id="dx100-140007"></a>
<em>
[Function]</em> <b>position-if-not</b> <i>predicate</i> <i>sequence</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:start :end :key</i>
</div>
<!--l. 988--><p class="indent" >   If the <em>sequence</em> contains an element satisfying the test, then the index within
the sequence of the leftmost such element is returned as a non-negative integer;
otherwise <b><a 
href="symbols.html#x188-380670r670">nil</a></b> is returned.
<!--l. 992--><p class="indent" >   If <b>:start</b> and <b>:end</b> keyword arguments are given, only the speciﬁed
subsequence of <em>sequence</em> is searched. However, the index returned is relative to the
entire sequence, not to the subsequence.
<!--l. 997--><p class="indent" >   If a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> <b>:from-end</b> keyword argument is speciﬁed, then the result is the
index of the <em>rightmost</em> element satisfying the test. (The index returned, however,
is an index from the left-hand end, as usual.)
<div class="new">
<!--l. 1002--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx100-140008"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
<hr></div>
<!--l. 1008--><p class="indent" >   Here is a simple piece of code that uses several of the sequence functions,
notably <b><a 
href="symbols.html#x188-380733r733">position-if</a></b> and <b><a 
href="symbols.html#x188-380416r416">ﬁnd-if</a></b>, to process strings. Note one use of <b><a 
href="symbols.html#x188-380577r577">loop</a></b> as well.
<div class="lisp"><tt><div class="tabbing">
(defun debug-palindrome (s)
   <br>                              (ﬂet ((match (x) (char-equal (ﬁrst x) (third x))))<br>
    (let* ((pairs (loop for c across s<br>                        for j from 0<br>
                        when (alpha-char-p c)<br>
                          collect (list c j)))<br>
           (quads (mapcar #&#x2019;append pairs (reverse pairs)))<br>
           (diﬀpos (position-if (complement #&#x2019;match) quads)))<br>
      (when diﬀpos<br>                       (let* ((diﬀ (elt quads diﬀpos))<br>
               (same (ﬁnd-if #&#x2019;match quads<br>
                                                                          

                                                                          
                              :start (+ diﬀpos 1))))<br>
          (if same<br>                                          (format nil<br>
                      &#x0022;/~A/ (at ~D) is not the reverse of /~A/&#x0022;<br>
                      (subseq s (second diﬀ) (second same))<br>
                      (second diﬀ)<br>                      (subseq s (+ (fourth same) 1)<br>
                                (+ (fourth diﬀ) 1)))<br>
              &#x0022;This palindrome is completely messed up!&#x0022;))))))<br>
<!--l. 1032--><p class="noindent" ></div>
</tt>
</div>
<!--l. 1033--><p class="indent" >   Here is an example of its behavior. <div class="lisp"><tt><div class="tabbing">
(setq panama     ;A putative palindrome?
   <br>                               &#x0022;A man, a plan, a canoe, pasta, heros, rajahs,<br>
       a coloratura, maps, waste, percale, macaroni, a gag,<br>
       a banana bag, a tan, a tag, a banana bag again<br>
       (or a camel), a crepe, pins, Spam, a rut, a Rolo,<br>
       cash, a jar, sore hats, a peon, a canal–Panama!&#x0022;)<br>
<!--l. 1041--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 1042--><p class="indent" >   <div class="tabbing">
(debug-palindrome panama)
   <br>                            <span class="math"> ⇒</span> &#x0022;/wast/ (at 73) is not the reverse of /, pins/&#x0022;<br>
<br>                        (replace panama &#x0022;snipe&#x0022; :start1 73)     ;Repair it<br>
  <span class="math"> ⇒</span> &#x0022;A man, a plan, a canoe, pasta, heros, rajahs,<br>
       a coloratura, maps, snipe, percale, macaroni, a gag,<br>
       a banana bag, a tan, a tag, a banana bag again<br>
       (or a camel), a crepe, pins, Spam, a rut, a Rolo,<br>
       cash, a jar, sore hats, a peon, a canal–Panama!&#x0022;<br>
                                                                          

                                                                          
<br>    (debug-palindrome panama) <span class="math"> ⇒</span> nil     ;Copacetic—a true palindrome<br>
<br>                       (debug-palindrome &#x0022;Rubber baby buggy bumpers&#x0022;)<br>
  <span class="math"> ⇒</span> &#x0022;/Rubber / (at 0) is not the reverse of /umpers/&#x0022;<br>
<br>                       (debug-palindrome &#x0022;Common Lisp: The Language&#x0022;)<br>
  <span class="math"> ⇒</span> &#x0022;/Commo/ (at 0) is not the reverse of /guage/&#x0022;<br>
<br>               (debug-palindrome &#x0022;Complete mismatches are hard to ﬁnd&#x0022;)<br>
  <span class="math"> ⇒</span> <br>    &#x0022;/Complete mism/ (at 0) is not the reverse of /re hard to ﬁnd/&#x0022;<br>
<br>               (debug-palindrome &#x0022;Waltz, nymph, for quick jigs vex Bud&#x0022;)<br>
  <span class="math"> ⇒</span> &#x0022;This palindrome is completely messed up!&#x0022;<br>
<br>                    (debug-palindrome &#x0022;Doc, note: I dissent.  A fast never<br>
                   prevents a fatness.  I diet on cod.&#x0022;)<br>
  <span class="math"> ⇒</span><b><a 
href="symbols.html#x188-380670r670">nil</a></b>     ;Another winner<br>                                            <br>
(debug-palindrome &#x0022;Top step&#x2019;s pup&#x2019;s pet spot&#x0022;) <span class="math"> ⇒</span> nil<br>
<!--l. 1073--><p class="noindent" ></div>
</tt>
</div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx100-140009"></a>
<em>
<!--l. 1076--><p class="noindent" >[Function]</em> <b>count</b> <i>item</i> <i>sequence</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:test</i> <i>:test-not</i> <i>:start :end :key</i><br />
<a 
 id="dx100-140010"></a>
<em>
[Function]</em> <b>count-if</b> <i>predicate</i> <i>sequence</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:start :end :key</i><br />
<a 
 id="dx100-140011"></a>
<em>
[Function]</em> <b>count-if-not</b> <i>predicate</i> <i>sequence</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:start :end :key</i>
</div>
<!--l. 1080--><p class="indent" >   The result is always a non-negative integer, the number of elements in the
speciﬁed subsequence of <em>sequence</em> satisfying the test.
<!--l. 1084--><p class="indent" >   The <b>:from-end</b> argument does not aﬀect the result returned; it is accepted
purely for compatibility with other sequence functions.
<div class="new">
<!--l. 1088--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx100-140012"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
<hr></div>
                                                                          

                                                                          
<div class="defun">
<div class="defunheader">
<a 
 id="dx100-140013"></a>
<em>
<!--l. 1095--><p class="noindent" >[Function]</em> <b>mismatch</b> <i>sequence1</i> <i>sequence2</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:test</i> <i>:test-not</i> <i>:key</i>
<i>:start1</i> <i>:start2</i> <i>:end1</i> <i>:end2</i>
</div>
<!--l. 1097--><p class="indent" >   The speciﬁed subsequences of <em>sequence1</em> and <em>sequence2</em> are compared
element-wise. If they are of equal length and match in every element, the result is
<b><a 
href="symbols.html#x188-380670r670">nil</a></b>. Otherwise, the result is a non-negative integer. This result is the index within
<em>sequence1</em> of the leftmost position at which the two subsequences fail to
match; or, if one subsequence is shorter than and a matching preﬁx of the
other, the result is the index relative to <em>sequence1</em> beyond the last position
tested.
<!--l. 1108--><p class="indent" >   If a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> <b>:from-end</b> keyword argument is given, then <em>one plus</em> the index of
the <em>rightmost</em> position in which the sequences diﬀer is returned. In eﬀect, the
(sub)sequences are aligned at their right-hand ends; then, the last elements are
compared, the penultimate elements, and so on. The index returned is again an
index relative to <em>sequence1</em>.
<div class="new">
<!--l. 1116--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx100-140014"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx100-140015"></a>
<em>
<!--l. 1123--><p class="noindent" >[Function]</em> <b>search</b> <i>sequence1</i> <i>sequence2</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:from-end</i> <i>:test</i> <i>:test-not</i> <i>:key</i>
<i>:start1</i> <i>:start2</i> <i>:end1</i> <i>:end2</i>
</div>
<!--l. 1125--><p class="indent" >   A search is conducted for a subsequence of <em>sequence2</em> that element-wise
matches <em>sequence1</em>. If there is no such subsequence, the result is <b><a 
href="symbols.html#x188-380670r670">nil</a></b>; if there is,
the result is the index into <em>sequence2</em> of the leftmost element of the leftmost such
matching subsequence.
                                                                          

                                                                          
<!--l. 1131--><p class="indent" >   If a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> <b>:from-end</b> keyword argument is given, the index of the leftmost
element of the <em>rightmost</em> matching subsequence is returned.
<!--l. 1135--><p class="indent" >   The implementation may choose to search the sequence in any order; there is
no guarantee on the number of times the test is made. For example, <b><a 
href="symbols.html#x188-380834r834">search</a></b> with
a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> <b>:from-end</b> argument might actually search a list from left to right
instead of from right to left (but in either case would return the rightmost
matching subsequence, of course). Therefore it is a good idea for a user-supplied
predicate to be free of side eﬀects.
<div class="new">
<!--l. 1144--><p class="indent" >   X3J13 voted in January 1989 <a 
 id="dx100-140016"></a>to restrict user side eﬀects; see section <a 
href="clmse43.html#x55-900007.9">7.9<!--tex4ht:ref: STRUCTURE-TRAVERSAL-SECTION --></a>.
</div>
<hr></div>
                                                                          

                                                                          
<!--l. 1150--><p class="indent" >   <div id="bottomlinks">&#x003C;<a 
href="clmse82.html" >Next</a>&#x003E;&#x003C;<a 
href="clmse80.html" >Prev</a>&#x003E;&#x003C;<a 
href="clmse80.html#tailclmse80.html" >PrevTail</a>&#x003E;&#x003C;<a 
href="clmse81.html" >Front</a>&#x003E;&#x003C;<a 
href="kseque.html#clmse81.html" >Up</a>&#x003E;<br>&lt;<a href="../index.html">Main Page</a>&gt; &lt;<a href="symbols.html">Symbols</a>&gt; </div><a 
 id="tailclmse81.html"></a>  
</body></html> 

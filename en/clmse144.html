<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Functions in the Programmer Interface</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-09-13 22:59:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
   <div id="toplinks"> &lt;<a href="../index.html">Main Page</a>&gt; &lt;<a href="symbols.html">Symbols</a>&gt; <br> &#x003C;<a 
href="condition.html" >Next</a>&#x003E;&#x003C;<a 
href="clmse143.html" >Prev</a>&#x003E;&#x003C;<a 
href="clmse143.html#tailclmse143.html" >PrevTail</a>&#x003E;&#x003C;<a 
href="#tailclmse144.html">Tail</a>&#x003E;&#x003C;<a 
href="clos.html#clmse144.html" >Up</a>&#x003E;</div><h3 class="sectionHead"><span class="titlemark">27.2   </span> <a 
href="clm.html#QQ2-176-344" id="x176-30200027.2">Functions in the
Programmer Interface</a></h3>
<!--l. 2751--><p class="noindent" >This section describes the functions, macros, special operators, and generic
functions provided by the Common Lisp Object System Programmer Interface.
The Programmer Interface comprises the functions and macros that are suﬃcient
for writing most object-oriented programs.
<!--l. 2756--><p class="indent" >   This section is reference material that requires an understanding of the basic
concepts of the Common Lisp Object System. The functions are arranged in
alphabetical order for convenient reference.
<!--l. 2760--><p class="indent" >   The description of each function, macro, special operator, and generic
function includes its purpose, its syntax, the semantics of its arguments and
returned values, and often an example and cross-references to related
functions.
<!--l. 2765--><p class="indent" >   The syntax description for a function, macro, or special operator describes its
parameters. The description of a generic function includes descriptions of the
methods that are deﬁned on that generic function by the Common Lisp Object
System. A <em>method signature</em> is used to describe the parameters and parameter
specializers for each method.
<!--l. 2772--><p class="indent" >   The following is an example of the format for the syntax description of a
generic function with the method signature for one primary method:
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302001"></a>
<em>
<!--l. 2777--><p class="noindent" >[Generic function]</em> <b>f</b> <i>x</i> <i>y</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>z</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:k</i><br />
<a 
 id="dx176-302002"></a>
<em>
[Primary method]</em> <b>f</b> (<i>x</i> class) (<i>y</i> t) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>z</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:k</i>
</div>
<!--l. 2780--><p class="indent" >   This description indicates that the generic function <b><a 
href="symbols.html#x188-380395r395">f</a></b> has two required
parameters, <em>x</em> and <em>y</em>. In addition, there is an optional parameter <em>z</em> and a keyword
                                                                          

                                                                          
parameter <b>:k</b>.
<!--l. 2784--><p class="indent" >   The method signature indicates that this method on the generic function <b><a 
href="symbols.html#x188-380395r395">f</a></b> has
two required parameters, <em>x</em>, which must be an instance of the class <b>class</b>, and <em>y</em>,
which can be any object. In addition, there is an optional parameter <em>z</em> and a
keyword parameter <b>:k</b>. The signature also indicates that this method on <b><a 
href="symbols.html#x188-380395r395">f</a></b> is a
primary method and has no qualiﬁers.
<!--l. 2791--><p class="indent" >   The syntax description for a generic function describes the lambda-list of the
generic function itself, while the method signatures describe the lambda-lists of
the deﬁned methods.
<hr></div>
<!--l. 2796--><p class="indent" >   The generic functions described in this book are all standard generic functions.
They all use standard method combination.
<!--l. 2799--><p class="indent" >   Any implementation of the Common Lisp Object System is allowed to provide
additional methods on the generic functions described here.
<!--l. 2802--><p class="indent" >   It is useful to categorize the functions and macros according to their role in
this standard:
      <ul class="itemize1">
      <li class="itemize"><em>Tools used for simple object-oriented programming</em>
      <!--l. 2808--><p class="noindent" >These  tools  allow  for  deﬁning  new  classes,  methods,  and  generic
      functions and for making instances. Some tools used within method
      bodies  are  also  listed  here.  Some  of  the  macros  listed  here  have  a
      corresponding function that performs the same task at a lower level of
      abstraction.
      <div class="flushleft" 
>
<!--l. 2814--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%" class="tabular"><tr><td align="left" ><b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b></td><td align="left" ><b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b></td></tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380214r214">change-class</a></b> </td> <td align="left" ><b><a 
href="symbols.html#x188-380595r595">make-instance</a></b></td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380310r310">defclass</a></b>            </td><td align="left" ><b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b>   </td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b>         </td><td align="left" ><b><a 
href="symbols.html#x188-380872r872">slot-boundp</a></b>       </td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380321r321">defmethod</a></b>        </td><td align="left" ><b><a 
href="symbols.html#x188-380888r888">slot-value</a></b>          </td></tr><tr><td align="left" > </td> <td align="left" ><b><a 
href="symbols.html#x188-381015r1015">with-accessors</a></b></td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380452r452">generic-function</a></b> </td><td align="left" >                       </td>
</tr><tr><td align="left" >                      </td><td align="left" ><b><a 
href="symbols.html#x188-381025r1025">with-slots</a></b>          </td></tr></table>
</div></div>
      </li>
      <li class="itemize"><em>Functions underlying the commonly used macros</em>
                                                                          

                                                                          
      <div class="flushleft" 
>
<!--l. 2834--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%" class="tabular"><tr><td align="left" ><b><a 
href="symbols.html#x188-380090r90">add-method</a></b>                      </td><td align="left" ><b><a 
href="symbols.html#x188-380795r795">reinitialize-instance</a></b>                    </td></tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380244r244">class-name</a></b> </td> <td align="left" ><b><a 
href="symbols.html#x188-380806r806">remove-method</a></b></td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380270r270">compute-applicable-methods</a></b></td><td align="left" ><b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b>                         </td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380376r376">ensure-generic-function</a></b>       </td><td align="left" ><b><a 
href="symbols.html#x188-380883r883">slot-exists-p</a></b>                              </td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380415r415">ﬁnd-class</a></b>                         </td><td align="left" ><b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b>                       </td></tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380418r418">ﬁnd-method</a></b> </td> <td align="left" ><b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b></td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380448r448">function-keywords</a></b>              </td><td align="left" ><b><a 
href="symbols.html#x188-380887r887">slot-unbound</a></b>                            </td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380596r596">make-instances-obsolete</a></b>      </td><td align="left" ><b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> </td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380673r673">no-applicable-method</a></b>         </td><td align="left" ><b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b></td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380674r674">no-next-method</a></b>                 </td><td align="left" >                                             </td></tr></table>
</div></div>
      </li>
      <li class="itemize"><em>Tools for declarative method combination</em>
      <div class="flushleft" 
>
<!--l. 2853--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%" class="tabular"><tr><td align="left" ><b><a 
href="symbols.html#x188-380189r189">call-method</a></b>                    </td><td align="left" ><b><a 
href="symbols.html#x188-380632r632">method-combination-error</a></b></td></tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b></td> <td align="left" ><b><a 
href="symbols.html#x188-380636r636">method-qualiﬁers</a></b></td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b>         </td><td align="left" >                                   </td></tr></table>
</div></div>
      </li>
      <li class="itemize"><em>General Common Lisp support tools</em>
      <div class="flushleft" 
>
<!--l. 2865--><p class="noindent" >
 <!--tex4ht:inline--><div class="tabular"><table width="100%" class="tabular"><tr><td align="left" ><b><a 
href="symbols.html#x188-380245r245">class-of</a></b>          </td><td align="left" ><b><a 
href="symbols.html#x188-380752r752">print-object</a></b>      </td>
</tr><tr><td align="left" ><b><a 
href="symbols.html#x188-380352r352">documentation</a></b></td><td align="left" ><b><a 
href="symbols.html#x188-380946r946">symbol-macrolet</a></b></td></tr></table>
</div></div>
      <!--l. 2873--><p class="noindent" >[Note that <b><a 
href="symbols.html#x188-380337r337">describe</a></b> appeared in this list in the original CLOS proposal
      <span class="cite">[<a 
href="bib.html#XSIGPLAN-CLOS">5</a>, <a 
href="bib.html#XLASC-CLOS-PART-2">7</a>]</span>, but X3J13 voted in March 1989 <a 
 id="dx176-302003"></a>not to make <b><a 
href="symbols.html#x188-380337r337">describe</a></b> a generic
      function after all (see <b><a 
href="symbols.html#x188-380338r338">describe-object</a></b>).—GLS]
      </li></ul>
<!--l. 2879--><p class="noindent" >[At this point the original CLOS report contained a description of the [[<i> </i>]] and <span class="math"> ↓</span><i></i>
notation; that description is omitted here. I have adopted the notation for use
throughout this book. It is described in section <a 
href="clmse2.html#x8-120001.2.5">1.2.5<!--tex4ht:ref: FUNCTION-HEADER-NOTATION-SECTION --></a>.—GLS]
                                                                          

                                                                          
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302004"></a>
<em>
<!--l. 2887--><p class="noindent" >[Generic function]</em> <b>add-method</b> <i>generic-function</i> <i>method</i><br />
<a 
 id="dx176-302005"></a>
<em>
[Primary method]</em> <b>add-method</b> (<i>generic-function</i> standard-generic-function)
(<i>method</i> method)
</div>
<!--l. 2890--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380090r90">add-method</a></b> adds a method to a generic function. It
destructively modiﬁes the generic function and returns the modiﬁed generic
function as its result.
<!--l. 2894--><p class="indent" >   The <em>generic-function</em> argument is a generic function object.
<!--l. 2897--><p class="indent" >   The <em>method</em> argument is a method object. The lambda-list of the method
function must be congruent with the lambda-list of the generic function, or an
error is signaled.
<!--l. 2901--><p class="indent" >   The modiﬁed generic function is returned. The result of <b><a 
href="symbols.html#x188-380090r90">add-method</a></b> is <b><a 
href="symbols.html#x188-380378r378">eq</a></b> to
the <em>generic-function</em> argument.
<!--l. 2904--><p class="indent" >   If the given method agrees with an existing method of the generic function on
parameter specializers and qualiﬁers, the existing method is replaced. See
section <a 
href="clmse143.html#x175-27100027.1.6">27.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> for a deﬁnition of agreement in this context.
<!--l. 2909--><p class="indent" >   If the method object is a method object of another generic function, an error is
signaled.
<!--l. 2912--><p class="indent" >   See section <a 
href="clmse143.html#x175-27100027.1.6">27.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b>, <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b>, <b><a 
href="symbols.html#x188-380418r418">ﬁnd-method</a></b>, and
<b><a 
href="symbols.html#x188-380806r806">remove-method</a></b>.
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 2921--><p class="indent" >   <div class="tabbing">
 <em>[Macro]</em> <b>call-method</b> <a 
 id="dx176-302006"></a>method next-method-list
   <br>
<!--l. 2922--><p class="noindent" ></div>
</div>
                                                                          

                                                                          
<!--l. 2923--><p class="indent" >   The macro <b><a 
href="symbols.html#x188-380189r189">call-method</a></b> is used in method combination. This macro hides the
implementation-dependent details of how methods are called. It can be used only
within an eﬀective method form, for the name <b><a 
href="symbols.html#x188-380189r189">call-method</a></b> is deﬁned only within
the lexical scope of such a form.
<!--l. 2928--><p class="indent" >   The macro <b><a 
href="symbols.html#x188-380189r189">call-method</a></b> invokes the speciﬁed method, supplying it with
arguments and with deﬁnitions for <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> and for <b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b>.
The arguments are the arguments that were supplied to the eﬀective method form
containing the invocation of <b><a 
href="symbols.html#x188-380189r189">call-method</a></b>. The deﬁnitions of <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>
and <b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b> rely on the list of method objects given as the second
argument to <b><a 
href="symbols.html#x188-380189r189">call-method</a></b>.
<!--l. 2936--><p class="indent" >   The <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> function available to the method that is the ﬁrst
subform will call the ﬁrst method in the list that is the second subform. The
<b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> function available in that method, in turn, will call the second
method in the list that is the second subform, and so on, until the list of next
methods is exhausted.
<!--l. 2943--><p class="indent" >   The <em>method</em> argument is a method object; the <em>next-method-list</em> argument is a
list of method objects.
<!--l. 2946--><p class="indent" >   A list whose ﬁrst element is the symbol <b>make-method</b> and whose second
element is a Lisp form can be used instead of a method object as the ﬁrst subform
of <b><a 
href="symbols.html#x188-380189r189">call-method</a></b> or as an element of the second subform of <b><a 
href="symbols.html#x188-380189r189">call-method</a></b>. Such a
list speciﬁes a method object whose method function has a body that is the given
form.
<!--l. 2952--><p class="indent" >   The result of <b><a 
href="symbols.html#x188-380189r189">call-method</a></b> is the value or values returned by the method
invocation.
<!--l. 2955--><p class="indent" >   See <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>, <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>, and <b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302007"></a>
<em>
<!--l. 2960--><p class="noindent" >[Function]</em> <b>call-next-method</b> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>args</i>
</div>
<!--l. 2962--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> can be used within the body of a method
deﬁned by a method-deﬁning form to call the next method.
<!--l. 2965--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> returns the value or values returned
by the method it calls. If there is no next method, the generic function
                                                                          

                                                                          
<b><a 
href="symbols.html#x188-380674r674">no-next-method</a></b> is called.
<!--l. 2969--><p class="indent" >   The type of method combination used determines which methods can
invoke <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>. The standard method combination type allows
<b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> to be used within primary methods and <b>:around</b>
methods.
<!--l. 2975--><p class="indent" >   The standard method combination type deﬁnes the next method according to
the following rules:
      <ul class="itemize1">
      <li class="itemize">If <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> is used in an <b>:around</b> method, the next method
      is the next most speciﬁc <b>:around</b> method, if one is applicable.
      </li>
      <li class="itemize">If there are no <b>:around</b> methods at all or if <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> is
      called by the least speciﬁc <b>:around</b> method, other methods are called
      as follows:
           <ul class="itemize2">
           <li class="itemize">All the <b>:before</b> methods are called, in most-speciﬁc-ﬁrst order.
           The  function  <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>  cannot  be  used  in  <b>:before</b>
           methods.
           </li>
           <li class="itemize">The most speciﬁc primary method is called. Inside the body of a
           primary method, <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> may be used to pass control
           to the next most speciﬁc primary method. The generic function
           <b><a 
href="symbols.html#x188-380674r674">no-next-method</a></b> is called if <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> is used and there
           are no more primary methods.
           </li>
           <li class="itemize">All the <b>:after</b> methods are called in most-speciﬁc-last order. The
           function <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> cannot be used in <b>:after</b> methods.</li></ul>
      </li></ul>
<!--l. 3007--><p class="indent" >   For further discussion of the use of <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>, see sections <a 
href="clmse143.html#x175-27600027.1.7">27.1.7<!--tex4ht:ref: Standard-Method-Combination-SECTION --></a>
and <a 
href="clmse143.html#x175-27800027.1.7">27.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a>.
<!--l. 3011--><p class="indent" >   When <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> is called with no arguments, it passes the current
method&#x2019;s original arguments to the next method. Neither argument defaulting,
                                                                          

                                                                          
nor using <b><a 
href="symbols.html#x188-380846r846">setq</a></b>, nor rebinding variables with the same names as parameters of the
method aﬀects the values <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> passes to the method it
calls.
<!--l. 3017--><p class="indent" >   When <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> is called with arguments, the next method is called
with those arguments. When providing arguments to <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>, the
following rule must be satisﬁed or an error is signaled: The ordered set of methods
applicable for a changed set of arguments for <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> must be the
same as the ordered set of applicable methods for the original arguments to the
generic function. Optimizations of the error checking are possible, but they must
not change the semantics of <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>.
<!--l. 3026--><p class="indent" >   If <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> is called with arguments but omits optional arguments,
the next method called defaults those arguments.
<!--l. 3029--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> returns the value or values returned by the
method it calls.
<!--l. 3032--><p class="indent" >   Further computation is possible after <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> returns.
<!--l. 3034--><p class="indent" >   The deﬁnition of the function <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> has lexical scope (for it is
deﬁned only within the body of a method deﬁned by a method-deﬁning form) and
indeﬁnite extent.
<!--l. 3038--><p class="indent" >   For generic functions using a type of method combination deﬁned by the short
form of <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>, <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> can be used in
<b>:around</b> methods only.
<!--l. 3042--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b> can be used to test whether or not there is a
next method.
<!--l. 3045--><p class="indent" >   If <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> is used in methods that do not support it, an error is
signaled.
<!--l. 3048--><p class="indent" >   See sections <a 
href="clmse143.html#x175-27400027.1.7">27.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>, <a 
href="clmse143.html#x175-27600027.1.7">27.1.7<!--tex4ht:ref: Standard-Method-Combination-SECTION --></a>, and <a 
href="clmse143.html#x175-27800027.1.7">27.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a> as well as the functions
<b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>, <b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b>, and <b><a 
href="symbols.html#x188-380674r674">no-next-method</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302008"></a>
<em>
<!--l. 3058--><p class="noindent" >[Generic function]</em> <b>change-class</b> <i>instance</i> <i>new-class</i><br />
<a 
 id="dx176-302009"></a>
<em>
[Primary method]</em> <b>change-class</b> (<i>instance</i> standard-object) (<i>new-class</i> standard-class)<br />
<a 
 id="dx176-302010"></a>
                                                                          

                                                                          
<em>
[Primary method]</em> <b>change-class</b> (<i>instance</i> t) (<i>new-class</i> symbol)
</div>
<!--l. 3062--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> changes the class of an instance to a new
class. It destructively modiﬁes and returns the instance.
<!--l. 3066--><p class="indent" >   If in the old class there is any slot of the same name as a local slot in the new
class, the value of that slot is retained. This means that if the slot has a value, the
value returned by <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b> after <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> is invoked is <b><a 
href="symbols.html#x188-380379r379">eql</a></b> to the value
returned by <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b> before <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> is invoked. Similarly, if the slot was
unbound, it remains unbound. The other slots are initialized as described in
section <a 
href="clmse143.html#x175-29600027.1.11">27.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a>.
<!--l. 3075--><p class="indent" >   The <em>instance</em> argument is a Lisp object.
<!--l. 3077--><p class="indent" >   The <em>new-class</em> argument is a class object or a symbol that names a
class.
<!--l. 3080--><p class="indent" >   If the second of the preceding methods is selected, that method invokes
<b><a 
href="symbols.html#x188-380214r214">change-class</a></b> on <em>instance</em> and <b>(ﬁnd-class <em>new-class</em>)</b>.
<!--l. 3084--><p class="indent" >   The modiﬁed instance is returned. The result of <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> is <b><a 
href="symbols.html#x188-380378r378">eq</a></b> to the
<em>instance</em> argument.
<!--l. 3087--><p class="indent" >   Examples:
<div class="lisp">
<tt>
<!--l. 3089--><p class="indent" >   <div class="tabbing">
(defclass position () ())
   <br>                           <br>                           (defclass x-y-position (position)<br>
  ((x :initform 0 :initarg :x)<br>                    (y :initform 0 :initarg :y)))<br>
<br>                                     (defclass rho-theta-position (position)<br>
  ((rho :initform 0)<br>                                   (theta :initform 0)))<br>
<br>                      (defmethod update-instance-for-diﬀerent-class :before<br>
           ((old x-y-position)<br>
            (new rho-theta-position)<br>                            &#x0026;key)<br>
  ;; Copy the position information from old to new to make new<br>
  ;; be a rho-theta-position at the same position as old.<br>
  (let ((x (slot-value old &#x2019;x))<br>                       (y (slot-value old &#x2019;y)))<br>
    (setf (slot-value new &#x2019;rho) (sqrt (+ (* x x) (* y y)))<br>
          (slot-value new &#x2019;theta) (atan y x))))<br>
                                                                          

                                                                          
<!--l. 3110--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 3111--><p class="indent" >   <div class="tabbing">
;;; At this point an instance of the class x-y-position can be
   <br>                 ;;; changed to be an instance of the class rho-theta-position<br>
;;; using change-class:<br>   <br>    (setq p1 (make-instance &#x2019;x-y-position :x 2 :y 0))<br>
<br>                                       (change-class p1 &#x2019;rho-theta-position)<br>
<br>                      ;;; The result is that the instance bound to p1 is now<br>
;;; an instance of the class rho-theta-position.<br>
;;; The update-instance-for-diﬀerent-class method<br>
;;; performed the initialization of the rho and theta<br>
;;; slots based on the values of the x and y slots,<br>
;;; which were maintained by the old instance.<br>
<!--l. 3126--><p class="noindent" ></div>
</tt>
</div>
<!--l. 3128--><p class="indent" >   After completing all other actions, <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> invokes the generic
function <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b>. The generic function
<b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> can be used to assign values to slots in the
transformed instance.
<!--l. 3133--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> has several semantic diﬃculties. First, it
performs a destructive operation that can be invoked within a method on an
instance that was used to select that method. When multiple methods are
involved because methods are being combined, the methods currently executing or
about to be executed may no longer be applicable. Second, some implementations
might use compiler optimizations of slot access, and when the class of an instance
is changed the assumptions the compiler made might be violated. This
implies that a programmer must not use <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> inside a method if
any methods for that generic function access any slots, or the results are
undeﬁned.
<!--l. 3145--><p class="indent" >   See section <a 
href="clmse143.html#x175-29600027.1.11">27.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b>.
<hr></div>
                                                                          

                                                                          
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302011"></a>
<em>
<!--l. 3150--><p class="noindent" >[Generic function]</em> <b>class-name</b> <i>class</i><br />
<a 
 id="dx176-302012"></a>
<em>
[Primary method]</em> <b>class-name</b> (<i>class</i> class)
</div>
<!--l. 3153--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380244r244">class-name</a></b> takes a class object and returns its
name.
<!--l. 3156--><p class="indent" >   The <em>class</em> argument is a class object. The name of the given class is
returned.
<!--l. 3159--><p class="indent" >   The name of an anonymous class is <b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
<!--l. 3161--><p class="indent" >   If <em>S</em> is a symbol such that <em>S</em> =<b>(class-name <em>C</em>)</b> and <em>C</em> = <b>(ﬁnd-class <em>S</em>)</b>,
then <em>S</em> is the proper name of <em>C</em> (see section <a 
href="clmse143.html#x175-25400027.1.2">27.1.2<!--tex4ht:ref: Classes-SECTION --></a>).
<!--l. 3164--><p class="indent" >   See also section <a 
href="clmse143.html#x175-25400027.1.2">27.1.2<!--tex4ht:ref: Classes-SECTION --></a> and <b><a 
href="symbols.html#x188-380415r415">ﬁnd-class</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302013"></a>
<em>
<!--l. 3168--><p class="noindent" >[Generic function]</em> <b>(setf class-name)</b>  <i>new-value</i> <i>class</i><br />
<a 
 id="dx176-302014"></a>
<em>
[Primary method]</em> <b>(setf class-name)</b>  <i>new-value</i> (<i>class</i> class)
</div>
<!--l. 3171--><p class="indent" >   The generic function <b>(setf class-name)</b> takes a class object and sets its
name.
<!--l. 3174--><p class="indent" >   The <em>class</em> argument is a class object. The <em>new-value</em> argument is any
object.
<hr></div>
<div class="defun">
<div class="defunheader">
                                                                          

                                                                          
<a 
 id="dx176-302015"></a>
<em>
<!--l. 3179--><p class="noindent" >[Function]</em> <b>class-of</b> <i>object</i>
</div>
<!--l. 3181--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380245r245">class-of</a></b> returns the class of which the given object is an
instance. The argument to <b><a 
href="symbols.html#x188-380245r245">class-of</a></b> may be any Common Lisp object.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302016"></a>
<em>
<!--l. 3187--><p class="noindent" >[Function]</em> <b>compute-applicable-methods</b> <i>generic-function</i> <i>function-arguments</i>
</div>
<!--l. 3189--><p class="indent" >   Given a generic function and a set of arguments, the function
<b><a 
href="symbols.html#x188-380270r270">compute-applicable-methods</a></b> returns the set of methods that are applicable
for those arguments.
<!--l. 3193--><p class="indent" >   The methods are sorted according to precedence order. See section <a 
href="clmse143.html#x175-27400027.1.7">27.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>.
<!--l. 3197--><p class="indent" >   The <em>generic-function</em> argument must be a generic function object. The
<em>function-arguments</em> argument is a list of the arguments to that generic function.
The result is a list of the applicable methods in order of precedence. See
section <a 
href="clmse143.html#x175-27400027.1.7">27.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>.
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 3205--><p class="indent" >   <div class="tabbing">
 <em>[Macro]</em> <b>defclass</b> <a 
 id="dx176-302017"></a>class-name ({superclass-name}*)({slot-speciﬁer}*) [[<span class="math"> ↓</span>class-option]]
   <br>
<!--l. 3207--><p class="noindent" ></div>
</div>
<!--l. 3208--><p class="indent" >   <div class="tabbing">
<em>class-name</em> ::= <em>symbol</em>
                                                                          

                                                                          
   <br>                                                       <em>superclass-name</em> ::= <em>symbol</em><br>
<em>slot-speciﬁer</em> ::= <em>slot-name</em> | (<em>slot-name</em> <span class="math">[[↓slot-option ]]</span>)<br>
<em>slot-name</em> ::= <em>symbol</em><br>     <em>slot-option</em> ::=  {<i><b>:reader</b> <em>reader-function-name</em></i>}* <br>
|  {<i><b>:writer</b> <em>writer-function-name</em></i>}* <br>   |  {<i><b>:accessor</b> <em>reader-function-name</em></i>}* <br>
|  {<i><b>:allocation</b> <em>allocation-type</em></i>} <br>                     |  {<i><b>:initarg</b> <em>initarg-name</em></i>}* <br>
|  {<i><b>:initform</b> <em>form</em></i>} <br>                                         |  {<i><b>:type</b> <em>type-speciﬁer</em></i>} <br>
|  {<i><b>:documentation</b> <em>string</em></i>} <br>
<!--l. 3223--><p class="noindent" ></div>
<!--l. 3225--><p class="indent" >   <div class="tabbing">
<em>reader-function-name</em> ::= <em>symbol</em>
   <br>                                       <em>writer-function-name</em> ::= <em>function-name</em><br>
<em>function-name</em> ::=  {<i><em>symbol</em> | <b>(setf <em>symbol</em>)</b></i>} <br>
<em>initarg-name</em> ::= <em>symbol</em><br>              <em>allocation-type</em> ::= <b>:instance | :class</b><br>
<em>class-option</em> ::= <b>(:default-initargs <em>initarg-list</em>)</b><br>
| <b>(:documentation <em>string</em>)</b><br>                 | <b>(:metaclass <em>class-name</em>)</b><br>
<em>initarg-list</em> ::=  {<i><em>initarg-name default-initial-value-form</em></i>}* <br>
<!--l. 3235--><p class="noindent" ></div>The macro <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> deﬁnes a new named class. It returns the new class object as its
result.
<!--l. 3239--><p class="indent" >   The syntax of <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> provides options for specifying initialization arguments
for slots, for specifying default initialization values for slots, and for requesting
that methods on speciﬁed generic functions be automatically generated for
reading and writing the values of slots. No reader or writer functions are deﬁned
by default; their generation must be explicitly requested.
<!--l. 3246--><p class="indent" >   Deﬁning a new class also causes a type of the same name to be deﬁned. The
predicate <b>(typep <em>object class-name</em>)</b> returns true if the class of the given
object is <em>class-name</em> itself or a subclass of the class <em>class-name</em>. A class object can
be used as a type speciﬁer. Thus <b>(typep <em>object class</em>)</b> returns true if the class of
the <em>object</em> is <em>class</em> itself or a subclass of <em>class</em>.
<!--l. 3254--><p class="indent" >   The <em>class-name</em> argument is a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> symbol. It becomes the proper name of
the new class. If a class with the same proper name already exists and that class
is an instance of <b>standard-class</b>, and if the <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> form for the deﬁnition of
the new class speciﬁes a class of class <b>standard-class</b>, the deﬁnition of the
existing class is replaced.
                                                                          

                                                                          
<!--l. 3261--><p class="indent" >   Each <em>superclass-name</em> argument is a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> symbol that speciﬁes a direct
superclass of the new class. The new class will inherit slots and methods
from each of its direct superclasses, from their direct superclasses, and
so on. See section <a 
href="clmse143.html#x175-25900027.1.3">27.1.3<!--tex4ht:ref: Inheritance-SECTION --></a> for a discussion of how slots and methods are
inherited.
<!--l. 3268--><p class="indent" >   Each <em>slot-speciﬁer</em> argument is the name of the slot or a list consisting of the
slot name followed by zero or more slot options. The <em>slot-name</em> argument is a
symbol that is syntactically valid for use as a variable name. If there are any
duplicate slot names, an error is signaled.
<!--l. 3274--><p class="indent" >   The following slot options are available:
      <ul class="itemize1">
      <li class="itemize">The <b>:reader</b> slot option speciﬁes that an unqualiﬁed method is to be
      deﬁned on the generic function named <em>reader-function-name</em> to read
      the value of the given slot. The <em>reader-function-name</em> argument is a
      non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> symbol. The <b>:reader</b> slot option may be speciﬁed more than
      once for a given slot.
      </li>
      <li class="itemize">The  <b>:writer</b> slot  option  speciﬁes  that  an  unqualiﬁed  method  is  to
      be  deﬁned  on  the  generic  function  named  <em>writer-function-name</em>  to
      write the value of the slot. The <em>writer-function-name</em> argument is a
      function-name. The <b>:writer</b> slot option may be speciﬁed more than
      once for a given slot.
      </li>
      <li class="itemize">The <b>:accessor</b> slot option speciﬁes that an unqualiﬁed method is to be
      deﬁned on the generic function named <em>reader-function-name</em> to read
      the value of the given slot and that an unqualiﬁed method is to be
      deﬁned on the generic function named <b>(setf <em>reader-function-name</em>)</b>
      to  be  used  with  <b><a 
href="symbols.html#x188-380845r845">setf</a></b>  to  modify  the  value  of  the  slot.  The
      <em>reader-function-name</em> argument is a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> symbol. The <b>:accessor</b>
      slot option may be speciﬁed more than once for a given slot.
      </li>
      <li class="itemize">The <b>:allocation</b> slot option is used to specify where storage is to be
      allocated for the given slot. Storage for a slot may be located in each
      instance or in the class object itself, for example. The value of the
                                                                          

                                                                          
      <em>allocation-type</em> argument can be either the keyword <b>:instance</b> or the
      keyword <b>:class</b>. The <b>:allocation</b> slot option may be speciﬁed at most
      once for a given slot. If the <b>:allocation</b> slot option is not speciﬁed, the
      eﬀect is the same as specifying <b>:allocation :instance</b>.
           <ul class="itemize2">
           <li class="itemize">If <em>allocation-type</em> is <b>:instance</b>, a local slot of the given name is
           allocated in each instance of the class.
           </li>
           <li class="itemize">If  <em>allocation-type</em> is  <b>:class</b>,  a  shared  slot  of  the  given  name  is
           allocated. The value of the slot is shared by all instances of the
           class. If a class <span class="math">C<sub>1</sub></span>  deﬁnes such a shared slot, any subclass <span class="math">C<sub>2</sub></span>
           of <span class="math">C<sub>1</sub></span>  will share this single slot unless the <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> form for <span class="math">C<sub>2</sub></span>
           speciﬁes a slot of the same name or there is a superclass of <span class="math">C<sub>2</sub></span> that
           precedes <span class="math">C<sub>1</sub></span>  in the class precedence list of <span class="math">C<sub>2</sub></span>  and that deﬁnes a
           slot of the same name.</li></ul>
      </li>
      <li class="itemize">The <b>:initform</b> slot option is used to provide a default initial value
      form to be used in the initialization of the slot. The <b>:initform</b> slot
      option may be speciﬁed at most once for a given slot. This form is
      evaluated every time it is used to initialize the slot. The lexical
      environment in which this form is evaluated is the lexical environment
      in which the <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> form was evaluated. Note that the lexical
      environment refers both to variables and to functions. For local slots,
      the dynamic environment is the dynamic environment in which
      <b><a 
href="symbols.html#x188-380595r595">make-instance</a></b> was called; for shared slots, the dynamic environment is the
      dynamic environment in which the <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> form was evaluated. See
      section <a 
href="clmse143.html#x175-28300027.1.9">27.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>.
      <!--l. 3344--><p class="noindent" >No implementation is permitted to extend the syntax of <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> to allow
      <b>(<em>slot-name form</em>)</b> as an abbreviation for <b>(<em>slot-name</em> :initform
      <em>form</em>)</b>.
      </li>
      <li class="itemize">The <b>:initarg</b> slot option declares an initialization argument named
      <em>initarg-name</em> and speciﬁes that this initialization argument initializes the
      given slot. If the initialization argument has a value in the call to
                                                                          

                                                                          
      <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b>, the value will be stored into the given slot, and the
      slot&#x2019;s <b>:initform</b> slot option, if any, is not evaluated. If none of the
      initialization arguments speciﬁed for a given slot has a value, the slot is
      initialized according to the <b>:initform</b> slot option, if speciﬁed. The <b>:initarg</b>
      slot option can be speciﬁed more than once for a given slot. The
      <em>initarg-name</em> argument can be any symbol.
      </li>
      <li class="itemize">The <b>:type</b> slot option speciﬁes that the contents of the slot will always be of
      the speciﬁed data type. It eﬀectively declares the result type of the reader
      generic function when applied to an object of this class. The result of
      attempting to store in a slot a value that does not satisfy the type of the
      slot is undeﬁned. The <b>:type</b> slot option may be speciﬁed at most
      once for a given slot. The <b>:type</b> slot option is further discussed in
      section <a 
href="clmse143.html#x175-26100027.1.3">27.1.3<!--tex4ht:ref: Inheritance-of-Slots-and-Slot-Options-SECTION --></a>.
      </li>
      <li class="itemize">The <b>:documentation</b> slot option provides a documentation string for the
      slot.</li></ul>
<!--l. 3375--><p class="indent" >   Each class option is an option that refers to the class as a whole or to all class
slots. The following class options are available:
      <ul class="itemize1">
      <li class="itemize">The <b>:default-initargs</b> class option is followed by a list of alternating
      initialization argument names and default initial value forms. If any
      of these initialization arguments does not appear in the initialization
      argument list supplied to <b><a 
href="symbols.html#x188-380595r595">make-instance</a></b>, the corresponding default
      initial value form is evaluated, and the initialization argument name
      and  the  form&#x2019;s  value  are  added  to  the  end  of  the  initialization
      argument list before the instance is created (see section <a 
href="clmse143.html#x175-28300027.1.9">27.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>). The
      default  initial  value  form  is  evaluated  each  time  it  is  used.  The
      lexical  environment  in  which  this  form  is  evaluated  is  the  lexical
      environment in which the <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> form was evaluated. The dynamic
      environment  is  the  dynamic  environment  in  which  <b><a 
href="symbols.html#x188-380595r595">make-instance</a></b>
      was  called.  If  an  initialization  argument  name  appears  more  than
      once  in  a  <b>:default-initargs</b> class  option,  an  error  is  signaled.  The
      <b>:default-initargs</b> class option may be speciﬁed at most once.
                                                                          

                                                                          
      </li>
      <li class="itemize">The <b>:documentation</b> class option causes a documentation string to be
      attached to the class name. The documentation type for this string is
      <b>type</b>. The form <b>(documentation <em>class-name</em> &#x2019;type)</b> may be used to
      retrieve the documentation string. The <b>:documentation</b> class option
      may be speciﬁed at most once.
      </li>
      <li class="itemize">The <b>:metaclass</b> class option is used to specify that instances of the
      class being deﬁned are to have a diﬀerent metaclass than the default
      provided by the system (the class <b>standard-class</b>). The <em>class-name</em>
      argument is the name of the desired metaclass. The <b>:metaclass</b> class
      option may be speciﬁed at most once.</li></ul>
<!--l. 3411--><p class="indent" >   The new class object is returned as the result.
<!--l. 3413--><p class="indent" >   If a class with the same proper name already exists and that class is an
instance of <b>standard-class</b>, and if the <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> form for the deﬁnition of the new
class speciﬁes a class of class <b>standard-class</b>, the existing class is redeﬁned, and
instances of it (and its subclasses) are updated to the new deﬁnition at the time
that they are next accessed (see section <a 
href="clmse143.html#x175-29100027.1.10">27.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a>).
<!--l. 3420--><p class="indent" >   Note the following rules of <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> for standard classes:
      <ul class="itemize1">
      <li class="itemize">It is not required that the superclasses of a class be deﬁned before the
      <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> form for that class is evaluated.
      </li>
      <li class="itemize">All the superclasses of a class must be deﬁned before an instance of the
      class can be made.
      </li>
      <li class="itemize">A class must be deﬁned before it can be used as a parameter specializer
      in a <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b> form.</li></ul>
<!--l. 3437--><p class="indent" >   The Object System may be extended to cover situations where these rules are
not obeyed.
<!--l. 3440--><p class="indent" >   Some slot options are inherited by a class from its superclasses, and some can
be shadowed or altered by providing a local slot description. No class options
except <b>:default-initargs</b> are inherited. For a detailed description of how slots and
slot options are inherited, see section <a 
href="clmse143.html#x175-26100027.1.3">27.1.3<!--tex4ht:ref: Inheritance-of-Slots-and-Slot-Options-SECTION --></a>.
                                                                          

                                                                          
<!--l. 3446--><p class="indent" >   The options to <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> can be extended. An implementation must signal an
error if it observes a class option or a slot option that is not implemented
locally.
<!--l. 3450--><p class="indent" >   It is valid to specify more than one reader, writer, accessor, or initialization
argument for a slot. No other slot option may appear more than once in a single
slot description, or an error is signaled.
<!--l. 3455--><p class="indent" >   If no reader, writer, or accessor is speciﬁed for a slot, the slot can be accessed
only by the function <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b>.
<!--l. 3458--><p class="indent" >   See sections <a 
href="clmse143.html#x175-25400027.1.2">27.1.2<!--tex4ht:ref: Classes-SECTION --></a>, <a 
href="clmse143.html#x175-25900027.1.3">27.1.3<!--tex4ht:ref: Inheritance-SECTION --></a>, <a 
href="clmse143.html#x175-29100027.1.10">27.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a>, <a 
href="clmse143.html#x175-26500027.1.5">27.1.5<!--tex4ht:ref: Determining-the-Class-Precedence-List-SECTION --></a>, <a 
href="clmse143.html#x175-28300027.1.9">27.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b>,
<b><a 
href="symbols.html#x188-380595r595">make-instance</a></b>, and <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b>.
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 3469--><p class="indent" >   <div class="tabbing">
 <em>[Macro]</em> <b>defgeneric</b> <a 
 id="dx176-302018"></a>function-name lambda-list[[<span class="math"> ↓</span>option | {method-description}*]]
   <br>
<!--l. 3471--><p class="noindent" ></div>
</div>
<!--l. 3472--><p class="indent" >   <div class="tabbing">
<em>function-name</em> ::=  {<i><em>symbol</em> | <b>(setf <em>symbol</em>)</b></i>}
   <br>                                                               <em>lambda-list</em> ::= <b>(</b> {<i>var</i>}* <br>
                 [<i><b>&optional</b> {<i>var | <b>(<em>var</em>)</b></i>}*</i>] <br>                        [<i><b>&rest</b> <em>var</em></i>] <br>
                 [<i><b>&key</b> {<i>keyword-parameter</i>}*  [<i><b>&allow-other-keys</b></i>]</i>] <b>)</b><br>
<!--l. 3478--><p class="noindent" ></div><div class="tabbing">
<em>keyword-parameter</em> ::= <em>var</em> | <b>( {<i>var | <b>(<em>keyword</em> <em>var</em>)</b></i>} )</b>
   <br>
<em>option</em> ::= <b>(:argument-precedence-order  {<i>parameter-name</i>}+ )</b>
   <br>
| <b>(declare  {<i>declaration</i>}+ )</b>
                                                                          

                                                                          
   <br>                                                 | <b>(:documentation <em>string</em>)</b><br>
| <b>(:method-combination <em>symbol</em> {<i>arg</i>}* )</b><br>
| <b>(:generic-function-class <em>class-name</em>)</b><br>| <b>(:method-class <em>class-name</em>)</b><br>
<em>method-description</em> ::= <b>(:method </b> {<i>method-qualiﬁer</i>}*
   <br>          <em>specialized-lambda-list</em><br>          [[<i> {<i>declaration</i>}* | documentation</i>]] <br>
 {<i>form</i>}* <b>)</b><br>
<em>method-qualiﬁer</em> ::= <em>non-nil-atom</em>
   <br>
<em>specialized-lambda-list</em> ::=
   <br>                                     <b>(</b> {<i>var | <b>(</b>var parameter-specializer-name<b>)</b></i>}* <br>
 [<i><b>&optional</b> {<i>var | <b>(</b>var [<i>initform [<i>supplied-p-parameter</i>]</i>]<b>)</b></i>}*</i>] <br>
 [<i><b>&rest <em>var</em></b></i>] <br>
 [<i><b>&key</b> {<i>specialized-keyword-parameter</i>}*  [<i><b>&allow-other-keys</b></i>]</i>] <br>
 [<i><b>&aux</b> {<i>var | <b>(<em>var</em>  [<i>initform</i>])</b></i>}*</i>] <b>)</b><br>
<em>specialized-keyword-parameter</em> ::=
   <br>       <em>var</em> | <b>(</b> {<i>var | <b>(<em>keyword</em> <em>var</em><b>)</b></b></i>}  [<i>initform [<i>supplied-p-parameter</i>]</i>] <b>)</b><br>
<em>parameter-specializer-name</em> ::= <em>symbol</em> | <b>(eql <em>eql-specializer-form</em>)</b>
   <br>
<!--l. 3502--><p class="noindent" ></div>The macro <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b> is used to deﬁne a generic function or to specify options and
declarations that pertain to a generic function as a whole.
<!--l. 3507--><p class="indent" >   If <b>(fboundp <em>function-name</em>)</b> is <b><a 
href="symbols.html#x188-380670r670">nil</a></b>, a new generic function is created. If
<b>(fdeﬁnition <em>function-speci er</em>)</b> is a generic function, that generic function is
modiﬁed. If <em>function-name</em> names a non-generic function, a macro, or a special
operator, an error is signaled.
<!--l. 3513--><p class="indent" >   [X3J13 voted in March 1989 <a 
 id="dx176-302019"></a>to use <b><a 
href="symbols.html#x188-380398r398">fdeﬁnition</a></b> in the previous paragraph, as
shown, rather than <b><a 
href="symbols.html#x188-380945r945">symbol-function</a></b>, as it appeared in the original report on
CLOS <span class="cite">[<a 
href="bib.html#XSIGPLAN-CLOS">5</a>, <a 
href="bib.html#XLASC-CLOS-PART-2">7</a>]</span>. The vote also changed all occurrences of <em>function-speciﬁer</em> in the
original report to <em>function-name</em>; this change is reﬂected here.—GLS]
<!--l. 3519--><p class="indent" >   Each <em>method-description</em> deﬁnes a method on the generic function.
The lambda-list of each method must be congruent with the lambda-list
speciﬁed by the <em>lambda-list</em> option. If this condition does not hold, an
error is signaled. See section <a 
href="clmse143.html#x175-27200027.1.6">27.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a> for a deﬁnition of congruence in this
context.
<!--l. 3527--><p class="indent" >   The macro <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b> returns the generic function object as its result.
<!--l. 3530--><p class="indent" >   The <em>function-name</em> argument is a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> symbol or a list of the form <b>(setf
<em>symbol</em>)</b>.
                                                                          

                                                                          
<!--l. 3533--><p class="indent" >   The <em>lambda-list</em> argument is an ordinary function lambda-list with the
following exceptions:
      <ul class="itemize1">
      <li class="itemize">The use of <b>&#x0026;aux</b> is not allowed.
      </li>
      <li class="itemize">Optional and keyword arguments may not have default initial value
      forms nor use supplied-p parameters. The generic function passes to
      the method all the argument values passed to it, and only those; default
      values are not supported. Note that optional and keyword arguments
      in method deﬁnitions, however, can have default initial value forms and
      can use supplied-p parameters.</li></ul>
<!--l. 3549--><p class="indent" >   The following options are provided. A given option may occur only once, or an
error is signaled.
      <ul class="itemize1">
      <li class="itemize">The <b>:argument-precedence-order</b> option is used to specify the order
      in which the required arguments in a call to the generic function are
      tested for speciﬁcity when selecting a particular method. Each required
      argument, as speciﬁed in the <em>lambda-list</em> argument, must be included
      exactly once as a <em>parameter-name</em> so that the full and unambiguous
      precedence order is supplied. If this condition is not met, an error is
      signaled.
      </li>
      <li class="itemize">The <b><a 
href="symbols.html#x188-380307r307">declare</a></b> option is used to specify declarations that pertain to the
      generic function. The following standard Common Lisp declaration is
      allowed:
           <ul class="itemize2">
           <li class="itemize">An  <b>optimize</b>  declaration  speciﬁes  whether  method  selection
           should be optimized for speed or space, but it has no eﬀect on
           methods. To control how a method is optimized, an <b>optimize</b>
           declaration  must  be  placed  directly  in  the  <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b>  form
           or  method  description.  The  optimization  qualities  <b>speed</b> and
                                                                          

                                                                          
           <b>space</b>  are  the  only  qualities  this  standard  requires,  but  an
           implementation can extend the Common Lisp Object System to
           recognize  other  qualities.  A  simple  implementation  that  has
           only one method selection technique and ignores the <b>optimize</b>
           declaration is valid.</li></ul>
      <!--l. 3580--><p class="noindent" >The <b>special</b>, <b>ftype</b>, <b><a 
href="symbols.html#x188-380446r446">function</a></b>, <b>inline</b>, <b>notinline</b>, and <b>declaration</b>
      declarations are not permitted. Individual implementations can extend the
      <b><a 
href="symbols.html#x188-380307r307">declare</a></b> option to support additional declarations. If an implementation
      notices a declaration that it does not support and that has not been
      proclaimed as a non-standard declaration name in a <b>declaration</b>
      proclamation, it should issue a warning.
      </li>
      <li class="itemize">The <b>:documentation</b> argument associates a documentation string with the
      generic function. The documentation type for this string is <b><a 
href="symbols.html#x188-380446r446">function</a></b>. The
      form <b>(documentation <em>function-name</em> &#x2019;function)</b> may be used to
      retrieve this string.
      </li>
      <li class="itemize">The <b>:generic-function-class</b> option may be used to specify that the
      generic function is to have a diﬀerent class than the default provided by the
      system (the class <b>standard-generic-function</b>). The <em>class-name</em> argument
      is the name of a class that can be the class of a generic function. If
      <em>function-name</em> speciﬁes an existing generic function that has a diﬀerent
      value for the <b>:generic-function-class</b> argument and the new generic
      function class is compatible with the old, <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> is called
      to change the class of the generic function; otherwise an error is
      signaled.
      </li>
      <li class="itemize">The <b>:method-class</b> option is used to specify that all methods on
      this generic function are to have a diﬀerent class from the default
      provided by the system (the class <b>standard-method</b>). The <em>class-name</em>
      argument is the name of a class that is capable of being the class of a
      method.
      </li>
      <li class="itemize">The <b>:method-combination</b> option is followed by a symbol that names a
                                                                          

                                                                          
      type of method combination. The arguments (if any) that follow that
      symbol depend on the type of method combination. Note that the
      standard method combination type does not support any arguments.
      However, all types of method combination deﬁned by the short form of
      <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b> accept an optional argument named <em>order</em>,
      defaulting to <b>:most-speciﬁc-ﬁrst</b>, where a value of <b>:most-speciﬁc-last</b>
      reverses the order of the primary methods without aﬀecting the order of the
      auxiliary methods.</li></ul>
<!--l. 3626--><p class="indent" >   The <em>method-description</em> arguments deﬁne methods that will be associated with
the generic function. The <em>method-qualiﬁer</em> and <em>specialized-lambda-list</em> arguments
in a method description are the same as for <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b>.
<!--l. 3631--><p class="indent" >   The <em>form</em> arguments specify the method body. The body of the method is
enclosed in an implicit block. If <em>function-name</em> is a symbol, this block bears the
same name as the generic function. If <em>function-name</em> is a list of the form <b>(setf
<em>symbol</em>)</b>, the name of the block is <em>symbol</em>.
<!--l. 3637--><p class="indent" >   The generic function object is returned as the result.
<!--l. 3639--><p class="indent" >   The eﬀect of the <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b> macro is as if the following three steps
were performed: ﬁrst, methods deﬁned by previous <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b> forms
are removed; second, <b><a 
href="symbols.html#x188-380376r376">ensure-generic-function</a></b> is called; and ﬁnally,
methods speciﬁed by the current <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b> form are added to the generic
function.
<!--l. 3645--><p class="indent" >   If no method descriptions are speciﬁed and a generic function of the
same name does not already exist, a generic function with no methods is
created.
<!--l. 3648--><p class="indent" >   The <em>lambda-list</em> argument of <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b> speciﬁes the shape of lambda-lists for
the methods on this generic function. All methods on the resulting generic
function must have lambda-lists that are congruent with this shape. If a
<b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b> form is evaluated and some methods for that generic function have
lambda-lists that are not congruent with that given in the <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b>
form, an error is signaled. For further details on method congruence, see
section <a 
href="clmse143.html#x175-27200027.1.6">27.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a>.
<!--l. 3659--><p class="indent" >   Implementations can extend <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b> to include other options. It is
required that an implementation signal an error if it observes an option that is not
implemented locally.
<!--l. 3663--><p class="indent" >   See section <a 
href="clmse143.html#x175-27200027.1.6">27.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b>, <b><a 
href="symbols.html#x188-380376r376">ensure-generic-function</a></b>, and
<b><a 
href="symbols.html#x188-380452r452">generic-function</a></b>.
<hr></div>
                                                                          

                                                                          
<div class="defmac">
<div class="defmacheader">
<!--l. 3669--><p class="indent" >   <div class="tabbing">
 <em>[Macro]</em> <b>deﬁne-method-combination</b> <a 
 id="dx176-302020"></a>name [[<span class="math"> ↓</span>short-form-option]]
   <br>
<!--l. 3669--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 3669--><p class="indent" >   <div class="tabbing">
 <em>[Macro]</em> <b>deﬁne-method-combination</b> <a 
 id="dx176-302021"></a>name lambda-list({method-group-speciﬁer}*)[(<b>:arguments</b> <b>.</b> lambda-list)][(<b>:generic-function</b> generic-fn-symbol)][[{declaration}* | doc-string]]{form}*
   <br>
<!--l. 3676--><p class="noindent" ></div>
</div>
<!--l. 3677--><p class="indent" >   <div class="tabbing">
<em>short-form-option</em> ::= <b>:documentation <em>string</em></b>
   <br>   | <b>:identity-with-one-argument <em>boolean</em></b><br>   | <b>:operator <em>operator</em></b><br>
<em>method-group-speciﬁer</em> ::= <b>(</b><em>variable</em> {<i> {<i>qualiﬁer-pattern</i>}+ | predicate</i>} <br>
                            [[<i><span class="math"> ↓</span><i>long-form-option</i></i>]] <b>)</b><br>
<em>long-form-option</em> ::= <b>:description <em>format-string</em></b><br>         | <b>:order <em>order</em></b><br>
| <b>:required <em>boolean</em></b><br>
<!--l. 3687--><p class="noindent" ></div>The macro <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b> is used to deﬁne new types of method
combination.
<!--l. 3691--><p class="indent" >   There are two forms of <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>. The short form is a
simple facility for the cases that are expected to be most commonly needed. The
long form is more powerful but more verbose. It resembles <b><a 
href="symbols.html#x188-380320r320">defmacro</a></b> in that the
body is an expression, usually using backquote, that computes a Lisp form. Thus
arbitrary control structures can be implemented. The long form also allows
arbitrary processing of method qualiﬁers.
<!--l. 3699--><p class="indent" >   In both the short and long forms, <em>name</em> is a symbol. By convention,
non-keyword, non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> symbols are usually used.
                                                                          

                                                                          
<!--l. 3704--><p class="indent" >   The short-form syntax of <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b> is recognized
when the second subform is a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> symbol or is not present. When the
short form is used, <em>name</em> is deﬁned as a type of method combination that
produces a Lisp form <b>(<em>operator method-call method-call <span class="math">…</span> </em>)</b>. The
<em>operator</em> is a symbol that can be the name of a function, macro, or special
operator. The <em>operator</em> can be speciﬁed by a keyword option; it defaults to
<em>name</em>.
<!--l. 3713--><p class="indent" >   Keyword options for the short form are the following:
      <ul class="itemize1">
      <li class="itemize">The    <b>:documentation</b>   option    is    used    to    document    the
      method-combination type.
      </li>
      <li class="itemize">The <b>:identity-with-one-argument</b> option enables an optimization
      when  <em>boolean</em>  is  true  (the  default  is  false).  If  there  is  exactly  one
      applicable method and it is a primary method, that method serves
      as the eﬀective method and <em>operator</em> is not called. This optimization
      avoids  the  need  to  create  a  new  eﬀective  method  and  avoids  the
      overhead of a function call. This option is designed to be used with
      operators such as <b><a 
href="symbols.html#x188-380762r762">progn</a></b>, <b><a 
href="symbols.html#x188-380098r98">and</a></b>, <b><a 
href="symbols.html#x188-380060r60">+</a></b>, and <b><a 
href="symbols.html#x188-380624r624">max</a></b>.
      </li>
      <li class="itemize">The <b>:operator</b> option speciﬁes the name of the operator. The <em>operator</em>
      argument is a symbol that can be the name of a function, macro, or
      special operator. By convention, <em>name</em> and <em>operator</em> are often the same
      symbol. This is the default, but it is not required.</li></ul>
<!--l. 3738--><p class="indent" >   None of the subforms is evaluated.
<!--l. 3740--><p class="indent" >   These types of method combination require exactly one qualiﬁer per method.
An error is signaled if there are applicable methods with no qualiﬁers
or with qualiﬁers that are not supported by the method combination
type.
<!--l. 3745--><p class="indent" >   A method combination procedure deﬁned in this way recognizes two roles for
methods. A method whose one qualiﬁer is the symbol naming this type of
method combination is deﬁned to be a primary method. At least one
primary method must be applicable or an error is signaled. A method with
<b>:around</b> as its one qualiﬁer is an auxiliary method that behaves the same
                                                                          

                                                                          
as an <b>:around</b> method in standard method combination. The function
<b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> can be used only in <b>:around</b> methods; it cannot be used in
primary methods deﬁned by the short form of the <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>
macro.
<!--l. 3755--><p class="indent" >   A method combination procedure deﬁned in this way accepts an optional
argument named <em>order</em>, which defaults to <b>:most-speciﬁc-ﬁrst</b>. A value of
<b>:most-speciﬁc-last</b> reverses the order of the primary methods without aﬀecting
the order of the auxiliary methods.
<!--l. 3761--><p class="indent" >   The short form automatically includes error checking and support for <b>:around</b>
methods.
<!--l. 3764--><p class="indent" >   For a discussion of built-in method combination types, see section <a 
href="clmse143.html#x175-27800027.1.7">27.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a>.
<!--l. 3769--><p class="indent" >   The long-form syntax of <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b> is recognized when
the second subform is a list.
<!--l. 3772--><p class="indent" >   The <em>lambda-list</em> argument is an ordinary lambda-list. It receives any
arguments provided after the name of the method combination type in the
<b>:method-combination</b> option to <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b>.
<!--l. 3777--><p class="indent" >   A list of method group speciﬁers follows. Each speciﬁer selects a subset of the
applicable methods to play a particular role, either by matching their qualiﬁers
against some patterns or by testing their qualiﬁers with a predicate. These
method group speciﬁers deﬁne all method qualiﬁers that can be used with this
type of method combination. If an applicable method does not fall into any
method group, the system signals the error that the method is invalid for the kind
of method combination in use.
<!--l. 3785--><p class="indent" >   Each method group speciﬁer names a variable. During the execution of the
forms in the body of <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>, this variable is bound to a
list of the methods in the method group. The methods in this list occur in
most-speciﬁc-ﬁrst order.
<!--l. 3790--><p class="indent" >   A qualiﬁer pattern is a list or the symbol <b><a 
href="symbols.html#x188-380011r11">*</a></b>. A method matches a qualiﬁer
pattern if the method&#x2019;s list of qualiﬁers is <b><a 
href="symbols.html#x188-380381r381">equal</a></b> to the qualiﬁer pattern (except
that the symbol <b><a 
href="symbols.html#x188-380011r11">*</a></b> in a qualiﬁer pattern matches anything). Thus a qualiﬁer
pattern can be one of the following: the empty list <b>()</b>, which matches unqualiﬁed
methods; the symbol <b><a 
href="symbols.html#x188-380011r11">*</a></b>, which matches all methods; a true list, which
matches methods with the same number of qualiﬁers as the length of the list
when each qualiﬁer matches the corresponding list element; or a dotted
list that ends in the symbol <b><a 
href="symbols.html#x188-380011r11">*</a></b> (the <b><a 
href="symbols.html#x188-380011r11">*</a></b> matches any number of additional
qualiﬁers).
<!--l. 3801--><p class="indent" >   Each applicable method is tested against the qualiﬁer patterns and predicates
                                                                          

                                                                          
in left-to-right order. As soon as a qualiﬁer pattern matches or a predicate returns
true, the method becomes a member of the corresponding method group and no
further tests are made. Thus if a method could be a member of more than one
method group, it joins only the ﬁrst such group. If a method group has more than
one qualiﬁer pattern, a method need only satisfy one of the qualiﬁer patterns to
be a member of the group.
<!--l. 3810--><p class="indent" >   The name of a predicate function can appear instead of qualiﬁer patterns in a
method group speciﬁer. The predicate is called for each method that
has not been assigned to an earlier method group; it is called with one
argument, the method&#x2019;s qualiﬁer list. The predicate should return true if
the method is to be a member of the method group. A predicate can be
distinguished from a qualiﬁer pattern because it is a symbol other than <b><a 
href="symbols.html#x188-380670r670">nil</a></b> or
<b><a 
href="symbols.html#x188-380011r11">*</a></b>.
<!--l. 3818--><p class="indent" >   If there is an applicable method whose qualiﬁers are not valid for
the method combination type, the function <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b> is
called.
<!--l. 3822--><p class="indent" >   Method group speciﬁers can have keyword options following the qualiﬁer
patterns or predicate. Keyword options can be distinguished from additional
qualiﬁer patterns because they are neither lists nor the symbol <b><a 
href="symbols.html#x188-380011r11">*</a></b>. The keyword
options are:
      <ul class="itemize1">
      <li class="itemize">The <b>:description</b> option is used to provide a description of the role
      of  methods  in  the  method  group.  Programming  environment  tools
      use <b>(apply #&#x2019;format stream <em>format-string</em> (method-qualiﬁers
      <em>method</em>))</b> to print this description, which is expected to be concise.
      This keyword option allows the description of a method qualiﬁer to be
      deﬁned in the same module that deﬁnes the meaning of the method
      qualiﬁer. In most cases, <em>format-string</em> will not contain any <b><a 
href="symbols.html#x188-380438r438">format</a></b>
      directives, but they are available for generality. If <b>:description</b> is not
      speciﬁed, a default description is generated based on the variable name
      and the qualiﬁer patterns and on whether this method group includes
      the unqualiﬁed methods. The argument <em>format-string</em> is not evaluated.
      </li>
      <li class="itemize">The  <b>:order</b>  option  speciﬁes  the  order  of  methods.  The  <em>order</em>
      argument  is  a  form  that  evaluates  to  <b>:most-speciﬁc-ﬁrst</b>  or
                                                                          

                                                                          
      <b>:most-speciﬁc-last</b>.  If  it  evaluates  to  any  other  value,  an  error
      is  signaled.  This  keyword  option  is  a  convenience  and  does  not
      add  any  expressive  power.  If  <b>:order</b> is  not  speciﬁed,  it  defaults  to
      <b>:most-speciﬁc-ﬁrst</b>.
      </li>
      <li class="itemize">The <b>:required</b> option speciﬁes whether at least one method in this
      method group is required. If the <em>boolean</em> argument is non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> and the
      method  group  is  empty  (that  is,  no  applicable  methods  match  the
      qualiﬁer patterns or satisfy the predicate), an error is signaled. This
      keyword option is a convenience and does not add any expressive power.
      If <b>:required</b> is not speciﬁed, it defaults to <b><a 
href="symbols.html#x188-380670r670">nil</a></b>. The <em>boolean</em> argument
      is not evaluated.</li></ul>
<!--l. 3863--><p class="indent" >   The use of method group speciﬁers provides a convenient syntax to select
methods, to divide them among the possible roles, and to perform the necessary
error checking. It is possible to perform further ﬁltering of methods in the
body forms by using normal list-processing operations and the functions
<b><a 
href="symbols.html#x188-380636r636">method-qualiﬁers</a></b> and <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b>. It is permissible to use <b><a 
href="symbols.html#x188-380846r846">setq</a></b> on
the variables named in the method group speciﬁers and to bind additional
variables. It is also possible to bypass the method group speciﬁer mechanism and
do everything in the body forms. This is accomplished by writing a single
method group with <b><a 
href="symbols.html#x188-380011r11">*</a></b> as its only qualiﬁer pattern; the variable is then
bound to a list of all of the applicable methods, in most-speciﬁc-ﬁrst
order.
<!--l. 3876--><p class="indent" >   The body <em>forms</em> compute and return the Lisp form that speciﬁes how the
methods are combined, that is, the eﬀective method. The eﬀective method uses
the macro <b><a 
href="symbols.html#x188-380189r189">call-method</a></b>. The deﬁnition of this macro has lexical scope and is
available only in an eﬀective method form. Given a method object in one of the
lists produced by the method group speciﬁers and a list of next methods, the
macro <b><a 
href="symbols.html#x188-380189r189">call-method</a></b> will invoke the method so that <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> will have
available the next methods.
<!--l. 3885--><p class="indent" >   When an eﬀective method has no eﬀect other than to call a single method,
some implementations employ an optimization that uses the single method
directly as the eﬀective method, thus avoiding the need to create a new
eﬀective method. This optimization is active when the eﬀective method
form consists entirely of an invocation of the <b><a 
href="symbols.html#x188-380189r189">call-method</a></b> macro whose
ﬁrst subform is a method object and whose second subform is <b><a 
href="symbols.html#x188-380670r670">nil</a></b>. Each
<b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b> body is responsible for stripping oﬀ redundant
                                                                          

                                                                          
invocations of <b><a 
href="symbols.html#x188-380762r762">progn</a></b>, <b><a 
href="symbols.html#x188-380098r98">and</a></b>, <b><a 
href="symbols.html#x188-380659r659">multiple-value-prog1</a></b>, and the like, if this
optimization is desired.
<!--l. 3896--><p class="indent" >   The list <b>(:arguments . <em>lambda-list</em>)</b> can appear before any declaration or
documentation string. This form is useful when the method combination type
performs some speciﬁc behavior as part of the combined method and that
behavior needs access to the arguments to the generic function. Each parameter
variable deﬁned by <em>lambda-list</em> is bound to a form that can be inserted into the
eﬀective method. When this form is evaluated during execution of the eﬀective
method, its value is the corresponding argument to the generic function. If
<em>lambda-list</em> is not congruent to the generic function&#x2019;s lambda-list, additional
ignored parameters are automatically inserted until it is congruent. Thus it is
permissible for <em>lambda-list</em> to receive fewer arguments than the number that the
generic function expects.
<!--l. 3910--><p class="indent" >   Erroneous conditions detected by the body should be reported with
<b><a 
href="symbols.html#x188-380632r632">method-combination-error</a></b> or <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b>; these functions add any
necessary contextual information to the error message and will signal the
appropriate error.
<!--l. 3916--><p class="indent" >   The body <em>forms</em> are evaluated inside the bindings created by the lambda-list
and method group speciﬁers. Declarations at the head of the body are positioned
directly inside bindings created by the lambda-list and outside the bindings
of the method group variables. Thus method group variables cannot be
declared.
<!--l. 3922--><p class="indent" >   Within the body <em>forms</em>, <em>generic-function-symbol</em> is bound to the generic
function object.
<!--l. 3925--><p class="indent" >   If a <em>doc-string</em> argument is present, it provides the documentation for the
method combination type.
<!--l. 3928--><p class="indent" >   The functions <b><a 
href="symbols.html#x188-380632r632">method-combination-error</a></b> and <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b> can
be called from the body <em>forms</em> or from functions called by the body <em>forms</em>. The
actions of these two functions can depend on implementation-dependent
dynamic variables automatically bound before the generic function
<b><a 
href="symbols.html#x188-380275r275">compute-eﬀective-method</a></b> is called.
<!--l. 3935--><p class="indent" >   Note that two methods with identical specializers, but with diﬀerent qualiﬁers,
are not ordered by the algorithm described in step 2 of the method selection and
combination process described in section <a 
href="clmse143.html#x175-27400027.1.7">27.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a>. Normally the two methods play
diﬀerent roles in the eﬀective method because they have diﬀerent qualiﬁers, and
no matter how they are ordered in the result of step 2 the eﬀective method is the
same. If the two methods play the same role and their order matters, an error
is signaled. This happens as part of the qualiﬁer pattern matching in
                                                                          

                                                                          
<b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>.
<!--l. 3947--><p class="indent" >   The value returned by the <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b> macro is the new
method combination object.
<!--l. 3950--><p class="indent" >   Most examples of the long form of <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b> also
illustrate the use of the related functions that are provided as part of the
declarative method combination facility.
<div class="lisp">
<tt>
<!--l. 3954--><p class="indent" >   <div class="tabbing">
;;; Examples of the short form of deﬁne-method-combination
   <br>                                                                                               <br>
(deﬁne-method-combination and :identity-with-one-argument t)<br>            <br>
(defmethod func and ((x class1) y)<br>                                     ...)<br>
<br>                      ;;; The equivalent of this example in the long form is:<br>
<br>                                          (deﬁne-method-combination and<br>
        (&#x0026;optional (order &#x2019;:most-speciﬁc-ﬁrst))<br>
        ((around (:around))<br>         (primary (and) :order order :required t))<br>
  (let ((form (if (rest primary)<br>                  ‘(and ,@(mapcar #&#x2019;(lambda (method)<br>
                                      ‘(call-method ,method ()))<br>
                                  primary))<br>
                  ‘(call-method ,(ﬁrst primary) ()))))<br>
    (if around<br>                               ‘(call-method ,(ﬁrst around)<br>
                      (,@(rest around)<br>                       (make-method form)))<br>
        form)))<br>                             <br>                                       <br>
;;; Examples of the long form of deﬁne-method-combination<br>                <br>
;;; The default method-combination technique<br>                             <br>
(deﬁne-method-combination standard ()<br>              ((around (:around))<br>
         (before (:before))<br>                      (primary () :required t)<br>
         (after (:after)))<br>                   (ﬂet ((call-methods (methods)<br>
           (mapcar #&#x2019;(lambda (method)<br>                       ‘(call-method ,method ()))<br>
                   methods)))<br>    (let ((form (if (or before after (rest primary))<br>
                    ‘(multiple-value-prog1<br>
                       (progn ,@(call-methods before)<br>
                              (call-method ,(ﬁrst primary)<br>
                                           ,(rest primary)))<br>
                                                                          

                                                                          
                       ,@(call-methods (reverse after)))<br>
                    ‘(call-method ,(ﬁrst primary) ()))))<br>
      (if around<br>                            ‘(call-method ,(ﬁrst around)<br>
                        (,@(rest around)<br>                         (make-method form)))<br>
          form))))<br>
<!--l. 4005--><p class="noindent" ></div>
</tt>
</div><div class="lisp">
<tt>
<!--l. 4008--><p class="indent" >   <div class="tabbing">
;;; A simple way to try several methods until one returns non-nil
   <br>                          <br>                          (deﬁne-method-combination or ()<br>
        ((methods (or)))<br>            ‘(or ,@(mapcar #&#x2019;(lambda (method)<br>
                     ‘(call-method ,method ()))<br>
                 methods)))<br>                                           <br>
;;; A more complete version of the preceding<br><br>(deﬁne-method-combination or<br>
        (&#x0026;optional (order &#x2019;:most-speciﬁc-ﬁrst))<br>
        ((around (:around))<br>                             (primary (or)))<br>
  ;; Process the order argument<br>     (case order<br>       (:most-speciﬁc-ﬁrst)<br>
    (:most-speciﬁc-last (setq primary (reverse primary)))<br>
    (otherwise (method-combination-error<br>                 &#x0022;~S is an invalid order.~@<br>
                  :most-speciﬁc-ﬁrst and :most-speciﬁc-last ~<br>
                    are the possible values.&#x0022;<br>
                                         order)))<br>
  ;; Must have a primary method<br>                          (unless primary<br>
    (method-combination-error &#x0022;A primary method is required.&#x0022;))<br>
  ;; Construct the form that calls the primary methods<br>
  (let ((form (if (rest primary)<br>                  ‘(or ,@(mapcar #&#x2019;(lambda (method)<br>
                                     ‘(call-method ,method ()))<br>
                                 primary))<br>
                  ‘(call-method ,(ﬁrst primary) ()))))<br>
    ;; Wrap the around methods around that form<br>
    (if around<br>                               ‘(call-method ,(ﬁrst around)<br>
                      (,@(rest around)<br>                       (make-method form)))<br>
        form)))<br>
                                                                          

                                                                          
<!--l. 4047--><p class="noindent" ></div>
</tt>
</div><div class="lisp">
<tt>
<!--l. 4050--><p class="indent" >   <div class="tabbing">
;;; The same thing, using the :order and :required keyword options
   <br>                                                       (deﬁne-method-combination or<br>
        (&#x0026;optional (order &#x2019;:most-speciﬁc-ﬁrst))<br>
        ((around (:around))<br>         (primary (or) :order order :required t))<br>
  (let ((form (if (rest primary)<br>                  ‘(or ,@(mapcar #&#x2019;(lambda (method)<br>
                                     ‘(call-method ,method ()))<br>
                                 primary))<br>
                  ‘(call-method ,(ﬁrst primary) ()))))<br>
    (if around<br>                               ‘(call-method ,(ﬁrst around)<br>
                      (,@(rest around)<br>                       (make-method form)))<br>
        form)))<br>                                                          <br>
;;; This short-form call is behaviorally identical to the preceding.<br>
(deﬁne-method-combination or :identity-with-one-argument t)<br>             <br>
;;; Order methods by positive integer qualiﬁers; note that :around<br>
;;; methods are disallowed here in order to keep the example small.<br>
<br>               (deﬁne-method-combination example-method-combination ()<br>
        ((methods positive-integer-qualiﬁer-p))<br>
  ‘(progn ,@(mapcar #&#x2019;(lambda (method)<br>                        ‘(call-method ,method ()))<br>
                    (stable-sort methods #&#x2019;&#x003C;<br>
                      :key #&#x2019;(lambda (method)<br>
                               (ﬁrst (method-qualiﬁers<br>
                                        method)))))))<br>
<br>                      (defun positive-integer-qualiﬁer-p (method-qualiﬁers)<br>
  (and (= (length method-qualiﬁers) 1)<br>       (typep (ﬁrst method-qualiﬁers) &#x2019;(integer 0 *))))<br>
<br>                                       ;;; Example of the use of :arguments<br>
(deﬁne-method-combination progn-with-lock ()<br>
        ((methods ()))<br>                              (:arguments object)<br>
  ‘(unwind-protect<br>                     (progn (lock (object-lock ,object))<br>
              ,@(mapcar #&#x2019;(lambda (method)<br>
                            ‘(call-method ,method ()))<br>
                                                                          

                                                                          
                        methods))<br>     (unlock (object-lock ,object))))<br>
<!--l. 4096--><p class="noindent" ></div>
</tt>
</div>
<!--l. 4099--><p class="indent" >   The <b>:method-combination</b> option of <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b> is used to specify that a
generic function should use a particular method combination type. The argument
to the <b>:method-combination</b> option is the name of a method combination
type.
<!--l. 4104--><p class="indent" >   See sections <a 
href="clmse143.html#x175-27400027.1.7">27.1.7<!--tex4ht:ref: Method-Selection-and-Combination-SECTION --></a> and <a 
href="clmse143.html#x175-27800027.1.7">27.1.7<!--tex4ht:ref: Built-in-Method-Combination-Types-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380189r189">call-method</a></b>, <b><a 
href="symbols.html#x188-380636r636">method-qualiﬁers</a></b>,
<b><a 
href="symbols.html#x188-380632r632">method-combination-error</a></b>, <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b>, and <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b>.
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 4114--><p class="indent" >   <div class="tabbing">
 <em>[Macro]</em> <b>defmethod</b> <a 
 id="dx176-302022"></a>function-name {method-qualiﬁer}*specialized-lambda-list[[{declaration}* | doc-string]] {form}*
   <br>
<!--l. 4117--><p class="noindent" ></div>
</div>
<!--l. 4118--><p class="indent" >   <div class="tabbing">
<em>function-name</em> ::=  {<i><em>symbol</em> | <b>(setf <em>symbol</em>)</b></i>}
   <br>                                                   <em>method-qualiﬁer</em> ::= <em>non-nil-atom</em><br>
<em>parameter-specializer-name</em> ::= <em>symbol</em> | <b>(eql <em>eql-specializer-form</em>)</b><br>
<!--l. 4122--><p class="noindent" ></div>The macro <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b> deﬁnes a method on a generic function.
<!--l. 4125--><p class="indent" >   If <b>(fboundp <em>function-name</em>)</b> is <b><a 
href="symbols.html#x188-380670r670">nil</a></b>, a generic function is created with
default values for the argument precedence order (each argument is more speciﬁc
than the arguments to its right in the argument list), for the generic function
class (the class <b>standard-generic-function</b>), for the method class (the
class <b>standard-method</b>), and for the method combination type (the
standard method combination type). The lambda-list of the generic function
is congruent with the lambda-list of the method being deﬁned; if the
<b><a 
href="symbols.html#x188-380321r321">defmethod</a></b> form mentions keyword arguments, the lambda-list of the generic
function will mention <b>&#x0026;key</b> (but no keyword arguments). If <em>function-name</em>
                                                                          

                                                                          
names a non-generic function, a macro, or a special operator, an error is
signaled.
<!--l. 4138--><p class="indent" >   If a generic function is currently named by <em>function-name</em>, where <em>function-name</em>
is a symbol or a list of the form <b>(setf <em>symbol</em>)</b>, the lambda-list of the method
must be congruent with the lambda-list of the generic function. If this condition
does not hold, an error is signaled. See section <a 
href="clmse143.html#x175-27200027.1.6">27.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a> for a deﬁnition of
congruence in this context.
<!--l. 4146--><p class="indent" >   The <em>function-name</em> argument is a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> symbol or a list of the form
<b>(setf <em>symbol</em>)</b>. It names the generic function on which the method is
deﬁned.
<!--l. 4150--><p class="indent" >   Each <em>method-qualiﬁer</em> argument is an object that is used by method
combination to identify the given method. A method qualiﬁer is a non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b> atom.
The method combination type may further restrict what a method qualiﬁer may
be. The standard method combination type allows for unqualiﬁed methods or
methods whose sole qualiﬁer is the keyword <b>:before</b>, the keyword <b>:after</b>, or the
keyword <b>:around</b>.
<!--l. 4158--><p class="indent" >   A <em>specialized-lambda-list</em> is like an ordinary function lambda-list except that
the name of a required parameter can be replaced by a specialized parameter, a
list of the form <b>(<em>variable-name parameter-specializer-name</em>)</b>. Only required
parameters may be specialized. A parameter specializer name is a symbol that
names a class or <b>(eql <em>eql-specializer-form</em>)</b>. The parameter specializer name
<b>(eql <em>eql-specializer-form</em>)</b> indicates that the corresponding argument must be
<b><a 
href="symbols.html#x188-380379r379">eql</a></b> to the object that is the value of <em>eql-specializer-form</em> for the method to be
applicable. If no parameter specializer name is speciﬁed for a given required
parameter, the parameter specializer defaults to the class named <b><a 
href="symbols.html#x188-380953r953">t</a></b>. See
section <a 
href="clmse143.html#x175-27000027.1.6">27.1.6<!--tex4ht:ref: Introduction-to-Methods-SECTION --></a>.
<!--l. 4172--><p class="indent" >   The <em>form</em> arguments specify the method body. The body of the method is
enclosed in an implicit block. If <em>function-name</em> is a symbol, this block bears the
same name as the generic function. If <em>function-name</em> is a list of the form <b>(setf
<em>symbol</em>)</b>, the name of the block is <em>symbol</em>.
<!--l. 4178--><p class="indent" >   The result of <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b> is the method object.
<!--l. 4180--><p class="indent" >   The class of the method object that is created is that given by the method
class option of the generic function on which the method is deﬁned.
<!--l. 4183--><p class="indent" >   If the generic function already has a method that agrees with the method
being deﬁned on parameter specializers and qualiﬁers, <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b> replaces the
existing method with the one now being deﬁned. See section <a 
href="clmse143.html#x175-27100027.1.6">27.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> for a
deﬁnition of agreement in this context.
<!--l. 4190--><p class="indent" >   The parameter specializers are derived from the parameter specializer names
                                                                          

                                                                          
as described in section <a 
href="clmse143.html#x175-27000027.1.6">27.1.6<!--tex4ht:ref: Introduction-to-Methods-SECTION --></a>.
<!--l. 4193--><p class="indent" >   The expansion of the <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b> macro refers to each specialized parameter
(see the <b>ignore</b> declaration speciﬁer), including parameters that have an explicit
parameter specializer name of <b><a 
href="symbols.html#x188-380953r953">t</a></b>. This means that a compiler warning does not
occur if the body of the method does not refer to a specialized parameter. Note
that a parameter that specializes on <b><a 
href="symbols.html#x188-380953r953">t</a></b> is not synonymous with an unspecialized
parameter in this context.
<!--l. 4202--><p class="indent" >   See sections <a 
href="clmse143.html#x175-27000027.1.6">27.1.6<!--tex4ht:ref: Introduction-to-Methods-SECTION --></a>, <a 
href="clmse143.html#x175-27200027.1.6">27.1.6<!--tex4ht:ref: Congruent-Lambda-Lists-for-All-Methods-of-a-Generic-Function-SECTION --></a>, and <a 
href="clmse143.html#x175-27100027.1.6">27.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a>.
<hr></div>
<!--l. 4208--><p class="indent" >   [At this point the original CLOS report <span class="cite">[<a 
href="bib.html#XSIGPLAN-CLOS">5</a>, <a 
href="bib.html#XLASC-CLOS-PART-2">7</a>]</span> contained a speciﬁcation for
<b><a 
href="symbols.html#x188-380337r337">describe</a></b> as a generic function. This speciﬁcation is omitted here because X3J13
voted in March 1989 <a 
 id="dx176-302023"></a>not to make <b><a 
href="symbols.html#x188-380337r337">describe</a></b> a generic function after all (see
<b><a 
href="symbols.html#x188-380338r338">describe-object</a></b>).—GLS]
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302024"></a>
<em>
<!--l. 4215--><p class="noindent" >[Generic function]</em> <b>documentation</b> <i>x</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302025"></a>
<em>
[Primary method]</em> <b>documentation</b> (<i>method</i> standard-method) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt>
<i>doc-type</i><br />
<a 
 id="dx176-302026"></a>
<em>
[Primary method]</em> <b>documentation</b> (<i>generic-function</i> standard-generic-function)
<tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302027"></a>
<em>
[Primary method]</em> <b>documentation</b> (<i>class</i> standard-class) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt>
<i>doc-type</i><br />
<a 
 id="dx176-302028"></a>
<em>
[Primary method]</em> <b>documentation</b> (<i>method-combination</i> method-combination)
<tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302029"></a>
<em>
                                                                          

                                                                          
[Primary method]</em> <b>documentation</b> (<i>slot-description</i> standard-slot-description)
<tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302030"></a>
<em>
[Primary method]</em> <b>documentation</b> (<i>symbol</i> symbol) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302031"></a>
<em>
[Primary method]</em> <b>documentation</b> (<i>list</i> list) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i>
</div>
<!--l. 4224--><p class="indent" >   The ordinary function <b><a 
href="symbols.html#x188-380352r352">documentation</a></b> (see section ??) is replaced by
a generic function. The generic function <b><a 
href="symbols.html#x188-380352r352">documentation</a></b> returns the
documentation string associated with the given object if it is available; otherwise
<b><a 
href="symbols.html#x188-380352r352">documentation</a></b> returns <b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
<!--l. 4230--><p class="indent" >   The ﬁrst argument of <b><a 
href="symbols.html#x188-380352r352">documentation</a></b> is a symbol, a function-name list of the
form <b>(setf <em>symbol</em>)</b>, a method object, a class object, a generic function
object, a method combination object, or a slot description object. Whether
a second argument should be supplied depends on the type of the ﬁrst
argument.
      <ul class="itemize1">
      <li class="itemize">If  the  ﬁrst  argument  is  a  method  object,  a  class  object,  a  generic
      function object, a method combination object, or a slot description
      object,  the  second  argument  must  not  be  supplied,  or  an  error  is
      signaled.
      </li>
      <li class="itemize">If the ﬁrst argument is a symbol or a list of the form <b>(setf <em>symbol</em>)</b>,
      the second argument must be supplied.
           <ul class="itemize2">
           <li class="itemize">The forms <div class="lisp"><tt><div class="tabbing">
           (documentation <em>symbol</em> &#x2019;function)
           <br>
                                                                          

                                                                          
           <!--l. 4254--><p class="noindent" ></div>
</tt>
</div>
           <!--l. 4255--><p class="noindent" >and <div class="lisp"><tt><div class="tabbing">
           (documentation &#x2019;(setf <em>symbol</em>) &#x2019;function)
           <br>
           <!--l. 4258--><p class="noindent" ></div>
</tt>
</div>
           <!--l. 4259--><p class="noindent" >return the documentation string of the function, generic function,
           special operator, or macro named by the symbol or list.
           </li>
           <li class="itemize">The form <b>(documentation <em>symbol</em> &#x2019;variable)</b> returns the
           documentation string of the special variable or constant named by the
           symbol.
           </li>
           <li class="itemize">The form <b>(documentation <em>symbol</em> &#x2019;structure)</b> returns the
           documentation string of the <b><a 
href="symbols.html#x188-380325r325">defstruct</a></b> structure named by the
           symbol.
           </li>
           <li class="itemize">The form <b>(documentation <em>symbol</em> &#x2019;type)</b> returns the documentation
           string of the class object named by the symbol, if there is such a class.
           If there is no such class, it returns the documentation string of the type
           speciﬁer named by the symbol.
           </li>
           <li class="itemize">The form <b>(documentation <em>symbol</em> &#x2019;setf)</b> returns the documentation
           string of the <b><a 
href="symbols.html#x188-380324r324">defsetf</a></b> or <b><a 
href="symbols.html#x188-380318r318">deﬁne-setf-method</a></b> deﬁnition associated with
           the symbol.
           </li>
           <li class="itemize">The form <b>(documentation <em>symbol</em> &#x2019;method-combination)</b> returns
           the documentation string of the method combination type named by
           the symbol.</li></ul>
                                                                          

                                                                          
      </li></ul>
<!--l. 4292--><p class="indent" >   An implementation may extend the set of symbols that are acceptable as the
second argument. If a symbol is not recognized as an acceptable argument by the
implementation, an error must be signaled.
<!--l. 4296--><p class="indent" >   The documentation string associated with the given object is returned unless
none is available, in which case <b><a 
href="symbols.html#x188-380352r352">documentation</a></b> returns <b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302032"></a>
<em>
<!--l. 4303--><p class="noindent" >[Generic function]</em> <b>(setf documentation)</b>  <i>new-value</i> <i>x</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt>
<i>doc-type</i><br />
<a 
 id="dx176-302033"></a>
<em>
[Primary method]</em> <b>(setf documentation)</b>  <i>new-value</i> (<i>method</i> standard-method)
<tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302034"></a>
<em>
[Primary method]</em> <b>(setf documentation)</b>  <i>new-value</i>
(<i>generic-function</i> standard-generic-function) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302035"></a>
<em>
[Primary method]</em> <b>(setf documentation)</b>  <i>new-value</i> (<i>class</i> standard-class)
<tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302036"></a>
<em>
[Primary method]</em> <b>(setf documentation)</b>  <i>new-value</i>
(<i>method-combination</i> method-combination) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302037"></a>
<em>
[Primary method]</em> <b>(setf documentation)</b>  <i>new-value</i>
(<i>slot-description</i> standard-slot-description) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302038"></a>
<em>
[Primary method]</em> <b>(setf documentation)</b>  <i>new-value</i> (<i>symbol</i> symbol)
                                                                          

                                                                          
<tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>doc-type</i><br />
<a 
 id="dx176-302039"></a>
<em>
[Primary method]</em> <b>(setf documentation)</b>  <i>new-value</i> (<i>list</i> list) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt>
<i>doc-type</i>
</div>
<!--l. 4312--><p class="indent" >   The generic function <b>(setf documentation)</b> is used to update the
documentation.
<!--l. 4315--><p class="indent" >   The ﬁrst argument of <b>(setf documentation)</b> is the new documentation.
<!--l. 4317--><p class="indent" >   The second argument of <b><a 
href="symbols.html#x188-380352r352">documentation</a></b> is a symbol, a function-name list of
the form <b>(setf <em>symbol</em>)</b>, a method object, a class object, a generic function
object, a method combination object, or a slot description object. Whether a
third argument should be supplied depends on the type of the second argument.
See <b><a 
href="symbols.html#x188-380352r352">documentation</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302040"></a>
<em>
<!--l. 4328--><p class="noindent" >[Function]</em> <b>ensure-generic-function</b> <i>function-name</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;key</a></tt> <i>:lambda-list</i>
<i>:argument-precedence-order</i> <i>:declare</i> <i>:documentation</i> <i>:generic-function-class</i>
<i>:method-combination</i> <i>:method-class</i> <i>:environment</i>
</div>
<!--l. 4337--><p class="indent" >   <div class="tabbing">
<em>function-name</em> ::=  {<i><em>symbol</em> | <b>(setf <em>symbol</em>)</b></i>}
   <br>
<!--l. 4339--><p class="noindent" ></div>The function <b><a 
href="symbols.html#x188-380376r376">ensure-generic-function</a></b> is used to deﬁne a globally named generic
function with no methods or to specify or modify options and declarations that
pertain to a globally named generic function as a whole.
<!--l. 4345--><p class="indent" >   If <b>(fboundp <em>function-name</em>)</b> is <b><a 
href="symbols.html#x188-380670r670">nil</a></b>, a new generic function is created. If
<b>(fdeﬁnition <em>function-name</em>)</b> is a non-generic function, a macro, or a special
operator, an error is signaled.
                                                                          

                                                                          
<!--l. 4350--><p class="indent" >   [X3J13 voted in March 1989 <a 
 id="dx176-302041"></a>to use <b><a 
href="symbols.html#x188-380398r398">fdeﬁnition</a></b> in the previous paragraph, as
shown, rather than <b><a 
href="symbols.html#x188-380945r945">symbol-function</a></b>, as it appeared in the original report on
CLOS <span class="cite">[<a 
href="bib.html#XSIGPLAN-CLOS">5</a>, <a 
href="bib.html#XLASC-CLOS-PART-2">7</a>]</span>. The vote also changed all occurrences of <em>function-speciﬁer</em> in the
original report to <em>function-name</em>; this change is reﬂected here.—GLS]
<!--l. 4356--><p class="indent" >   If <em>function-name</em> speciﬁes a generic function that has a diﬀerent value for any
of the following arguments, the generic function is modiﬁed to have the
new value: <b>:argument-precedence-order</b>, <b>:declare</b>, <b>:documentation</b>,
<b>:method-combination</b>.
<!--l. 4362--><p class="indent" >   If <em>function-name</em> speciﬁes a generic function that has a diﬀerent value for the
<b>:lambda-list</b> argument, and the new value is congruent with the lambda-lists of
all existing methods or there are no methods, the value is changed; otherwise an
error is signaled.
<!--l. 4367--><p class="indent" >   If <em>function-name</em> speciﬁes a generic function that has a diﬀerent value for the
<b>:generic-function-class</b> argument and if the new generic function class is
compatible with the old, <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> is called to change the class of the generic
function; otherwise an error is signaled.
<!--l. 4373--><p class="indent" >   If <em>function-name</em> speciﬁes a generic function that has a diﬀerent
<b>:method-class</b> value, the value is changed but any existing methods are not
changed.
<!--l. 4377--><p class="indent" >   The <em>function-name</em> argument is a symbol or a list of the form <b>(setf
<em>symbol</em>)</b>.
<!--l. 4380--><p class="indent" >   The keyword arguments correspond to the <em>option</em> arguments of <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b>,
except that the <b>:method-class</b> and <b>:generic-function-class</b> arguments can be
class objects as well as names.
<!--l. 4385--><p class="indent" >   The <b>:environment</b> argument is the same as the <b>&#x0026;environment</b> argument to
macro expansion functions. It is typically used to distinguish between
compile-time and run-time environments.
<!--l. 4389--><p class="indent" >   The <b>:method-combination</b> argument is a method combination object.
<!--l. 4391--><p class="indent" >   The generic function object is returned.
<!--l. 4393--><p class="indent" >   See <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302042"></a>
<em>
<!--l. 4397--><p class="noindent" >[Function]</em> <b>ﬁnd-class</b> <i>symbol</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>errorp</i> <i>environment</i>
                                                                          

                                                                          
</div>
<!--l. 4399--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380415r415">ﬁnd-class</a></b> returns the class object named by the given symbol in
the given environment.
<!--l. 4402--><p class="indent" >   The ﬁrst argument to <b><a 
href="symbols.html#x188-380415r415">ﬁnd-class</a></b> is a symbol.
<!--l. 4404--><p class="indent" >   If there is no such class and the <em>errorp</em> argument is not supplied or is
non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b>, <b><a 
href="symbols.html#x188-380415r415">ﬁnd-class</a></b> signals an error. If there is no such class and the <em>errorp</em>
argument is <b><a 
href="symbols.html#x188-380670r670">nil</a></b>, <b><a 
href="symbols.html#x188-380415r415">ﬁnd-class</a></b> returns <b><a 
href="symbols.html#x188-380670r670">nil</a></b>. The default value of <em>errorp</em> is
<b><a 
href="symbols.html#x188-380953r953">t</a></b>.
<!--l. 4410--><p class="indent" >   The optional <em>environment</em> argument is the same as the <b>&#x0026;environment</b>
argument to macro expansion functions. It is typically used to distinguish between
compile-time and run-time environments.
<!--l. 4414--><p class="indent" >   The result of <b><a 
href="symbols.html#x188-380415r415">ﬁnd-class</a></b> is the class object named by the given symbol.
<!--l. 4416--><p class="indent" >   The class associated with a particular symbol can be changed by using <b><a 
href="symbols.html#x188-380845r845">setf</a></b>
with <b><a 
href="symbols.html#x188-380415r415">ﬁnd-class</a></b>. The results are undeﬁned if the user attempts to change the class
associated with a symbol that is deﬁned as a type speciﬁer in chapter <a 
href="dtspec.html#x26-420004">4<!--tex4ht:ref: DTSPEC --></a>. See
section <a 
href="clmse143.html#x175-26400027.1.4">27.1.4<!--tex4ht:ref: Integrating-Types-and-Classes-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302043"></a>
<em>
<!--l. 4425--><p class="noindent" >[Generic function]</em> <b>ﬁnd-method</b> <i>generic-function</i> <i>method-qualiﬁers</i> <i>specializers</i>
<tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>errorp</i><br />
<a 
 id="dx176-302044"></a>
<em>
[Primary method]</em> <b>ﬁnd-method</b> (<i>generic-function</i> standard-generic-function)
<i>method-qualiﬁers</i> <i>specializers</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt> <i>errorp</i>
</div>
<!--l. 4429--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380418r418">ﬁnd-method</a></b> takes a generic function and returns the
method object that agrees on method qualiﬁers and parameter specializers with
the <em>method-qualiﬁers</em> and <em>specializers</em> arguments of <b><a 
href="symbols.html#x188-380418r418">ﬁnd-method</a></b>. See
section <a 
href="clmse143.html#x175-27100027.1.6">27.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a> for a deﬁnition of agreement in this context.
<!--l. 4436--><p class="indent" >   The <em>generic-function</em> argument is a generic function.
<!--l. 4438--><p class="indent" >   The <em>method-qualiﬁers</em> argument is a list of the method qualiﬁers for the
method. The order of the method qualiﬁers is signiﬁcant.
                                                                          

                                                                          
<!--l. 4442--><p class="indent" >   The <em>specializers</em> argument is a list of the parameter specializers for the
method. It must correspond in length to the number of required arguments of the
generic function, or an error is signaled. This means that to obtain the default
method on a given generic function, a list whose elements are the class named <b><a 
href="symbols.html#x188-380953r953">t</a></b>
must be given.
<!--l. 4449--><p class="indent" >   If there is no such method and the <em>errorp</em> argument is not supplied or is
non-<b><a 
href="symbols.html#x188-380670r670">nil</a></b>, <b><a 
href="symbols.html#x188-380418r418">ﬁnd-method</a></b> signals an error. If there is no such method and the <em>errorp</em>
argument is <b><a 
href="symbols.html#x188-380670r670">nil</a></b>, <b><a 
href="symbols.html#x188-380418r418">ﬁnd-method</a></b> returns <b><a 
href="symbols.html#x188-380670r670">nil</a></b>. The default value of <em>errorp</em> is
<b><a 
href="symbols.html#x188-380953r953">t</a></b>.
<!--l. 4455--><p class="indent" >   The result of <b><a 
href="symbols.html#x188-380418r418">ﬁnd-method</a></b> is the method object with the given method
qualiﬁers and parameter specializers.
<!--l. 4458--><p class="indent" >   See section <a 
href="clmse143.html#x175-27100027.1.6">27.1.6<!--tex4ht:ref: Agreement-on-Parameter-Specializers-and-Qualifiers-SECTION --></a>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302045"></a>
<em>
<!--l. 4463--><p class="noindent" >[Generic function]</em> <b>function-keywords</b> <i>method</i><br />
<a 
 id="dx176-302046"></a>
<em>
[Primary method]</em> <b>function-keywords</b> (<i>method</i> standard-method)
</div>
<!--l. 4466--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380448r448">function-keywords</a></b> is used to return the keyword
parameter speciﬁers for a given method.
<!--l. 4469--><p class="indent" >   The <em>method</em> argument is a method object.
<!--l. 4471--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380448r448">function-keywords</a></b> returns two values: a list of the
explicitly named keywords and a boolean that states whether <b>&#x0026;allow-other-keys</b>
had been speciﬁed in the method deﬁnition.
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 4533--><p class="indent" >   <div class="tabbing">
 <em>[Macro]</em> <b>generic-function</b> <a 
 id="dx176-302047"></a>lambda-list [[<span class="math"> ↓</span>option | {method-description}*]]
   <br>
                                                                          

                                                                          
<!--l. 4534--><p class="noindent" ></div>
</div>
<!--l. 4535--><p class="indent" >   <div class="tabbing">
<em>option</em> ::= <b>(:argument-precedence-order  {<i>parameter-name</i>}+ )</b>
   <br>      | <b>(declare  {<i>declaration</i>}+ )</b><br>      | <b>(:documentation <em>string</em>)</b><br>
    | <b>(:method-combination <em>symbol</em> {<i>arg</i>}* )</b><br>
    | <b>(:generic-function-class <em>class-name</em>)</b><br>
    | <b>(:method-class <em>class-name</em>)</b><br>                                      <br>
<em>method-description</em> ::= <b>(:method </b> {<i>method-qualiﬁer</i>}*  <em>specialized-lambda-list</em> {<i>declaration | documentation</i>}*  {<i>form</i>}* <b>)</b><br>
<!--l. 4546--><p class="noindent" ></div>The <b><a 
href="symbols.html#x188-380452r452">generic-function</a></b> macro creates an anonymous generic function. The
generic function is created with the set of methods speciﬁed by its method
descriptions.
<!--l. 4551--><p class="indent" >   The <em>option</em>, <em>method-qualiﬁer</em>, and <em>specialized-lambda-list</em> arguments are the
same as for <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b>.
<!--l. 4554--><p class="indent" >   The generic function object is returned as the result.
<!--l. 4556--><p class="indent" >   If no method descriptions are speciﬁed, an anonymous generic function with
no methods is created.
<!--l. 4559--><p class="indent" >   See <b><a 
href="symbols.html#x188-380312r312">defgeneric</a></b>, and <b><a 
href="symbols.html#x188-380321r321">defmethod</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302048"></a>
<em>
<!--l. 4621--><p class="noindent" >[Generic function]</em> <b>initialize-instance</b> <i>instance</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i><br />
<a 
 id="dx176-302049"></a>
<em>
[Primary method]</em> <b>initialize-instance</b> (<i>instance</i> standard-object) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt>
<i>initargs</i>
</div>
<!--l. 4624--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b> is called by <b><a 
href="symbols.html#x188-380595r595">make-instance</a></b> to
initialize a newly created instance. The generic function <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b> is
called with the new instance and the defaulted initialization arguments.
                                                                          

                                                                          
<!--l. 4629--><p class="indent" >   The system-supplied primary method on <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b> initializes the
slots of the instance with values according to the initialization arguments and the
<b>:initform</b> forms of the slots. It does this by calling the generic function
<b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> with the following arguments: the instance, <b><a 
href="symbols.html#x188-380953r953">t</a></b> (this indicates
that all slots for which no initialization arguments are provided should be
initialized according to their <b>:initform</b> forms) and the defaulted initialization
arguments.
<!--l. 4638--><p class="indent" >   The <em>instance</em> argument is the object to be initialized.
<!--l. 4640--><p class="indent" >   The <em>initargs</em> argument consists of alternating initialization argument names
and values.
<!--l. 4643--><p class="indent" >   The modiﬁed instance is returned as the result.
<!--l. 4645--><p class="indent" >   Programmers can deﬁne methods for <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b> to specify actions
to be taken when an instance is initialized. If only <b>:after</b> methods are
deﬁned, they will be run after the system-supplied primary method for
initialization and therefore will not interfere with the default behavior of
<b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b>.
<!--l. 4651--><p class="indent" >   See sections <a 
href="clmse143.html#x175-28300027.1.9">27.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>, <a 
href="clmse143.html#x175-28700027.1.9">27.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, and <a 
href="clmse143.html#x175-28500027.1.9">27.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b>,
<b><a 
href="symbols.html#x188-380595r595">make-instance</a></b>, <b><a 
href="symbols.html#x188-380872r872">slot-boundp</a></b>, and <b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302050"></a>
<em>
<!--l. 4661--><p class="noindent" >[Function]</em> <b>invalid-method-error</b> <i>method</i> <i>format-string</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>args</i>
</div>
<!--l. 4663--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b> is used to signal an error when there is
an applicable method whose qualiﬁers are not valid for the method combination
type. The error message is constructed by using a <b><a 
href="symbols.html#x188-380438r438">format</a></b> string and any
arguments to it. Because an implementation may need to add additional
contextual information to the error message, <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b>
should be called only within the dynamic extent of a method combination
function.
<!--l. 4671--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b> is called automatically when
a method fails to satisfy every qualiﬁer pattern and predicate in a
<b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b> form. A method combination function that
imposes additional restrictions should call <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b> explicitly if it
                                                                          

                                                                          
encounters a method it cannot accept.
<!--l. 4679--><p class="indent" >   The <em>method</em> argument is the invalid method object.
<!--l. 4681--><p class="indent" >   The <em>format-string</em> argument is a control string that can be given to <b><a 
href="symbols.html#x188-380438r438">format</a></b>,
and <em>args</em> are any arguments required by that string.
<!--l. 4685--><p class="indent" >   Whether <b><a 
href="symbols.html#x188-380508r508">invalid-method-error</a></b> returns to its caller or exits via <b><a 
href="symbols.html#x188-380963r963">throw</a></b> is
implementation-dependent.
<!--l. 4688--><p class="indent" >   See <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302051"></a>
<em>
<!--l. 4692--><p class="noindent" >[Generic function]</em> <b>make-instance</b> <i>class</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i><br />
<a 
 id="dx176-302052"></a>
<em>
[Primary method]</em> <b>make-instance</b> (<i>class</i> standard-class) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i><br />
<a 
 id="dx176-302053"></a>
<em>
[Primary method]</em> <b>make-instance</b> (<i>class</i> symbol) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i>
</div>
<!--l. 4696--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380595r595">make-instance</a></b> creates a new instance of the given
class.
<!--l. 4699--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380595r595">make-instance</a></b> may be used as described in
section <a 
href="clmse143.html#x175-28300027.1.9">27.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>.
<!--l. 4702--><p class="indent" >   The <em>class</em> argument is a class object or a symbol that names a class. The
remaining arguments form a list of alternating initialization argument names and
values.
<!--l. 4706--><p class="indent" >   If the second of the preceding methods is selected, that method invokes
<b><a 
href="symbols.html#x188-380595r595">make-instance</a></b> on the arguments <b>(ﬁnd-class <em>class</em>)</b> and <em>initargs</em>.
<!--l. 4710--><p class="indent" >   The initialization arguments are checked within <b><a 
href="symbols.html#x188-380595r595">make-instance</a></b> (see
section <a 
href="clmse143.html#x175-28300027.1.9">27.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>).
<!--l. 4713--><p class="indent" >   The new instance is returned.
<!--l. 4715--><p class="indent" >   The meta-object protocol can be used to deﬁne new methods on <b><a 
href="symbols.html#x188-380595r595">make-instance</a></b>
to replace the object-creation protocol.
<!--l. 4718--><p class="indent" >   See section <a 
href="clmse143.html#x175-28300027.1.9">27.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380310r310">defclass</a></b>, <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b>, and <b><a 
href="symbols.html#x188-380245r245">class-of</a></b>.
<hr></div>
                                                                          

                                                                          
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302054"></a>
<em>
<!--l. 4723--><p class="noindent" >[Generic function]</em> <b>make-instances-obsolete</b> <i>class</i><br />
<a 
 id="dx176-302055"></a>
<em>
[Primary method]</em> <b>make-instances-obsolete</b> (<i>class</i> standard-class)<br />
<a 
 id="dx176-302056"></a>
<em>
[Primary method]</em> <b>make-instances-obsolete</b> (<i>class</i> symbol)
</div>
<!--l. 4727--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380596r596">make-instances-obsolete</a></b> is invoked automatically by
the system when <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> has been used to redeﬁne an existing standard class
and the set of local slots accessible in an instance is changed or the order
of slots in storage is changed. It can also be explicitly invoked by the
user.
<!--l. 4733--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380596r596">make-instances-obsolete</a></b> has the eﬀect of initiating the
process of updating the instances of the class. During updating, the generic
function <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b> will be invoked.
<!--l. 4738--><p class="indent" >   The <em>class</em> argument is a class object or symbol that names the class whose
instances are to be made obsolete.
<!--l. 4741--><p class="indent" >   If the second of the preceding methods is selected, that method invokes
<b><a 
href="symbols.html#x188-380596r596">make-instances-obsolete</a></b> on <b>(ﬁnd-class <em>class</em>)</b>.
<!--l. 4744--><p class="indent" >   The modiﬁed class is returned. The result of <b><a 
href="symbols.html#x188-380596r596">make-instances-obsolete</a></b> is <b><a 
href="symbols.html#x188-380378r378">eq</a></b>
to the <em>class</em> argument supplied to the ﬁrst of the preceding methods.
<!--l. 4748--><p class="indent" >   See section <a 
href="clmse143.html#x175-29100027.1.10">27.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302057"></a>
<em>
<!--l. 4753--><p class="noindent" >[Function]</em> <b>method-combination-error</b> <i>format-string</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>args</i>
</div>
<!--l. 4755--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380632r632">method-combination-error</a></b> is used to signal an error in
                                                                          

                                                                          
method combination. The error message is constructed by using a <b><a 
href="symbols.html#x188-380438r438">format</a></b> string
and any arguments to it. Because an implementation may need to add additional
contextual information to the error message, <b><a 
href="symbols.html#x188-380632r632">method-combination-error</a></b>
should be called only within the dynamic extent of a method combination
function.
<!--l. 4762--><p class="indent" >   The <em>format-string</em> argument is a control string that can be given to <b><a 
href="symbols.html#x188-380438r438">format</a></b>,
and <em>args</em> are any arguments required by that string.
<!--l. 4766--><p class="indent" >   Whether <b><a 
href="symbols.html#x188-380632r632">method-combination-error</a></b> returns to its caller or exits via <b><a 
href="symbols.html#x188-380963r963">throw</a></b>
is implementation-dependent.
<!--l. 4769--><p class="indent" >   See <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302058"></a>
<em>
<!--l. 4773--><p class="noindent" >[Generic function]</em> <b>method-qualiﬁers</b> <i>method</i><br />
<a 
 id="dx176-302059"></a>
<em>
[Primary method]</em> <b>method-qualiﬁers</b> (<i>method</i> standard-method)
</div>
<!--l. 4776--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380636r636">method-qualiﬁers</a></b> returns a list of the qualiﬁers of the
given method.
<!--l. 4779--><p class="indent" >   The <em>method</em> argument is a method object.
<!--l. 4781--><p class="indent" >   A list of the qualiﬁers of the given method is returned.
<!--l. 4783--><p class="indent" >   Example: <div class="lisp"><tt><div class="tabbing">
(setq methods (remove-duplicates methods
   <br>                                                             :from-end t<br>
                                 :key #&#x2019;method-qualiﬁers<br>
                                 :test #&#x2019;equal))<br>
<!--l. 4789--><p class="noindent" ></div>
</tt>
</div>
                                                                          

                                                                          
<!--l. 4791--><p class="indent" >   See <b><a 
href="symbols.html#x188-380316r316">deﬁne-method-combination</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302060"></a>
<em>
<!--l. 4795--><p class="noindent" >[Function]</em> <b>next-method-p</b>
</div>
<!--l. 4797--><p class="indent" >   The locally deﬁned function <b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b> can be used within the body of
a method deﬁned by a method-deﬁning form to determine whether a next method
exists.
<!--l. 4801--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b> takes no arguments.
<!--l. 4803--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b> returns true or false.
<!--l. 4805--><p class="indent" >   Like <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>, the function <b><a 
href="symbols.html#x188-380669r669">next-method-p</a></b> has lexical scope (for
it is deﬁned only within the body of a method deﬁned by a method-deﬁning form)
and indeﬁnite extent.
<!--l. 4810--><p class="indent" >   See <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302061"></a>
<em>
<!--l. 4814--><p class="noindent" >[Generic function]</em> <b>no-applicable-method</b> <i>generic-function</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt>
<i>function-arguments</i><br />
<a 
 id="dx176-302062"></a>
<em>
[Primary method]</em> <b>no-applicable-method</b> (<i>generic-function</i> t) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt>
<i>function-arguments</i>
</div>
<!--l. 4817--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380673r673">no-applicable-method</a></b> is called when a generic
function of the class <b>standard-generic-function</b> is invoked and no method
on that generic function is applicable. The default method signals an
error.
<!--l. 4822--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380673r673">no-applicable-method</a></b> is not intended to be called by
programmers. Programmers may write methods for it.
                                                                          

                                                                          
<!--l. 4825--><p class="indent" >   The <em>generic-function</em> argument of <b><a 
href="symbols.html#x188-380673r673">no-applicable-method</a></b> is the generic
function object on which no applicable method was found.
<!--l. 4828--><p class="indent" >   The <em>function-arguments</em> argument is a list of the arguments to that generic
function.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302063"></a>
<em>
<!--l. 4833--><p class="noindent" >[Generic function]</em> <b>no-next-method</b> <i>generic-function</i> <i>method</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt>
<i>args</i><br />
<a 
 id="dx176-302064"></a>
<em>
[Primary method]</em> <b>no-next-method</b> (<i>generic-function</i> standard-generic-function)
(<i>method</i> standard-method) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>args</i>
</div>
<!--l. 4837--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380674r674">no-next-method</a></b> is called by <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b> when
there is no next method. The system-supplied method on <b><a 
href="symbols.html#x188-380674r674">no-next-method</a></b>
signals an error.
<!--l. 4841--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380674r674">no-next-method</a></b> is not intended to be called by
programmers. Programmers may write methods for it.
<!--l. 4844--><p class="indent" >   The <em>generic-function</em> argument is the generic function object to which the
method that is the second argument belongs.
<!--l. 4847--><p class="indent" >   The <em>method</em> argument is the method that contains the call to <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>
for which there is no next method.
<!--l. 4850--><p class="indent" >   The <em>args</em> argument is a list of the arguments to <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>.
<!--l. 4853--><p class="indent" >   See <b><a 
href="symbols.html#x188-380190r190">call-next-method</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302065"></a>
<em>
<!--l. 4858--><p class="noindent" >[Generic function]</em> <b>print-object</b> <i>object</i> <i>stream</i><br />
<a 
 id="dx176-302066"></a>
<em>
                                                                          

                                                                          
[Primary method]</em> <b>print-object</b> (<i>object</i> standard-object) <i>stream</i>
</div>
<!--l. 4861--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> writes the printed representation of an
object to a stream. The function <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> is called by the print system; it
should not be called by the user.
<!--l. 4866--><p class="indent" >   Each implementation must provide a method on the class <b>standard-object</b>
and methods on enough other classes so as to ensure that there is always an
applicable method. Implementations are free to add methods for other classes.
Users can write methods for <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> for their own classes if they do not
wish to inherit an implementation-supplied method.
<!--l. 4873--><p class="indent" >   The ﬁrst argument is any Lisp object. The second argument is a stream; it
cannot be <b><a 
href="symbols.html#x188-380953r953">t</a></b> or <b><a 
href="symbols.html#x188-380670r670">nil</a></b>.
<!--l. 4876--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> returns its ﬁrst argument, the object.
<!--l. 4878--><p class="indent" >   Methods on <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> must obey the print control special variables named
<b>*print-<em>xxx</em>*</b> for various <em>xxx</em>. The speciﬁc details are the following:
      <ul class="itemize1">
      <li class="itemize">Each method must implement <b><a 
href="symbols.html#x188-380037r37">*print-escape*</a></b>.
      </li>
      <li class="itemize">The <b><a 
href="symbols.html#x188-380044r44">*print-pretty*</a></b> control variable can be ignored by most methods
      other than the one for lists.
      </li>
      <li class="itemize">The <b><a 
href="symbols.html#x188-380036r36">*print-circle*</a></b> control variable is handled by the printer and can
      be ignored by methods.
      </li>
      <li class="itemize">The printer takes care of <b><a 
href="symbols.html#x188-380040r40">*print-level*</a></b> automatically, provided that
      each method handles exactly one level of structure and calls <b><a 
href="symbols.html#x188-381027r1027">write</a></b>
      (or  an  equivalent  function)  recursively  if  there  are  more  structural
      levels. The printer&#x2019;s decision of whether an object has components (and
      therefore should not be printed when the printing depth is not less than
      <b><a 
href="symbols.html#x188-380040r40">*print-level*</a></b>) is implementation-dependent. In some implementations
      its <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> method is not called; in others the method is called,
      and the determination that the object has components is based on what
      it tries to write to the stream.
                                                                          

                                                                          
      </li>
      <li class="itemize">Methods   that   produce   output   of   indeﬁnite   length   must   obey
      <b><a 
href="symbols.html#x188-380039r39">*print-length*</a></b>, but most methods other than the one for lists can
      ignore it.
      </li>
      <li class="itemize">The <b><a 
href="symbols.html#x188-380034r34">*print-base*</a></b>, <b><a 
href="symbols.html#x188-380045r45">*print-radix*</a></b>, <b><a 
href="symbols.html#x188-380035r35">*print-case*</a></b>, <b><a 
href="symbols.html#x188-380038r38">*print-gensym*</a></b>,
      and <b><a 
href="symbols.html#x188-380033r33">*print-array*</a></b> control variables apply to speciﬁc types of objects
      and are handled by the methods for those objects.
      </li>
      <li class="itemize">X3J13 voted in June 1989 <a 
 id="dx176-302067"></a>to add the following point. All methods for
      <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> must obey <b>*print-readably*</b>, which takes precedence
      over all other printer control variables. This includes both user-deﬁned
      methods and implementation-deﬁned methods.</li></ul>
<!--l. 4925--><p class="indent" >   If these rules are not obeyed, the results are undeﬁned.
<!--l. 4927--><p class="indent" >   In general, the printer and the <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> methods should not rebind the
print control variables as they operate recursively through the structure, but this
is implementation-dependent.
<!--l. 4931--><p class="indent" >   In some implementations the stream argument passed to a <b><a 
href="symbols.html#x188-380752r752">print-object</a></b>
method is not the original stream but is an intermediate stream that implements
part of the printer. Methods should therefore not depend on the identity of this
stream.
<!--l. 4936--><p class="indent" >   All of the existing printing functions (<b><a 
href="symbols.html#x188-381027r1027">write</a></b>, <b>prin1</b>, <b><a 
href="symbols.html#x188-380751r751">print</a></b>, <b><a 
href="symbols.html#x188-380748r748">princ</a></b>, <b><a 
href="symbols.html#x188-380735r735">pprint</a></b>,
<b><a 
href="symbols.html#x188-381033r1033">write-to-string</a></b>, <b>prin1-to-string</b>, <b><a 
href="symbols.html#x188-380749r749">princ-to-string</a></b>, the <b>~S</b> and <b>~A</b>
<b><a 
href="symbols.html#x188-380438r438">format</a></b> operations, and the <b>~B</b>, <b>~D</b>, <b>~E</b>, <b>~F</b>, <b>~G</b>, <b>~$</b>, <b>~O</b>, <b>~R</b>, and
<b>~X</b> <b><a 
href="symbols.html#x188-380438r438">format</a></b> operations when they encounter a non-numeric value) are
required to be changed to go through the <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> generic function.
Each implementation is required to replace its former implementation of
printing with one or more <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> methods. Exactly which classes
have methods for <b><a 
href="symbols.html#x188-380752r752">print-object</a></b> is not speciﬁed; it would be valid for an
implementation to have one default method that is inherited by all system-deﬁned
classes.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302068"></a>
                                                                          

                                                                          
<em>
<!--l. 4952--><p class="noindent" >[Generic function]</em> <b>reinitialize-instance</b> <i>instance</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i><br />
<a 
 id="dx176-302069"></a>
<em>
[Primary method]</em> <b>reinitialize-instance</b> (<i>instance</i> standard-object) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt>
<i>initargs</i>
</div>
<!--l. 4955--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380795r795">reinitialize-instance</a></b> can be used to change the
values of local slots according to initialization arguments. This generic
function is called by the Meta-Object Protocol. It can also be called by
users.
<!--l. 4960--><p class="indent" >   The system-supplied primary method for <b><a 
href="symbols.html#x188-380795r795">reinitialize-instance</a></b> checks the
validity of initialization arguments and signals an error if an initialization
argument is supplied that is not declared valid. The method then calls the generic
function <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> with the following arguments: the instance, <b><a 
href="symbols.html#x188-380670r670">nil</a></b> (which
means no slots should be initialized according to their <b>:initform</b> forms) and the
initialization arguments it received.
<!--l. 4968--><p class="indent" >   The <em>instance</em> argument is the object to be initialized.
<!--l. 4970--><p class="indent" >   The <em>initargs</em> argument consists of alternating initialization argument names
and values.
<!--l. 4973--><p class="indent" >   The modiﬁed instance is returned as the result.
<!--l. 4975--><p class="indent" >   Initialization arguments are declared valid by using the <b>:initarg</b> option to
<b><a 
href="symbols.html#x188-380310r310">defclass</a></b>, or by deﬁning methods for <b><a 
href="symbols.html#x188-380795r795">reinitialize-instance</a></b> or <b>shared-initialize</b>.
The keyword name of each keyword parameter speciﬁer in the lambda-list of any
method deﬁned on <b><a 
href="symbols.html#x188-380795r795">reinitialize-instance</a></b> or <b>shared-initialize</b> is declared a
valid initialization argument name for all classes for which that method is
applicable.
<!--l. 4983--><p class="indent" >   See sections <a 
href="clmse143.html#x175-30000027.1.12">27.1.12<!--tex4ht:ref: Reinitializing-an-Instance-SECTION --></a>, <a 
href="clmse143.html#x175-28700027.1.9">27.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, <a 
href="clmse143.html#x175-28500027.1.9">27.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b>, <b><a 
href="symbols.html#x188-380872r872">slot-boundp</a></b>,
<b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b>, <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b>,
<b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b>, and <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302070"></a>
<em>
                                                                          

                                                                          
<!--l. 4994--><p class="noindent" >[Generic function]</em> <b>remove-method</b> <i>generic-function</i> <i>method</i><br />
<a 
 id="dx176-302071"></a>
<em>
[Primary method]</em> <b>remove-method</b> (<i>generic-function</i> standard-generic-function)
<i>method</i>
</div>
<!--l. 4997--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380806r806">remove-method</a></b> removes a method from a generic
function. It destructively modiﬁes the speciﬁed generic function and returns the
modiﬁed generic function as its result.
<!--l. 5001--><p class="indent" >   The <em>generic-function</em> argument is a generic function object.
<!--l. 5004--><p class="indent" >   The <em>method</em> argument is a method object. The function <b><a 
href="symbols.html#x188-380806r806">remove-method</a></b>
does not signal an error if the method is not one of the methods on the generic
function.
<!--l. 5008--><p class="indent" >   The modiﬁed generic function is returned. The result of <b><a 
href="symbols.html#x188-380806r806">remove-method</a></b> is
<b><a 
href="symbols.html#x188-380378r378">eq</a></b> to the <em>generic-function</em> argument.
<!--l. 5011--><p class="indent" >   See <b><a 
href="symbols.html#x188-380418r418">ﬁnd-method</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302072"></a>
<em>
<!--l. 5015--><p class="noindent" >[Generic function]</em> <b>shared-initialize</b> <i>instance</i> <i>slot-names</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i><br />
<a 
 id="dx176-302073"></a>
<em>
[Primary method]</em> <b>shared-initialize</b> (<i>instance</i> standard-object) <i>slot-names</i>
<tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i>
</div>
<!--l. 5018--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> is used to ﬁll the slots of an instance
using initialization arguments and <b>:initform</b> forms. It is called when an
instance is created, when an instance is re-initialized, when an instance is
updated to conform to a redeﬁned class, and when an instance is updated to
conform to a diﬀerent class. The generic function <b>shared-initialize</b> is
called by the system-supplied primary method for <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b>,
<b><a 
href="symbols.html#x188-380795r795">reinitialize-instance</a></b>, <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b>, and
<b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b>.
                                                                          

                                                                          
<!--l. 5029--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> takes the following arguments: the
instance to be initialized, a speciﬁcation of a set of names of slots accessible in
that instance, and any number of initialization arguments. The arguments after
the ﬁrst two must form an initialization argument list. The system-supplied
primary method on <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> initializes the slots with values
according to the initialization arguments and speciﬁed <b>:initform</b> forms. The
second argument indicates which slots should be initialized according to
their <b>:initform</b> forms if no initialization arguments are provided for those
slots.
<!--l. 5040--><p class="indent" >   The system-supplied primary method behaves as follows, regardless of whether
the slots are local or shared:
      <ul class="itemize1">
      <li class="itemize">If an initialization argument in the initialization argument list speciﬁes
      a value for that slot, that value is stored into the slot, even if a value
      has already been stored in the slot before the method is run.
      </li>
      <li class="itemize">Any slots indicated by the second argument that are still unbound at
      this point are initialized according to their <b>:initform</b> forms. For any
      such slot that has an <b>:initform</b> form, that form is evaluated in the
      lexical environment of its deﬁning <b><a 
href="symbols.html#x188-380310r310">defclass</a></b> form and the result is stored
      into the slot. For example, if a <b>:before</b> method stores a value in the
      slot, the <b>:initform</b> form will not be used to supply a value for the slot.
      </li>
      <li class="itemize">The rules mentioned in section <a 
href="clmse143.html#x175-28700027.1.9">27.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a> are obeyed.</li></ul>
<!--l. 5061--><p class="indent" >   The <em>instance</em> argument is the object to be initialized.
<!--l. 5063--><p class="indent" >   The <em>slot-names</em> argument speciﬁes the slots that are to be initialized according
to their <b>:initform</b> forms if no initialization arguments apply. It is supplied in one
of three forms as follows:
      <ul class="itemize1">
      <li class="itemize">It can be a list of slot names, which speciﬁes the set of those slot names.
      </li>
      <li class="itemize">It can be <b><a 
href="symbols.html#x188-380670r670">nil</a></b>, which speciﬁes the empty set of slot names.
                                                                          

                                                                          
      </li>
      <li class="itemize">It can be the symbol <b><a 
href="symbols.html#x188-380953r953">t</a></b>, which speciﬁes the set of all of the slots.</li></ul>
<!--l. 5080--><p class="indent" >   The <em>initargs</em> argument consists of alternating initialization argument names
and values.
<!--l. 5083--><p class="indent" >   The modiﬁed instance is returned as the result.
<!--l. 5085--><p class="indent" >   Initialization arguments are declared valid by using the <b>:initarg</b> option to
<b><a 
href="symbols.html#x188-380310r310">defclass</a></b>, or by deﬁning methods for <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b>. The keyword name of
each keyword parameter speciﬁer in the lambda-list of any method deﬁned on
<b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> is declared a valid initialization argument name for all classes
for which that method is applicable.
<!--l. 5092--><p class="indent" >   Implementations are permitted to optimize <b>:initform</b> forms that neither
produce nor depend on side eﬀects by evaluating these forms and storing them
into slots before running any <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b> methods, rather than by
handling them in the primary <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b> method. (This optimization
might be implemented by having the <b><a 
href="symbols.html#x188-380094r94">allocate-instance</a></b> method copy a prototype
instance.)
<!--l. 5100--><p class="indent" >   Implementations are permitted to optimize default initial value forms for
initialization arguments associated with slots by not actually creating the
complete initialization argument list when the only method that would receive the
complete list is the method on <b>standard-object</b>. In this case, default initial value
forms can be treated like <b>:initform</b> forms. This optimization has no visible eﬀects
other than a performance improvement.
<!--l. 5108--><p class="indent" >   See sections <a 
href="clmse143.html#x175-28300027.1.9">27.1.9<!--tex4ht:ref: Object-Creation-and-Initialization-SECTION --></a>, <a 
href="clmse143.html#x175-28700027.1.9">27.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, <a 
href="clmse143.html#x175-28500027.1.9">27.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b>,
<b><a 
href="symbols.html#x188-380795r795">reinitialize-instance</a></b>, <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b>,
<b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b>, <b><a 
href="symbols.html#x188-380872r872">slot-boundp</a></b>, and <b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302074"></a>
<em>
<!--l. 5121--><p class="noindent" >[Function]</em> <b>slot-boundp</b> <i>instance</i> <i>slot-name</i>
</div>
<!--l. 5123--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380872r872">slot-boundp</a></b> tests whether a speciﬁc slot in an instance is
bound.
<!--l. 5126--><p class="indent" >   The arguments are the instance and the name of the slot.
                                                                          

                                                                          
<!--l. 5128--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380872r872">slot-boundp</a></b> returns true or false.
<!--l. 5130--><p class="indent" >   This function allows for writing <b>:after</b> methods on <b><a 
href="symbols.html#x188-380495r495">initialize-instance</a></b> in
order to initialize only those slots that have not already been bound.
<!--l. 5134--><p class="indent" >   If no slot of the given name exists in the instance, <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> is called as
follows: <div class="lisp"><tt><div class="tabbing">
(slot-missing (class-of <em>instance</em>)
   <br>                            <em>instance</em><br>                           <em>slot-name</em><br>
              &#x2019;slot-boundp)<br>
<!--l. 5141--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5143--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380872r872">slot-boundp</a></b> is implemented using <b><a 
href="symbols.html#x188-380873r873">slot-boundp-using-class</a></b>.
See <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302075"></a>
<em>
<!--l. 5150--><p class="noindent" >[Function]</em> <b>slot-exists-p</b> <i>object</i> <i>slot-name</i>
</div>
<!--l. 5152--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380883r883">slot-exists-p</a></b> tests whether the speciﬁed object has a slot of the
given name.
<!--l. 5155--><p class="indent" >   The <em>object</em> argument is any object. The <em>slot-name</em> argument is a symbol.
<!--l. 5158--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380883r883">slot-exists-p</a></b> returns true or false.
<!--l. 5160--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380883r883">slot-exists-p</a></b> is implemented using <b>slot-exists-p-using-class</b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302076"></a>
<em>
                                                                          

                                                                          
<!--l. 5166--><p class="noindent" >[Function]</em> <b>slot-makunbound</b> <i>instance</i> <i>slot-name</i>
</div>
<!--l. 5168--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b> restores a slot in an instance to the unbound
state.
<!--l. 5171--><p class="indent" >   The arguments to <b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b> are the instance and the name of the
slot.
<!--l. 5174--><p class="indent" >   The instance is returned as the result.
<!--l. 5176--><p class="indent" >   If no slot of the given name exists in the instance, <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> is called as
follows: <div class="lisp"><tt><div class="tabbing">
(slot-missing (class-of <em>instance</em>)
   <br>                            <em>instance</em><br>                           <em>slot-name</em><br>
              &#x2019;slot-makunbound)<br>
<!--l. 5183--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5185--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b> is implemented using <b><a 
href="symbols.html#x188-380885r885">slot-makunbound-using-class</a></b>.
See <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302077"></a>
<em>
<!--l. 5191--><p class="noindent" >[Generic function]</em> <b>slot-missing</b> <i>class</i> <i>object</i> <i>slot-name</i> <i>operation</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt>
<i>new-value</i><br />
<a 
 id="dx176-302078"></a>
<em>
[Primary method]</em> <b>slot-missing</b> (<i>class</i> t) <i>object</i> <i>slot-name</i> <i>operation</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;optional</a></tt>
<i>new-value</i>
</div>
<!--l. 5194--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> is invoked when an attempt is made to
access a slot in an object whose metaclass is <b>standard-class</b> and the name of the
slot provided is not a name of a slot in that class. The default method signals an
error.
                                                                          

                                                                          
<!--l. 5200--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> is not intended to be called by
programmers. Programmers may write methods for it.
<!--l. 5203--><p class="indent" >   The required arguments to <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> are the class of the object that is
being accessed, the object, the slot name, and a symbol that indicates the
operation that caused <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> to be invoked. The optional argument to
<b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> is used when the operation is attempting to set the value of the
slot.
<!--l. 5209--><p class="indent" >   If a method written for <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> returns values, these values get returned
as the values of the original function invocation.
<!--l. 5212--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> may be called during evaluation of
<b><a 
href="symbols.html#x188-380888r888">slot-value</a></b>, <b>(setf slot-value)</b>, <b><a 
href="symbols.html#x188-380872r872">slot-boundp</a></b>, and <b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b>.
For each of these operations the corresponding symbol for the <em>operation</em>
argument is <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b>, <b><a 
href="symbols.html#x188-380845r845">setf</a></b>, <b><a 
href="symbols.html#x188-380872r872">slot-boundp</a></b>, and <b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b>,
respectively.
<!--l. 5219--><p class="indent" >   The set of arguments (including the class of the instance) facilitates deﬁning
methods on the metaclass for <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302079"></a>
<em>
<!--l. 5225--><p class="noindent" >[Generic function]</em> <b>slot-unbound</b> <i>class</i> <i>instance</i> <i>slot-name</i><br />
<a 
 id="dx176-302080"></a>
<em>
[Primary method]</em> <b>slot-unbound</b> (<i>class</i> t) <i>instance</i> <i>slot-name</i>
</div>
<!--l. 5228--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380887r887">slot-unbound</a></b> is called when an unbound slot is read in
an instance whose metaclass is <b>standard-class</b>. The default method signals an
error.
<!--l. 5233--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380887r887">slot-unbound</a></b> is not intended to be called by programmers.
Programmers may write methods for it. The function <b><a 
href="symbols.html#x188-380887r887">slot-unbound</a></b> is
called only by the function <b><a 
href="symbols.html#x188-380889r889">slot-value-using-class</a></b> and thus indirectly by
<b><a 
href="symbols.html#x188-380888r888">slot-value</a></b>.
<!--l. 5238--><p class="indent" >   The arguments to <b><a 
href="symbols.html#x188-380887r887">slot-unbound</a></b> are the class of the instance whose slot was
accessed, the instance itself, and the name of the slot.
<!--l. 5242--><p class="indent" >   If a method written for <b><a 
href="symbols.html#x188-380887r887">slot-unbound</a></b> returns values, these values get
                                                                          

                                                                          
returned as the values of the original function invocation.
<!--l. 5245--><p class="indent" >   An unbound slot may occur if no <b>:initform</b> form was speciﬁed for the slot and
the slot value has not been set, or if <b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b> has been called on the
slot.
<!--l. 5249--><p class="indent" >   See <b><a 
href="symbols.html#x188-380884r884">slot-makunbound</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302081"></a>
<em>
<!--l. 5254--><p class="noindent" >[Function]</em> <b>slot-value</b> <i>object</i> <i>slot-name</i>
</div>
<!--l. 5256--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b> returns the value contained in the slot <em>slot-name</em> of
the given object. If there is no slot with that name, <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> is called. If the
slot is unbound, <b><a 
href="symbols.html#x188-380887r887">slot-unbound</a></b> is called.
<!--l. 5261--><p class="indent" >   The macro <b><a 
href="symbols.html#x188-380845r845">setf</a></b> can be used with <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b> to change the value of a
slot.
<!--l. 5264--><p class="indent" >   If an attempt is made to read a slot and no slot of the given name exists in the
instance, <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> is called as follows: <div class="lisp"><tt><div class="tabbing">
(slot-missing (class-of <em>instance</em>)
   <br>                            <em>instance</em><br>                           <em>slot-name</em><br>
              &#x2019;slot-value)<br>
<!--l. 5271--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5273--><p class="indent" >   If an attempt is made to write a slot and no slot of the given name exists in
the instance, <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> is called as follows: <div class="lisp"><tt><div class="tabbing">
(slot-missing (class-of <em>instance</em>)
   <br>                                                                            <em>instance</em><br>
              <em>slot-name</em><br>                                          &#x2019;setf<br>
              <em>new-value</em>)<br>
                                                                          

                                                                          
<!--l. 5281--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5283--><p class="indent" >   The function <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b> is implemented using <b><a 
href="symbols.html#x188-380889r889">slot-value-using-class</a></b>.
<!--l. 5286--><p class="indent" >   Implementations may optimize <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b> by compiling it in-line.
<!--l. 5288--><p class="indent" >   See <b><a 
href="symbols.html#x188-380886r886">slot-missing</a></b> and <b><a 
href="symbols.html#x188-380887r887">slot-unbound</a></b>.
<hr></div>
<!--l. 5291--><p class="indent" >   [At this point the original CLOS report <span class="cite">[<a 
href="bib.html#XSIGPLAN-CLOS">5</a>, <a 
href="bib.html#XLASC-CLOS-PART-2">7</a>]</span> contained a speciﬁcation for
<b><a 
href="symbols.html#x188-380946r946">symbol-macrolet</a></b>. This speciﬁcation is omitted here. Instead, a description of
<b><a 
href="symbols.html#x188-380946r946">symbol-macrolet</a></b> appears with those of related constructs in chapter <a 
href="contrl.html#x46-740007">7<!--tex4ht:ref: CONTRL --></a>.—GLS]
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302082"></a>
<em>
<!--l. 5297--><p class="noindent" >[Generic function]</em> <b>update-instance-for-diﬀerent-class</b> <i>previous</i> <i>current</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt>
<i>initargs</i><br />
<a 
 id="dx176-302083"></a>
<em>
[Primary method]</em> <b>update-instance-for-diﬀerent-class</b> (<i>previous</i> standard-object)
(<i>current</i> standard-object) <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i>
</div>
<!--l. 5301--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> is not intended to
be called by programmers. Programmers may write methods for it. This function
is called only by the function <b><a 
href="symbols.html#x188-380214r214">change-class</a></b>.
<!--l. 5305--><p class="indent" >   The system-supplied primary method on <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b>
checks the validity of initialization arguments and signals an error if an
initialization argument is supplied that is not declared valid. This method then
initializes slots with values according to the initialization arguments and initializes
the newly added slots with values according to their <b>:initform</b> forms.
It does this by calling the generic function <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> with the
following arguments: the instance, a list of names of the newly added
slots, and the initialization arguments it received. Newly added slots are
those local slots for which no slot of the same name exists in the previous
class.
<!--l. 5317--><p class="indent" >   Methods for <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> can be deﬁned to specify
actions to be taken when an instance is updated. If only <b>:after</b> methods for
                                                                          

                                                                          
<b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> are deﬁned, they will be run after the
system-supplied primary method for initialization and therefore will not interfere
with the default behavior of <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b>.
<!--l. 5326--><p class="indent" >   The arguments to <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> are computed by
<b><a 
href="symbols.html#x188-380214r214">change-class</a></b>. When <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> is invoked on an instance, a copy of that
instance is made; <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> then destructively alters the original instance.
The ﬁrst argument to <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b>, <em>previous</em>, is
that copy; it holds the old slot values temporarily. This argument has
dynamic extent within <b><a 
href="symbols.html#x188-380214r214">change-class</a></b>; if it is referenced in any way once
<b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> returns, the results are undeﬁned. The
second argument to <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b>, <em>current</em>, is the altered
original instance.
<!--l. 5338--><p class="indent" >   The intended use of <em>previous</em> is to extract old slot values by using
<b><a 
href="symbols.html#x188-380888r888">slot-value</a></b> or <b><a 
href="symbols.html#x188-381025r1025">with-slots</a></b> or by invoking a reader generic function, or
to run other methods that were applicable to instances of the original
class.
<!--l. 5343--><p class="indent" >   The <em>initargs</em> argument consists of alternating initialization argument names
and values.
<!--l. 5346--><p class="indent" >   The value returned by <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> is ignored by
<b><a 
href="symbols.html#x188-380214r214">change-class</a></b>.
<!--l. 5349--><p class="indent" >   See the example for the function <b><a 
href="symbols.html#x188-380214r214">change-class</a></b>.
<!--l. 5351--><p class="indent" >   Initialization arguments are declared valid by using the <b>:initarg</b> option to
<b><a 
href="symbols.html#x188-380310r310">defclass</a></b>, or by deﬁning methods for <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> or
<b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b>. The keyword name of each keyword parameter speciﬁer in the
lambda-list of any method deﬁned on <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> or
<b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> is declared a valid initialization argument name for all classes
for which that method is applicable.
<!--l. 5359--><p class="indent" >   Methods on <b><a 
href="symbols.html#x188-380992r992">update-instance-for-diﬀerent-class</a></b> can be deﬁned to initialize
slots diﬀerently from <b><a 
href="symbols.html#x188-380214r214">change-class</a></b>. The default behavior of <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> is
described in section <a 
href="clmse143.html#x175-29600027.1.11">27.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a>.
<!--l. 5364--><p class="indent" >   See sections <a 
href="clmse143.html#x175-29600027.1.11">27.1.11<!--tex4ht:ref: Changing-the-Class-of-an-Instance-SECTION --></a>, <a 
href="clmse143.html#x175-28700027.1.9">27.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, and <a 
href="clmse143.html#x175-28500027.1.9">27.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380214r214">change-class</a></b> and
<b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b>.
<hr></div>
<div class="defun">
<div class="defunheader">
<a 
 id="dx176-302084"></a>
                                                                          

                                                                          
<em>
<!--l. 5371--><p class="noindent" >[Generic function]</em> <b>update-instance-for-redeﬁned-class</b> <i>instance</i> <i>added-slots</i>
<i>discarded-slots</i> <i>property-list</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i><br />
<a 
 id="dx176-302085"></a>
<em>
[Primary method]</em> <b>update-instance-for-redeﬁned-class</b> (<i>instance</i> standard-object)
<i>added-slots</i> <i>discarded-slots</i> <i>property-list</i> <tt><a 
href="clmse29.html#x39-620005.2.2">&#x0026;rest</a></tt> <i>initargs</i>
</div>
<!--l. 5376--><p class="indent" >   The generic function <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b> is not intended
to be called by programmers. Programmers may write methods for it. The generic
function <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b> is called by the mechanism
activated by <b><a 
href="symbols.html#x188-380596r596">make-instances-obsolete</a></b>.
<!--l. 5382--><p class="indent" >   The system-supplied primary method on <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b>
checks the validity of initialization arguments and signals an error if an
initialization argument is supplied that is not declared valid. This method then
initializes slots with values according to the initialization arguments and initializes
the newly added slots with values according to their <b>:initform</b> forms. It does
this by calling the generic function <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> with the following
arguments: the instance, a list of names of the newly added slots, and the
initialization arguments it received. Newly added slots are those local
slots for which no slot of the same name exists in the old version of the
class.
<!--l. 5394--><p class="indent" >   When <b><a 
href="symbols.html#x188-380596r596">make-instances-obsolete</a></b> is invoked or when a class has been redeﬁned
and an instance is being updated, a property list is created that captures the slot
names and values of all the discarded slots with values in the original instance.
The structure of the instance is transformed so that it conforms to the current
class deﬁnition. The arguments to <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b>
are this transformed instance, a list of the names of the new slots added
to the instance, a list of the names of the old slots discarded from the
instance, and the property list containing the slot names and values for slots
that were discarded and had values. Included in this list of discarded
slots are slots that were local in the old class and are shared in the new
class.
<!--l. 5407--><p class="indent" >   The <em>initargs</em> argument consists of alternating initialization argument names
and values.
<!--l. 5410--><p class="indent" >   The value returned by <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b> is ignored.
<!--l. 5412--><p class="indent" >   Initialization arguments are declared valid by using the <b>:initarg</b> option to
                                                                          

                                                                          
<b><a 
href="symbols.html#x188-380310r310">defclass</a></b> or by deﬁning methods for <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b> or
<b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b>. The keyword name of each keyword parameter speciﬁer in the
lambda-list of any method deﬁned on <b><a 
href="symbols.html#x188-380993r993">update-instance-for-redeﬁned-class</a></b> or
<b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> is declared a valid initialization argument name for all classes
for which that method is applicable.
<!--l. 5420--><p class="indent" >   See sections <a 
href="clmse143.html#x175-29100027.1.10">27.1.10<!--tex4ht:ref: Redefining-Classes-SECTION --></a>, <a 
href="clmse143.html#x175-28700027.1.9">27.1.9<!--tex4ht:ref: Rules-for-Initialization-Arguments-SECTION --></a>, and <a 
href="clmse143.html#x175-28500027.1.9">27.1.9<!--tex4ht:ref: Declaring-the-Validity-of-Initialization-Arguments-SECTION --></a> as well as <b><a 
href="symbols.html#x188-380850r850">shared-initialize</a></b> and
<b><a 
href="symbols.html#x188-380596r596">make-instances-obsolete</a></b>. <div class="lisp"><tt><div class="tabbing">
(defclass position () ())
   <br>                                                                                               <br>
(defclass x-y-position (position)<br>        ((x :initform 0 :accessor position-x)<br>
   (y :initform 0 :accessor position-y)))<br>
<br>             ;;; It turns out polar coordinates are used more than Cartesian<br>
;;; coordinates, so the representation is altered and some new<br>
;;; accessor methods are added.<br>
<br>                     (defmethod update-instance-for-redeﬁned-class :before<br>
           ((pos x-y-position) added deleted plist &#x0026;key)<br>
  ;; Transform the x-y coordinates to polar coordinates<br>
  ;; and store into the new slots.<br>
  (let ((x (getf plist &#x2019;x))<br>                               (y (getf plist &#x2019;y)))<br>
    (setf (position-rho pos) (sqrt (+ (* x x) (* y y)))<br>
          (position-theta pos) (atan y x))))<br>
<br>                                           (defclass x-y-position (position)<br>
    ((rho :initform 0 :accessor position-rho)<br>
     (theta :initform 0 :accessor position-theta)))<br>
<!--l. 5447--><p class="noindent" ></div>
</tt>
</div><div class="lisp">
<tt>
<!--l. 5450--><p class="indent" >   <div class="tabbing">
;;; All instances of the old x-y-position class will be updated
   <br>                                                                         ;;; automatically.<br>
<br>             ;;; The new representation has the look and feel of the old one.<br>
                                                                          

                                                                          
<br>                                 (defmethod position-x ((pos x-y-position))<br>
   (with-slots (rho theta) pos (* rho (cos theta))))<br>
<br>                    (defmethod (setf position-x) (new-x (pos x-y-position))<br>
   (with-slots (rho theta) pos<br>                   (let ((y (position-y pos)))<br>
       (setq rho (sqrt (+ (* new-x new-x) (* y y)))<br>
             theta (atan y new-x))<br>                            new-x)))<br>
<br>                                 (defmethod position-y ((pos x-y-position))<br>
   (with-slots (rho theta) pos (* rho (sin theta))))<br>
<!--l. 5468--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 5469--><p class="indent" >   <div class="tabbing">
(defmethod (setf position-y) (new-y (pos x-y-position))
   <br>          (with-slots (rho theta) pos<br>            (let ((x (position-x pos)))<br>
       (setq rho (sqrt (+ (* x x) (* new-y new-y)))<br>
             theta (atan new-y x))<br>                            new-y)))<br>
<!--l. 5476--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
<div class="defmac">
<div class="defmacheader">
<!--l. 5480--><p class="indent" >   <div class="tabbing">
 <em>[Macro]</em> <b>with-accessors</b> <a 
 id="dx176-302086"></a>({slot-entry}*) instance-form{declaration}* {form}*
   <br>
<!--l. 5482--><p class="noindent" ></div>
</div>
<!--l. 5483--><p class="indent" >   The macro <b><a 
href="symbols.html#x188-381015r1015">with-accessors</a></b> creates a lexical environment in which speciﬁed
slots are lexically available through their accessors as if they were variables. The
                                                                          

                                                                          
macro <b><a 
href="symbols.html#x188-381015r1015">with-accessors</a></b> invokes the appropriate accessors to access the
speciﬁed slots. Both <b><a 
href="symbols.html#x188-380845r845">setf</a></b> and <b><a 
href="symbols.html#x188-380846r846">setq</a></b> can be used to set the value of the
slot.
<!--l. 5489--><p class="indent" >   The result returned is that obtained by executing the forms speciﬁed by the
<em>body</em> argument.
<!--l. 5492--><p class="indent" >   Example:
<div class="lisp">
<tt>
<!--l. 5494--><p class="indent" >   <div class="tabbing">
(with-accessors ((x position-x) (y position-y)) p1
   <br>                                                                                (setq x y))<br>
<!--l. 5497--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5500--><p class="indent" >   A <b><a 
href="symbols.html#x188-381015r1015">with-accessors</a></b> expression of the form <div class="lisp"><tt><div class="tabbing">
(with-accessors (<span class="math">slot<sub>1</sub></span> ... <span class="math">slot<sub>n</sub></span>) <em>instance</em>
   <br>                                                   <span class="math">declaration<sub>1</sub></span> ... <span class="math">declaration<sub>m</sub></span>)<br>
  <span class="math">form<sub>1</sub></span> ... <span class="math">form<sub>k</sub></span>)<br>
<!--l. 5505--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5506--><p class="indent" >   expands into the equivalent of <div class="lisp"><tt><div class="tabbing">
(let ((<em>in</em> <em>instance</em>))
   <br>
  (symbol-macrolet ((<span class="math">variable<sub>1</sub></span> (<span class="math">accessor<sub>1</sub></span> <em>in</em>))<br>                       ...<br>
                    (<span class="math">variable<sub>n</sub></span> (<span class="math">accessor<sub>n</sub></span> <em>in</em>)))<br>
    <span class="math">declaration<sub>1</sub></span> ... <span class="math">declaration<sub>m</sub></span>)<br>                       <span class="math">form<sub>1</sub></span> ... <span class="math">form<sub>k</sub></span>)<br>
                                                                          

                                                                          
<!--l. 5514--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5517--><p class="indent" >   [X3J13 voted in March 1989 <a 
 id="dx176-302087"></a>to modify the deﬁnition of <b><a 
href="symbols.html#x188-380946r946">symbol-macrolet</a></b>
substantially and also voted <a 
 id="dx176-302088"></a>to allow declarations before the body of
<b><a 
href="symbols.html#x188-380946r946">symbol-macrolet</a></b> but with peculiar treatment of <b>special</b> and type declarations.
The syntactic changes are reﬂected in this deﬁnition of <b><a 
href="symbols.html#x188-381015r1015">with-accessors</a></b>.—GLS]
<!--l. 5526--><p class="indent" >   See <b><a 
href="symbols.html#x188-381025r1025">with-slots</a></b> and <b><a 
href="symbols.html#x188-380946r946">symbol-macrolet</a></b>.
<hr></div>
<div class="defmac">
<div class="defmacheader">
<!--l. 5615--><p class="indent" >   <div class="tabbing">
 <em>[Macro]</em> <b>with-slots</b> <a 
 id="dx176-302089"></a>({slot-entry}*) instance-form {declaration}* {form}*
   <br>
<!--l. 5616--><p class="noindent" ></div>
</div>
<!--l. 5617--><p class="indent" >   <div class="tabbing">
<em>slot-entry</em> ::= <em>slot-name</em> | <b>(<em>variable-name</em> <em>slot-name</em>)</b>
   <br>
<!--l. 5619--><p class="noindent" ></div>The macro <b><a 
href="symbols.html#x188-381025r1025">with-slots</a></b> creates a lexical context for referring to speciﬁed
slots as though they were variables. Within such a context the value of
the slot can be speciﬁed by using its slot name, as if it were a lexically
bound variable. Both <b><a 
href="symbols.html#x188-380845r845">setf</a></b> and <b><a 
href="symbols.html#x188-380846r846">setq</a></b> can be used to set the value of the
slot.
<!--l. 5626--><p class="indent" >   The macro <b><a 
href="symbols.html#x188-381025r1025">with-slots</a></b> translates an appearance of the slot name as a variable
into a call to <b><a 
href="symbols.html#x188-380888r888">slot-value</a></b>.
<!--l. 5629--><p class="indent" >   The result returned is that obtained by executing the forms speciﬁed by the
<em>body</em> argument.
<!--l. 5632--><p class="indent" >   Example:
<div class="lisp">
<tt>
<!--l. 5634--><p class="indent" >   <div class="tabbing">
                                                                          

                                                                          
(with-slots (x y) position-1
   <br>                                                            (sqrt (+ (* x x) (* y y))))<br>
<br>                                      (with-slots ((x1 x) (y1 y)) position-1<br>
  (with-slots ((x2 x) (y2 y)) position-2<br>                        (psetf x1 x2<br>
           y1 y2))))<br>                                                    <br>
(with-slots (x y) position<br>                                   (setq x (1+ x)<br>
        y (1+ y)))<br>
<!--l. 5646--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5648--><p class="indent" >   A <b><a 
href="symbols.html#x188-381025r1025">with-slots</a></b> expression of the form: <div class="lisp"><tt><div class="tabbing">
(with-slots (<span class="math">slot-entry<sub>1</sub></span> ... <span class="math">slot-entry<sub>n</sub></span>) <em>instance</em>
   <br>                                                   <span class="math">declaration<sub>1</sub></span> ... <span class="math">declaration<sub>m</sub></span>)<br>
  <span class="math">form<sub>1</sub></span> ... <span class="math">form<sub>k</sub></span>)<br>
<!--l. 5653--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5654--><p class="indent" >   expands into the equivalent of <div class="lisp"><tt><div class="tabbing">
(let ((<em>in</em> <em>instance</em>))
   <br>      (symbol-macrolet (<span class="math">Q<sub>1</sub></span> ... <span class="math">Q<sub>n</sub></span>)<br>        <span class="math">declaration<sub>1</sub></span> ... <span class="math">declaration<sub>m</sub></span>)<br>
    <span class="math">form<sub>1</sub></span> ... <span class="math">form<sub>k</sub></span>)<br>
<!--l. 5660--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5661--><p class="indent" >   where <span class="math">Q<sub>j</sub></span> is <div class="lisp"><tt><div class="tabbing">
(<span class="math">slot-entry<sub>j</sub></span> (slot-value <em>in</em> &#x2019;<span class="math">slot-entry<sub>j</sub></span>))
   <br>
                                                                          

                                                                          
<!--l. 5664--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5665--><p class="indent" >   if <span class="math">slot-entry<sub>j</sub></span> is a symbol and is <div class="lisp"><tt><div class="tabbing">
(<span class="math">variable-name<sub>j</sub></span> (slot-value <em>in</em> &#x2019;<span class="math">slot-name<sub>j</sub></span>))
   <br>
<!--l. 5668--><p class="noindent" ></div>
</tt>
</div>
<!--l. 5669--><p class="indent" >   if <span class="math">slot-entry<sub>j</sub></span> is of the form <b>(<span class="math">variable-name<sub>j</sub></span> <span class="math">slot-name<sub>j</sub></span>)</b>.
<!--l. 5672--><p class="indent" >   [X3J13 voted in March 1989 <a 
 id="dx176-302090"></a>to modify the deﬁnition of <b><a 
href="symbols.html#x188-380946r946">symbol-macrolet</a></b>
substantially and also voted <a 
 id="dx176-302091"></a>to allow declarations before the body of
<b><a 
href="symbols.html#x188-380946r946">symbol-macrolet</a></b> but with peculiar treatment of <b>special</b> and type declarations.
The syntactic changes are reﬂected in this deﬁnition of <b><a 
href="symbols.html#x188-381025r1025">with-slots</a></b>.—GLS]
<!--l. 5681--><p class="indent" >   See <b><a 
href="symbols.html#x188-381015r1015">with-accessors</a></b> and <b><a 
href="symbols.html#x188-380946r946">symbol-macrolet</a></b>.
<hr></div>
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
                                                                          

                                                                          
<!--l. 8--><p class="indent" >   <div id="bottomlinks">&#x003C;<a 
href="condition.html" >Next</a>&#x003E;&#x003C;<a 
href="clmse143.html" >Prev</a>&#x003E;&#x003C;<a 
href="clmse143.html#tailclmse143.html" >PrevTail</a>&#x003E;&#x003C;<a 
href="clmse144.html" >Front</a>&#x003E;&#x003C;<a 
href="clos.html#clmse144.html" >Up</a>&#x003E;<br>&lt;<a href="../index.html">Main Page</a>&gt; &lt;<a href="symbols.html">Symbols</a>&gt; </div><a 
 id="tailclmse144.html"></a>  
</body></html> 

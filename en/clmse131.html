<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//RU"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Iteration Control</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- 3,next,fn-in,charset=utf-8,sections+,minitoc<,html --> 
<meta name="src" content="clm.tex"> 
<meta name="date" content="2012-09-13 12:36:00"> 
<link rel="stylesheet" type="text/css" href="clm.css"> 
<link rel="stylesheet" type="text/css" href="../cltl2ed.css"></head><body 
>
   <div id="toplinks"> &lt;<a href="../index.html">Main Page</a>&gt; &lt;<a href="symbols.html">Symbols</a>&gt; <br> &#x003C;<a 
href="clmse132.html" >Next</a>&#x003E;&#x003C;<a 
href="clmse130.html" >Prev</a>&#x003E;&#x003C;<a 
href="clmse130.html#tailclmse130.html" >PrevTail</a>&#x003E;&#x003C;<a 
href="#tailclmse131.html">Tail</a>&#x003E;&#x003C;<a 
href="loop.html#clmse131.html" >Up</a>&#x003E;</div><h3 class="sectionHead"><span class="titlemark">26.6   </span> <a 
href="clm.html#QQ2-162-277" id="x162-23700026.6">Iteration Control</a></h3>
<!--l. 451--><p class="noindent" >Iteration control clauses allow you to direct loop iteration. The loop keywords <b><a 
href="symbols.html#x190-382123r123">as</a></b>,
<b><a 
href="symbols.html#x190-382436r436">for</a></b>, and <b><a 
href="symbols.html#x190-382810r810">repeat</a></b> designate iteration control clauses.
<!--l. 454--><p class="indent" >   Iteration control clauses diﬀer with respect to the speciﬁcation of termination
conditions and the initialization and stepping of loop variables. Iteration clauses
by themselves do not cause the Loop Facility to return values, but they can be
used in conjunction with value-accumulation clauses to return values (see
section <a 
href="clmse133.html#x164-23900026.8">26.8<!--tex4ht:ref: LOOP-ACCUM-SECTION --></a>).
<!--l. 461--><p class="indent" >   All variables are initialized in the loop prologue. The scope of the variable
binding is <em>lexical</em> unless it is proclaimed special; thus, the variable can be accessed
only by expressions that lie textually within the loop. Stepping assignments are
made in the loop body before any other expressions are evaluated in the
body.
<!--l. 468--><p class="indent" >   The variable argument in iteration control clauses can be a <em>destructuring list</em>.
A destructuring list is a tree whose non-null atoms are symbols that can be
assigned a value (see section <a 
href="clmse137.html#x168-24500026.12.2">26.12.2<!--tex4ht:ref: LOOP-DESTRUCTURING-SECTION --></a>).
<!--l. 473--><p class="indent" >   The iteration control clauses <b><a 
href="symbols.html#x190-382436r436">for</a></b>, <b><a 
href="symbols.html#x190-382123r123">as</a></b>, and <b><a 
href="symbols.html#x190-382810r810">repeat</a></b> must precede any other loop
clauses except <b><a 
href="symbols.html#x190-382496r496">initially</a></b>, <b><a 
href="symbols.html#x190-383014r1014">with</a></b>, and <b><a 
href="symbols.html#x190-382663r663">named</a></b>, since they establish variable
bindings. When iteration control clauses are used in a loop, termination
tests in the loop body are evaluated before any other loop body code is
executed.
<!--l. 480--><p class="indent" >   If you use multiple iteration clauses to control iteration, variable initialization
and stepping occur sequentially by default. You can use the <b><a 
href="symbols.html#x190-382098r98">and</a></b> construct
to connect two or more iteration clauses when sequential binding and
stepping are not necessary. The iteration behavior of clauses joined by <b><a 
href="symbols.html#x190-382098r98">and</a></b>
is analogous to the behavior of the Common Lisp macro <b><a 
href="symbols.html#x190-382347r347">do</a></b> relative to
<b><a 
href="symbols.html#x190-382348r348">do*</a></b>.
<!--l. 488--><p class="indent" >   [X3J13 voted in March 1989 <a 
 id="dx162-237001"></a>to correct a minor inconsistency in the original
syntactic speciﬁcation for <b><a 
href="symbols.html#x190-382577r577">loop</a></b>. Only <b><a 
href="symbols.html#x190-382436r436">for</a></b> and <b><a 
href="symbols.html#x190-382123r123">as</a></b> clauses (not <b><a 
href="symbols.html#x190-382810r810">repeat</a></b> clauses)
may be joined by the <b><a 
href="symbols.html#x190-382098r98">and</a></b> construct. The precise syntax is as follows.
<div class="tabbing">
                                                                          

                                                                          
<em>for-as</em> ::=  {<i><b><a 
href="symbols.html#x190-382436r436">for</a></b> | <b><a 
href="symbols.html#x190-382123r123">as</a></b></i>}  <em>for-as-subclause</em> {<i><b><a 
href="symbols.html#x190-382098r98">and</a></b> <em>for-as-subclause</em></i>}*
   <br>                           <em>for-as-subclause</em> ::= <em>for-as-arithmetic</em> | <em>for-as-in-list</em><br>
                  | <em>for-as-on-list</em> | <em>for-as-equals-then</em><br>
                  | <em>for-as-across</em> | <em>for-as-hash</em> | <em>for-as-package</em><br>
<em>for-as-arithmetic</em> ::= <em>var</em> [<i>type-spec</i>]  [<i> {<i><b>from</b> | <b>downfrom</b> | <b>upfrom</b></i>} expr1</i>] <br>
                     [<i> {<i><b>to</b> | <b>downto</b> | <b>upto</b> | <b>below</b> | <b>above</b></i>} expr2</i>] <br>
                     [<i><b>by</b> expr3</i>] <br><em>for-as-in-list</em> ::= <em>var</em> [<i>type-spec</i>]  <b>in</b> <em>expr1</em> [<i><b>by</b> step-fun</i>] <br>
<em>for-as-on-list</em> ::= <em>var</em> [<i>type-spec</i>]  <b>on</b> <em>expr1</em> [<i><b>by</b> step-fun</i>] <br>
<em>for-as-equals-then</em> ::= <em>var</em> [<i>type-spec</i>]  <b><a 
href="symbols.html#x190-382075r75">=</a></b> <em>expr1</em> [<i><b>then</b> step-fun</i>] <br>
<em>for-as-across</em> ::= <em>var</em> [<i>type-spec</i>]  <b>across</b> <em>vector</em><br>
<em>for-as-hash</em> ::= <em>var</em> [<i>type-spec</i>]  <b>being</b> {<i><b>each</b> | <b><a 
href="symbols.html#x190-382960r960">the</a></b></i>} <br>
                {<i><b>hash-key</b> | <b>hash-keys</b> | <b>hash-value</b> | <b>hash-values</b></i>} <br>
                {<i><b>in</b> | <b>of</b></i>}  <em>hash-table</em><br>                [<i><b>using</b> <b>(</b>{<i><b>hash-value</b> | <b>hash-key</b></i>} other-var<b>)</b></i>] <br>
<em>for-as-package</em> ::= <em>var</em> [<i>type-spec</i>]  <b>being</b> {<i><b>each</b> | <b><a 
href="symbols.html#x190-382960r960">the</a></b></i>} <br>
                  <em>for-as-package-keyword</em><br>                   {<i><b>in</b> | <b>of</b></i>}  <em>package</em><br>
<em>for-as-package-keyword</em> ::= <b>symbol</b> | <b>present-symbol</b> | <b>external-symbol</b><br>
                         | <b>symbols</b> | <b>present-symbols</b> | <b>external-symbols</b><br>
<!--l. 513--><p class="noindent" ></div>This correction made <b><a 
href="symbols.html#x190-382436r436">for</a></b> and <b><a 
href="symbols.html#x190-382123r123">as</a></b> clauses syntactically similar to <b><a 
href="symbols.html#x190-383014r1014">with</a></b> clauses. I have
changed all examples in this chapter to reﬂect the corrected syntax.—GLS]
<!--l. 518--><p class="indent" >   In the following example, the variable <b>x</b> is stepped before <b>y</b> is stepped; thus,
the value of <b>y</b> reﬂects the updated value of <b>x</b>: <div class="lisp"><tt><div class="tabbing">
(loop for x from 1 to 9
   <br>                     for y = nil then x<br>                     collect (list x y))<br>
   <span class="math"> ⇒</span> ((1 NIL) (2 2) (3 3) (4 4) (5 5) (6 6) (7 7) (8 8) (9 9))<br>
<!--l. 526--><p class="noindent" ></div>
</tt>
</div>
<!--l. 528--><p class="indent" >   In the following example, <b>x</b> and <b>y</b> are stepped in parallel: <div class="lisp"><tt><div class="tabbing">
(loop for x from 1 to 9
   <br>                     and y = nil then x<br>                     collect (list x y))<br>
   <span class="math"> ⇒</span> ((1 NIL) (2 1) (3 2) (4 3) (5 4) (6 5) (7 6) (8 7) (9 8))<br>
                                                                          

                                                                          
<!--l. 534--><p class="noindent" ></div>
</tt>
</div>
<!--l. 536--><p class="indent" >   The <b><a 
href="symbols.html#x190-382436r436">for</a></b> and <b><a 
href="symbols.html#x190-382123r123">as</a></b> clauses iterate by using one or more local loop variables that
are initialized to some value and that can be modiﬁed or stepped after each
iteration. For these clauses, iteration terminates when a local variable
reaches some speciﬁed value or when some other loop clause terminates
iteration. At each iteration, variables can be stepped by an increment or a
decrement or can be assigned a new value by the evaluation of an expression.
Destructuring can be used to assign initial values to variables during
iteration.
<!--l. 547--><p class="indent" >   The <b><a 
href="symbols.html#x190-382436r436">for</a></b> and <b><a 
href="symbols.html#x190-382123r123">as</a></b> keywords are synonyms and may be used interchangeably.
There are seven syntactic representations for these constructs. In each syntactic
description, the data type of <em>var</em> can be speciﬁed by the optional <em>type-spec</em>
argument. If <em>var</em> is a destructuring list, the data type speciﬁed by the <em>type-spec</em>
argument must appropriately match the elements of the list (see sections <a 
href="clmse137.html#x168-24400026.12.1">26.12.1<!--tex4ht:ref: LOOP-TYPES-SECTION --></a>
and <a 
href="clmse137.html#x168-24500026.12.2">26.12.2<!--tex4ht:ref: LOOP-DESTRUCTURING-SECTION --></a>).
<div class="defloop">
<div class="defmacheader">
<!--l. 558--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>for</b> <a 
 id="dx162-237002"></a>var [type-spec] [{<b>from</b> | <b>downfrom</b> | <b>upfrom</b>} expr1][{<b>to</b> | <b>downto</b> | <b>upto</b> | <b>below</b> | <b>above</b>} expr2][<b>by</b> expr3]
   <br>
<!--l. 560--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 560--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>as</b> <a 
 id="dx162-237003"></a>var [type-spec] [{<b>from</b> | <b>downfrom</b> | <b>upfrom</b>} expr1][{<b>to</b> | <b>downto</b> | <b>upto</b> | <b>below</b> | <b>above</b>} expr2][<b>by</b> expr3]
   <br>
<!--l. 564--><p class="noindent" ></div>
</div>
<!--l. 565--><p class="indent" >   [This is the ﬁrst of seven <b><a 
href="symbols.html#x190-382436r436">for</a></b>/<b><a 
href="symbols.html#x190-382123r123">as</a></b> syntaxes.—GLS]
<!--l. 567--><p class="indent" >   The <b><a 
href="symbols.html#x190-382436r436">for</a></b> or <b><a 
href="symbols.html#x190-382123r123">as</a></b> construct iterates from the value speciﬁed by <em>expr1</em>
to the value speciﬁed by <em>expr2</em> in increments or decrements denoted by
<em>expr3</em>. Each expression is evaluated only once and must evaluate to a
                                                                          

                                                                          
number.
<!--l. 572--><p class="indent" >   The variable <em>var</em> is bound to the value of <em>expr1</em> in the ﬁrst iteration and is
stepped by the value of <em>expr3</em> in each succeeding iteration, or by 1 if <em>expr3</em> is not
provided.
<!--l. 577--><p class="indent" >   The following loop keywords serve as valid prepositions within this
syntax.
<div class="flushdesc">
      <ul><li><b>
<b>from</b> </b></li>The  loop  keyword  <b>from</b>  marks  the  value  from  which  stepping
      begins,  as  speciﬁed  by  <em>expr1</em>.  Stepping  is  incremental  by  default.
      For  decremental  stepping,  use  <b>above</b> or  <b>downto</b> with  <em>expr2</em>.  For
      incremental stepping, the default <b>from</b> value is <b>0</b>.
      <li><b>
<b>downfrom</b>, <b>upfrom</b> </b></li>The  loop  keyword  <b>downfrom</b>  indicates  that  the
      variable <em>var</em> is decreased in decrements speciﬁed by <em>expr3</em>; the loop
      keyword <b>upfrom</b> indicates that <em>var</em> is increased in increments speciﬁed
      by <em>expr3</em>.
      <li><b>
<b>to</b> </b></li>The  loop  keyword  <b>to</b> marks  the  end  value  for  stepping  speciﬁed  in
      <em>expr2</em>. Stepping is incremental by default. For decremental stepping,
      use <b>downto</b>, <b>downfrom</b>, or <b>above</b> with <em>expr2</em>.
      <li><b>
<b>downto</b>, <b>upto</b> </b></li>The loop keyword <b>downto</b> allows iteration to proceed from
      a larger number to a smaller number by the decrement <em>expr3</em>. The loop
      keyword <b>upto</b> allows iteration to proceed from a smaller number to
      a larger number by the increment <em>expr3</em>. Since there is no default for
      <em>expr1</em> in decremental stepping, you must supply a value with <b>downto</b>.
      <li><b>
<b>below</b>, <b>above</b> </b></li>The loop keywords <b>below</b> and <b>above</b> are analogous to <b>upto</b>
      and <b>downto</b>, respectively. These keywords stop iteration just before
      the value of the variable <em>var</em> reaches the value speciﬁed by <em>expr2</em>; the
      end value of <em>expr2</em> is not included. Since there is no default for <em>expr1</em>
      in decremental stepping, you must supply a value with <b>above</b>.
                                                                          

                                                                          
      <li><b>
<b>by</b> </b></li>The loop keyword <b>by</b> marks the increment or decrement speciﬁed by
      <em>expr3</em>. The value of <em>expr3</em> can be any positive number. The default
      value is <b>1</b>.</ul>
</div>
<!--l. 623--><p class="indent" >   At least one of these prepositions must be used with this syntax.
<!--l. 625--><p class="indent" >   In an iteration control clause, the <b><a 
href="symbols.html#x190-382436r436">for</a></b> or <b><a 
href="symbols.html#x190-382123r123">as</a></b> construct causes termination when
the speciﬁed limit is reached. That is, iteration continues until the value <em>var</em> is
stepped to the exclusive or inclusive limit speciﬁed by <em>expr2</em>. The range is
<em>exclusive</em> if <em>expr3</em> increases or decreases <em>var</em> to the value of <em>expr2</em> without
reaching that value; the loop keywords <b>below</b> and <b>above</b> provide exclusive limits.
An <em>inclusive</em> limit allows <em>var</em> to attain the value of <em>expr2</em>; <b>to</b>, <b>downto</b>, and <b>upto</b>
provide inclusive limits.
<!--l. 636--><p class="indent" >   A common convention is to use <b><a 
href="symbols.html#x190-382436r436">for</a></b> to introduce new iterations and <b><a 
href="symbols.html#x190-382123r123">as</a></b> to
introduce iterations that depend on a previous iteration speciﬁcation. [However,
<b><a 
href="symbols.html#x190-382577r577">loop</a></b> does not enforce this convention, and some of the examples below violate it.
<em>De gustibus non disputandum est.</em>—GLS]
<!--l. 641--><p class="indent" >   Examples: <div class="lisp"><tt><div class="tabbing">
;;; Print some numbers.
   <br>
(loop as i from 1 to 5
   <br>
      do (print i))                                          ;Prints 5 lines<br>
1<br>                                   2<br>                                   3<br>
4<br>                                                                        5<br>
   <span class="math"> ⇒</span> NIL<br>                                                               <br>
;;; Print every third number.<br>
(loop for i from 10 downto 1 by 3
   <br>
      do (print i))                                          ;Prints 4 lines<br>
10<br>                                                                       7<br>
4<br>                                                                        1<br>
   <span class="math"> ⇒</span> NIL<br>
                                                                          

                                                                          
<!--l. 661--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 663--><p class="indent" >   <div class="tabbing">
;;; Step incrementally from the default starting value.
   <br>
(loop as i below 5
   <br>
      do (print i))                                          ;Prints 5 lines<br>
0<br>                                   1<br>                                   2<br>
3<br>                                                                        4<br>
   <span class="math"> ⇒</span> NIL<br>
<!--l. 673--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
<div class="defloop">
<div class="defmacheader">
<!--l. 677--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>for</b> <a 
 id="dx162-237004"></a>var [type-spec] <b>in</b> expr1 [<b>by</b> step-fun]
   <br>
<!--l. 677--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 677--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>as</b> <a 
 id="dx162-237005"></a>var [type-spec] <b>in</b> expr1 [<b>by</b> step-fun]
   <br>
                                                                          

                                                                          
<!--l. 679--><p class="noindent" ></div>
</div>
<!--l. 680--><p class="indent" >   [This is the second of seven <b><a 
href="symbols.html#x190-382436r436">for</a></b>/<b><a 
href="symbols.html#x190-382123r123">as</a></b> syntaxes.—GLS]
<!--l. 682--><p class="indent" >   This construct iterates over the contents of a list. It checks for the end of the
list as if using the Common Lisp function <b><a 
href="symbols.html#x190-382371r371">endp</a></b>. The variable <em>var</em> is bound to
the successive elements of the list <em>expr1</em> before each iteration. At the
end of each iteration, the function <em>step-fun</em> is called on the list and is
expected to produce a successor list; the default value for <em>step-fun</em> is the <b><a 
href="symbols.html#x190-382209r209">cdr</a></b>
function.
<!--l. 690--><p class="indent" >   The <b><a 
href="symbols.html#x190-382436r436">for</a></b> or <b><a 
href="symbols.html#x190-382123r123">as</a></b> construct causes termination when the end of the list is
reached. The loop keywords <b>in</b> and <b>by</b> serve as valid prepositions in this
syntax.
<!--l. 695--><p class="indent" >   Examples: <div class="lisp"><tt><div class="tabbing">
;;; Print every item in a list.
   <br>
(loop for item in &#x2019;(1 2 3 4 5) do (print item))                 ;Prints 5 lines
   <br>                                                                                              1<br>
2<br>                                                                        3<br>
4<br>                                                                        5<br>
   <span class="math"> ⇒</span> NIL<br>                                                               <br>
;;; Print every other item in a list.<br>
(loop for item in &#x2019;(1 2 3 4 5) by #&#x2019;cddr
   <br>
      do (print item))                                      ;Prints 3 lines<br>
1<br>                                   3<br>                                   5<br>
   <span class="math"> ⇒</span> NIL<br>
<!--l. 713--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 714--><p class="indent" >   <div class="tabbing">
                                                                          

                                                                          
;;; Destructure items of a list, and sum the x values
   <br>         ;;; using ﬁxnum arithmetic.<br>         (loop for (item . x) (t . ﬁxnum)<br>
          in &#x2019;((A . 1) (B . 2) (C . 3))<br>         unless (eq item &#x2019;B) sum x)<br>
   <span class="math"> ⇒</span> 4<br>
<!--l. 721--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
<div class="defloop">
<div class="defmacheader">
<!--l. 725--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>for</b> <a 
 id="dx162-237006"></a>var [type-spec] on expr1 [by step-fun]
   <br>
<!--l. 725--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 725--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>as</b> <a 
 id="dx162-237007"></a>var [type-spec] on expr1 [by step-fun]
   <br>
<!--l. 727--><p class="noindent" ></div>
</div>
<!--l. 728--><p class="indent" >   [This is the third of seven <b><a 
href="symbols.html#x190-382436r436">for</a></b>/<b><a 
href="symbols.html#x190-382123r123">as</a></b> syntaxes.—GLS]
<!--l. 730--><p class="indent" >   This construct iterates over the contents of a list. It checks for the end of the
list as if using the Common Lisp function <b><a 
href="symbols.html#x190-382371r371">endp</a></b>. The variable <em>var</em> is bound to the
successive tails of the list <em>expr1</em>. At the end of each iteration, the function
<em>step-fun</em> is called on the list and is expected to produce a successor list; the
default value for <em>step-fun</em> is the <b><a 
href="symbols.html#x190-382209r209">cdr</a></b> function.
<!--l. 738--><p class="indent" >   The loop keywords <b>on</b> and <b>by</b> serve as valid prepositions in this syntax.
The <b><a 
href="symbols.html#x190-382436r436">for</a></b> or <b><a 
href="symbols.html#x190-382123r123">as</a></b> construct causes termination when the end of the list is
reached.
<!--l. 743--><p class="indent" >   Examples: <div class="lisp"><tt><div class="tabbing">
                                                                          

                                                                          
;;; Collect successive tails of a list.
   <br>                                                         (loop for sublist on &#x2019;(a b c d)<br>
      collect sublist)<br>                <span class="math"> ⇒</span> ((A B C D) (B C D) (C D) (D))<br>
<br>           ;;; Print a list by using destructuring with the loop keyword ON.<br>
(loop for (item) on &#x2019;(1 2 3)<br>
      do (print item))                                      ;Prints 3 lines<br>
1<br>                                                                        2<br>
3<br>                                                                 <span class="math"> ⇒</span> NIL<br>
<br>                        ;;; Print items in a list without using destructuring.<br>
(loop for item in &#x2019;(1 2 3)<br>
      do (print item))                                      ;Prints 3 lines<br>
1<br>                                   2<br>                                   3<br>
   <span class="math"> ⇒</span> NIL<br>
<!--l. 765--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
<div class="defloop">
<div class="defmacheader">
<!--l. 769--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>for</b> <a 
 id="dx162-237008"></a>var [type-spec] <b>=</b> expr1 [<b>then</b> expr2]
   <br>
<!--l. 769--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 769--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>as</b> <a 
 id="dx162-237009"></a>var [type-spec] <b>=</b> expr1 [<b>then</b> expr2]
   <br>
<!--l. 771--><p class="noindent" ></div>
</div>
                                                                          

                                                                          
<!--l. 772--><p class="indent" >   [This is the fourth of seven <b><a 
href="symbols.html#x190-382436r436">for</a></b>/<b><a 
href="symbols.html#x190-382123r123">as</a></b> syntaxes.—GLS]
<!--l. 775--><p class="indent" >   This construct initializes the variable <em>var</em> by setting it to the result of
evaluating <em>expr1</em> on the ﬁrst iteration, then setting it to the result of evaluating
<em>expr2</em> on the second and subsequent iterations. If <em>expr2</em> is omitted, the construct
uses <em>expr1</em> on the second and subsequent iterations. When <em>expr2</em> is omitted, the
expanded code shows the following optimization:
<div class="lisp">
<tt>
<!--l. 783--><p class="indent" >   <div class="tabbing">
;;; Sample original code:
   <br>                                    (loop for x = <em>expr1</em> then <em>expr2</em> do (print x))<br>
<!--l. 786--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 787--><p class="indent" >   <div class="tabbing">
;;; The usual expansion:
   <br>                           (tagbody<br>                                 (setq x <em>expr1</em>)<br>
  tag (print x)<br>                                             (setq x <em>expr2</em>)<br>
      (go tag))<br>
<!--l. 794--><p class="noindent" ></div>
</tt>
</div>
<div class="lisp">
<tt>
<!--l. 795--><p class="indent" >   <div class="tabbing">
;;; The optimized expansion:
                                                                          

                                                                          
   <br>                                                                                   (tagbody<br>
  tag (setq x <em>expr1</em>)<br>                                             (print x)<br>
      (go tag))<br>
<!--l. 801--><p class="noindent" ></div>
</tt>
</div>
<!--l. 803--><p class="indent" >   The loop keywords <b><a 
href="symbols.html#x190-382075r75">=</a></b> and <b>then</b> serve as valid prepositions in this syntax. This
construct does not provide any termination conditions.
<!--l. 807--><p class="indent" >   Example: <div class="lisp"><tt><div class="tabbing">
;;; Collect some numbers.
   <br>                                                (loop for item = 1 then (+ item 10)<br>
      repeat 5<br>                                              collect item)<br>
   <span class="math"> ⇒</span> (1 11 21 31 41)<br>
<!--l. 814--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
<div class="defloop">
<div class="defmacheader">
<!--l. 819--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>for</b> <a 
 id="dx162-237010"></a>var [type-spec] across vector
   <br>
<!--l. 819--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 819--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>as</b> <a 
 id="dx162-237011"></a>var [type-spec] across vector
   <br>
<!--l. 821--><p class="noindent" ></div>
                                                                          

                                                                          
</div>
<!--l. 822--><p class="indent" >   [This is the ﬁfth of seven <b><a 
href="symbols.html#x190-382436r436">for</a></b>/<b><a 
href="symbols.html#x190-382123r123">as</a></b> syntaxes.—GLS]
<!--l. 824--><p class="indent" >   This construct binds the variable <em>var</em> to the value of each element in the array
<em>vector</em>.
<!--l. 827--><p class="indent" >   The loop keyword <b>across</b> marks the array <em>vector</em>; <b>across</b> is used as a
preposition in this syntax. Iteration stops when there are no more elements in the
speciﬁed array that can be referenced.
<!--l. 832--><p class="indent" >   Some implementations might use a [user-supplied—GLS] <b><a 
href="symbols.html#x190-382960r960">the</a></b> special operator
in the <em>vector</em> form to produce more eﬃcient code.
<!--l. 835--><p class="indent" >   Example: <div class="lisp"><tt><div class="tabbing">
(loop for char across (the simple-string (ﬁnd-message port))
   <br>                                                      do (write-char char stream))<br>
<!--l. 839--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
<div class="defloop">
<div class="defmacheader">
<!--l. 843--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>for</b> <a 
 id="dx162-237012"></a>var [type-spec] <b>being</b> {<b>each</b> | <b>the</b>}{<b>hash-key</b> | <b>hash-keys</b> | <b>hash-value</b> | <b>hash-values</b>}{<b>in</b> | <b>of</b>} hash-table [<b>using</b> ({<b>hash-value</b> | <b>hash-key</b>} other-var)]
   <br>
<!--l. 845--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 845--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>as</b> <a 
 id="dx162-237013"></a>var [type-spec] <b>being</b> {<b>each</b> | <b>the</b>}{<b>hash-key</b> | <b>hash-keys</b> | <b>hash-value</b> | <b>hash-values</b>}{<b>in</b> | <b>of</b>} hash-table [<b>using</b> ({<b>hash-value</b> | <b>hash-key</b>} other-var)]
   <br>
<!--l. 849--><p class="noindent" ></div>
</div>
                                                                          

                                                                          
<!--l. 850--><p class="indent" >   [This is the sixth of seven <b><a 
href="symbols.html#x190-382436r436">for</a></b>/<b><a 
href="symbols.html#x190-382123r123">as</a></b> syntaxes.—GLS]
<!--l. 852--><p class="indent" >   This construct iterates over the elements, keys, and values of a hash table. The
variable <em>var</em> takes on the value of each hash key or hash value in the speciﬁed
hash table.
<!--l. 856--><p class="indent" >   The following loop keywords serve as valid prepositions within this
syntax.
<div class="flushdesc">
      <ul><li><b>
<b>being</b> </b></li>The  keyword  <b>being</b>  marks  the  loop  method  to  be  used,  either
      <b>hash-key</b> or <b>hash-value</b>.
      <li><b>
<b>each</b>, <b><a 
href="symbols.html#x190-382960r960">the</a></b> </b></li>For purposes of readability, the loop keyword <b>each</b> should follow
      the loop keyword <b>being</b> when <b>hash-key</b> or <b>hash-value</b> is used. The
      loop keyword <b><a 
href="symbols.html#x190-382960r960">the</a></b> is used with <b>hash-keys</b> and <b>hash-values</b>.
      <li><b>
<b>hash-key</b>, <b>hash-keys</b> </b></li>These loop keywords access each key entry of the
      hash table. If the name <b>hash-value</b> is speciﬁed in a <b>using</b> construct
      with one of these loop methods, the iteration can optionally access the
      keyed value. The order in which the keys are accessed is undeﬁned;
      empty slots in the hash table are ignored.
      <li><b>
<b>hash-value</b>, <b>hash-values</b> </b></li>These loop keywords access each value entry of a
      hash table. If the name <b>hash-key</b> is speciﬁed in a <b>using</b> construct with
      one of these loop methods, the iteration can optionally access the key
      that corresponds to the value. The order in which the keys are accessed
      is undeﬁned; empty slots in the hash table are ignored.
      <li><b>
<b>using</b> </b></li>The loop keyword <b>using</b> marks the optional key or the keyed value
      to be accessed. It allows you to access the hash key if iterating over the
      hash values, and the hash value if iterating over the hash keys.
      <li><b>
<b>in</b>, <b>of</b> </b></li>These loop prepositions mark the hash table <em>hash-table</em>.</ul>
                                                                          

                                                                          
</div>
<!--l. 893--><p class="indent" >   Iteration stops when there are no more hash keys or hash values to be
referenced in the speciﬁed hash table.
<hr></div>
<div class="defloop">
<div class="defmacheader">
<!--l. 899--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>for</b> <a 
 id="dx162-237014"></a>var [type-spec] <b>being</b> {<b>each</b> | <b>the</b>}{<b>symbol</b> | <b>present-symbol</b> | <b>external-symbol</b> |<b>symbols</b> | <b>present-symbols</b> | <b>external-symbols</b>}{<b>in</b> | <b>of</b>} package
   <br>
<!--l. 902--><p class="noindent" ></div>
</div>
<div class="defmacheader">
<!--l. 902--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>as</b> <a 
 id="dx162-237015"></a>var [type-spec] <b>being</b> {<b>each</b> | <b>the</b>}{<b>symbol</b> | <b>present-symbol</b> | <b>external-symbol</b> |<b>symbols</b> | <b>present-symbols</b> | <b>external-symbols</b>}{<b>in</b> | <b>of</b>} package
   <br>
<!--l. 907--><p class="noindent" ></div>
</div>
<!--l. 908--><p class="indent" >   [This is the last of seven <b><a 
href="symbols.html#x190-382436r436">for</a></b>/<b><a 
href="symbols.html#x190-382123r123">as</a></b> syntaxes.—GLS]
<!--l. 911--><p class="indent" >   This construct iterates over the symbols in a package. The variable <em>var</em> takes
on the value of each symbol in the speciﬁed package.
<!--l. 915--><p class="indent" >   The following loop keywords serve as valid prepositions within this
syntax.
<div class="flushdesc">
      <ul><li><b>
<b>being</b> </b></li>The keyword <b>being</b> marks the loop method to be used: <b>symbol</b>,
      <b>present-symbol</b>, or <b>external-symbol</b>.
      <li><b>
<b>each</b>, <b><a 
href="symbols.html#x190-382960r960">the</a></b> </b></li>For  purposes  of  readability,  the  loop  keyword  <b>each</b>  should
      follow  the  loop  keyword  <b>being</b>  when  <b>symbol</b>,  <b>present-symbol</b>,
      or  <b>external-symbol</b> is  used.  The  loop  keyword  <b><a 
href="symbols.html#x190-382960r960">the</a></b> is  used  with
      <b>symbols</b>, <b>present-symbols</b>, and <b>external-symbols</b>.
                                                                          

                                                                          
      <li><b>
<b>present-symbol</b>, <b>present-symbols</b> </b></li>These loop methods iterate over the
      symbols that are present but not external in a package. The package to
      be iterated over is speciﬁed in the same way that package arguments to
      the Common Lisp function <b><a 
href="symbols.html#x190-382420r420">ﬁnd-package</a></b> are speciﬁed. If you do not
      specify the package for the iteration, the current package is used. If you
      specify a package that does not exist, an error is signaled.
      <li><b>
<b>symbol</b>, <b>symbols</b> </b></li>These  loop  methods  iterate  over  symbols  that  are
      accessible from a given package. The package to be iterated over is
      speciﬁed in the same way that package arguments to the Common Lisp
      function <b><a 
href="symbols.html#x190-382420r420">ﬁnd-package</a></b> are speciﬁed. If you do not specify the package
      for the iteration, the current package is used. If you specify a package
      that does not exist, an error is signaled.
      <li><b>
<b>external-symbol</b>, <b>external-symbols</b> </b></li>These loop methods iterate over the
      external  symbols  of  a  package.  The  package  to  be  iterated  over  is
      speciﬁed in the same way that package arguments to the Common Lisp
      function <b><a 
href="symbols.html#x190-382420r420">ﬁnd-package</a></b> are speciﬁed. If you do not specify the package
      for the iteration, the current package is used. If you specify a package
      that does not exist, an error is signaled.
      <li><b>
<b>in</b>, <b>of</b> </b></li>These loop prepositions mark the package <em>package</em>.</ul>
</div>
<!--l. 959--><p class="indent" >   Iteration stops when there are no more symbols to be referenced in the
speciﬁed package.
<!--l. 962--><p class="indent" >   Example: <div class="lisp"><tt><div class="tabbing">
(loop for x being each present-symbol of &#x0022;COMMON-LISP-USER&#x0022;
   <br>
      do (print x))                         ;Prints 7 lines in this example<br>
COMMON-LISP-USER::IN<br>                     COMMON-LISP-USER::X<br>
COMMON-LISP-USER::ALWAYS<br>           COMMON-LISP-USER::FOO<br>
                                                                          

                                                                          
COMMON-LISP-USER::Y<br>                  COMMON-LISP-USER::FOR<br>
COMMON-LISP-USER::LUCID<br>                                  <span class="math"> ⇒</span> NIL<br>
<!--l. 974--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
<div class="defloop">
<div class="defmacheader">
<!--l. 980--><p class="indent" >   <div class="tabbing">
 <em>[Loop clause]</em> <b>repeat</b> <a 
 id="dx162-237016"></a>expr
   <br>
<!--l. 981--><p class="noindent" ></div>
</div>
<!--l. 982--><p class="indent" >   The <b><a 
href="symbols.html#x190-382810r810">repeat</a></b> construct causes iteration to terminate after a speciﬁed number of
times. The loop body is executed <em>n</em> times, where <em>n</em> is the value of the expression
<em>expr</em>. The <em>expr</em> argument is evaluated one time in the loop prologue. If the
expression evaluates to zero or to a negative number, the loop body is not
evaluated.
<!--l. 990--><p class="indent" >   The clause <b><a 
href="symbols.html#x190-382810r810">repeat</a></b> <em>n</em> is roughly equivalent to a clause such as <div class="lisp"><tt><div class="tabbing">
for <em>internal-variable</em> downfrom (- <em>n</em> 1) to 0
   <br>
<!--l. 994--><p class="noindent" ></div>
</tt>
</div>
<!--l. 995--><p class="indent" >   but, in some implementations, the <b><a 
href="symbols.html#x190-382810r810">repeat</a></b> construct might be more
eﬃcient.
<!--l. 999--><p class="indent" >   Examples: <div class="lisp"><tt><div class="tabbing">
(loop repeat 3                                               ;Prints 3 lines
                                                                          

                                                                          
   <br>                         do (format t &#x0022;What I say three times is true~%&#x0022;))<br>
What I say three times is true<br>               What I say three times is true<br>
What I say three times is true<br>                    <span class="math"> ⇒</span> NIL<br>                 <br>
(loop repeat -15                                            ;Prints nothing<br>
      do (format t &#x0022;What you see is what you expect~%&#x0022;))<br>      <span class="math"> ⇒</span> NIL<br>
<!--l. 1011--><p class="noindent" ></div>
</tt>
</div>
<hr>
</div>
                                                                          

                                                                          
<!--l. 1016--><p class="indent" >   <div id="bottomlinks">&#x003C;<a 
href="clmse132.html" >Next</a>&#x003E;&#x003C;<a 
href="clmse130.html" >Prev</a>&#x003E;&#x003C;<a 
href="clmse130.html#tailclmse130.html" >PrevTail</a>&#x003E;&#x003C;<a 
href="clmse131.html" >Front</a>&#x003E;&#x003C;<a 
href="loop.html#clmse131.html" >Up</a>&#x003E;<br>&lt;<a href="../index.html">Main Page</a>&gt; &lt;<a href="symbols.html">Symbols</a>&gt; </div><a 
 id="tailclmse131.html"></a>  
</body></html> 
